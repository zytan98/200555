{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { deepMix } from '@antv/util';\nimport { ext } from '@antv/matrix-util';\nimport Button from './timeButton';\nimport { TIMEBAR_CONFIG_CHANGE, PRE_STEP_BTN, NEXT_STEP_BTN } from './constant';\nvar transform = ext.transform;\nvar DEFAULT_RECT_FILL = '#aaa';\nvar DEFAULT_RECT_STROKE = 'green';\nvar DEFAULT_PLAYBTN_STYLE = {\n  fill: '#aaa',\n  fillOpacity: 0.35,\n  stroke: '#aaa'\n};\nvar DEFAULT_PREBTN_STYLE = {\n  fill: '#fff'\n};\nvar DEFAULT_NEXTBTN_STYLE = {\n  fill: 'green'\n};\nvar DEFAULT_SPEED_CONTROLLER_STYLE = {\n  pointer: {\n    fill: '#aaa',\n    lineWidth: 0\n  },\n  scroller: {\n    stroke: '#aaa',\n    fill: '#aaa',\n    lineWidth: 1,\n    lineAppendWidth: 5,\n    cursor: 'pointer'\n  },\n  text: {\n    fill: '#aaa',\n    textBaseline: 'top'\n  }\n};\nvar DEFAULT_TIMETYPE_CONTROLLER_STYLE = {\n  check: {\n    stroke: 'green',\n    lineWidth: 3\n  },\n  box: {\n    fill: '#fff',\n    stroke: '#aaa',\n    lineWidth: 2,\n    radius: 3,\n    width: 12,\n    height: 12\n  },\n  text: {\n    fill: '#aaa',\n    fontSize: 12,\n    textBaseline: 'top'\n  }\n};\nvar DEFAULT_CONTROLLER_CONFIG = {\n  speed: 1,\n  loop: false,\n  fill: '#fff',\n  stroke: '#fff',\n  hideTimeTypeController: false,\n  preBtnStyle: {\n    fill: '#aaa',\n    stroke: '#aaa'\n  },\n  nextBtnStyle: {\n    fill: '#aaa',\n    stroke: '#aaa'\n  },\n  playBtnStyle: {\n    fill: '#aaa',\n    stroke: '#aaa',\n    fillOpacity: 0.05\n  },\n  speedControllerStyle: DEFAULT_SPEED_CONTROLLER_STYLE,\n  timeTypeControllerStyle: DEFAULT_TIMETYPE_CONTROLLER_STYLE\n};\nvar SPEED_CONTROLLER_OFFSET = 110;\nvar TOGGLE_MODEL_OFFSET = 50;\n\nvar ControllerBtn =\n/** @class */\nfunction () {\n  function ControllerBtn(cfg) {\n    this.controllerCfg = deepMix({}, DEFAULT_CONTROLLER_CONFIG, cfg);\n    this.group = cfg.group;\n    this.controllerGroup = this.group.addGroup({\n      name: 'controller-group'\n    });\n    this.speedAxisY = [];\n    this.currentSpeed = this.controllerCfg.speed;\n    this.currentType = 'range';\n    this.fontFamily = cfg.fontFamily || 'Arial, sans-serif';\n    this.init();\n  }\n\n  ControllerBtn.prototype.init = function () {\n    this.renderPlayButton();\n  };\n  /** 获取播放键 marker path */\n\n\n  ControllerBtn.prototype.getNextMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x + len, y], ['L', x, y + len], ['Z', x, y - len], ['M', x, y], ['L', x - len, y - len], ['L', x - len, y + len], ['Z']];\n  };\n\n  ControllerBtn.prototype.getPreMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x - len, y], ['L', x, y + len], ['L', x, y - len], ['M', x, y], ['L', x + len, y - len], ['L', x + len, y + len], ['Z']];\n  };\n\n  ControllerBtn.prototype.renderPlayButton = function () {\n    var controllerCfg = this.controllerCfg;\n    var width = controllerCfg.width,\n        height = controllerCfg.height,\n        x = controllerCfg.x,\n        y = controllerCfg.y,\n        hideTimeTypeController = controllerCfg.hideTimeTypeController,\n        _a = controllerCfg.fill,\n        fill = _a === void 0 ? DEFAULT_RECT_FILL : _a,\n        _b = controllerCfg.stroke,\n        stroke = _b === void 0 ? DEFAULT_RECT_STROKE : _b;\n\n    var playBtnStyle = __assign(__assign({}, DEFAULT_PLAYBTN_STYLE), controllerCfg.playBtnStyle || {});\n\n    var preBtnStyle = __assign(__assign({}, DEFAULT_PREBTN_STYLE), controllerCfg.preBtnStyle || {});\n\n    var nextBtnStyle = __assign(__assign({}, DEFAULT_NEXTBTN_STYLE), controllerCfg.nextBtnStyle || {});\n\n    var r = height / 2 - 5;\n    var realY = y + 10; // 绘制最外层的矩形包围框\n\n    var container = this.controllerGroup.addShape('rect', {\n      attrs: {\n        x: x,\n        y: realY,\n        width: width,\n        height: height,\n        stroke: stroke,\n        fill: fill\n      },\n      name: 'container-rect'\n    });\n\n    if (this.playButton) {\n      this.playButton.update({\n        x: width / 2,\n        y: realY,\n        r: r\n      });\n    } else {\n      this.playButton = new Button({\n        group: this.controllerGroup,\n        x: width / 2,\n        y: realY + r + 5,\n        r: r,\n        isPlay: this.isPlay,\n        style: playBtnStyle\n      });\n    } // 后退按钮\n\n\n    var prePaddingX = preBtnStyle.offsetX || 0;\n    var prePaddingY = preBtnStyle.offsetY || 0;\n    var preR = (preBtnStyle.scale || 1) * r;\n    this.controllerGroup.addShape('path', {\n      attrs: __assign({\n        path: this.getPreMarkerPath(width / 2 - 5 * r + prePaddingX, realY + r + 5 + prePaddingY, preR * 0.5)\n      }, preBtnStyle),\n      name: PRE_STEP_BTN\n    }); // 前进按钮\n\n    var nxtPaddingX = nextBtnStyle.offsetX || 0;\n    var nxtPaddingY = nextBtnStyle.offsetY || 0;\n    var nxtR = (nextBtnStyle.scale || 1) * r;\n    this.controllerGroup.addShape('path', {\n      attrs: __assign({\n        path: this.getNextMarkerPath(width / 2 + 5 * r + nxtPaddingX, realY + r + 5 + nxtPaddingY, nxtR * 0.5)\n      }, nextBtnStyle),\n      name: NEXT_STEP_BTN\n    });\n    container.toBack(); // 调节speed的按钮\n\n    this.renderSpeedBtn();\n\n    if (!hideTimeTypeController) {\n      this.renderToggleTime();\n    }\n\n    this.bindEvent(); // 根据配置的 scale、offsetX，offsetY 缩放和移动控制栏\n\n    var _c = this.controllerCfg.scale,\n        scale = _c === void 0 ? 1 : _c;\n    var currentBBox = this.controllerGroup.getCanvasBBox();\n    var centerX = (currentBBox.maxX + currentBBox.minX) / 2;\n    var centerY = (currentBBox.maxY + currentBBox.minY) / 2;\n    var matrix = transform([1, 0, 0, 0, 1, 0, 0, 0, 1], [['t', -centerX, -centerY], ['s', scale, scale], ['t', centerX, centerY]]);\n    this.controllerGroup.setMatrix(matrix);\n  };\n\n  ControllerBtn.prototype.renderSpeedBtn = function () {\n    var _a = this.controllerCfg,\n        y = _a.y,\n        width = _a.width,\n        hideTimeTypeController = _a.hideTimeTypeController;\n\n    var speedControllerStyle = __assign(__assign({}, DEFAULT_SPEED_CONTROLLER_STYLE), this.controllerCfg.speedControllerStyle || {});\n\n    var _b = speedControllerStyle.scroller,\n        scroller = _b === void 0 ? {} : _b,\n        _c = speedControllerStyle.text,\n        text = _c === void 0 ? {} : _c,\n        _d = speedControllerStyle.pointer,\n        pointer = _d === void 0 ? {} : _d,\n        _e = speedControllerStyle.scale,\n        scale = _e === void 0 ? 1 : _e,\n        _f = speedControllerStyle.offsetX,\n        offsetX = _f === void 0 ? 0 : _f,\n        _g = speedControllerStyle.offsetY,\n        offsetY = _g === void 0 ? 0 : _g;\n    var speedGroup = this.controllerGroup.addGroup({\n      name: 'speed-group'\n    });\n    this.speedGroup = speedGroup;\n    var speedNum = [];\n    var maxSpeed = 5;\n    this.speedAxisY = [19, 22, 26, 32, 39]; // 增加speed刻度\n\n    for (var i = 0; i < 5; i++) {\n      var axisY = y + this.speedAxisY[i]; // 灰色刻度\n\n      var startX = width - (!hideTimeTypeController ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET);\n      speedGroup.addShape('line', {\n        attrs: __assign({\n          x1: startX,\n          x2: startX + 15,\n          y1: axisY,\n          y2: axisY\n        }, scroller),\n        speed: maxSpeed,\n        name: 'speed-rect'\n      });\n      this.speedAxisY[i] = axisY;\n      speedNum.push(maxSpeed);\n      maxSpeed = maxSpeed - 1;\n    } // 速度文本\n\n\n    this.speedText = speedGroup.addShape('text', {\n      attrs: __assign({\n        x: width - (!hideTimeTypeController ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET) + 20,\n        y: this.speedAxisY[0] + 4,\n        text: \"1.0X\",\n        fontFamily: this.fontFamily || 'Arial, sans-serif'\n      }, text)\n    });\n    this.speedPoint = speedGroup.addShape('path', {\n      attrs: __assign({\n        path: this.getPointerPath(width - (!hideTimeTypeController ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET), 0),\n        matrix: [1, 0, 0, 0, 1, 0, 0, this.speedAxisY[4], 1]\n      }, pointer)\n    }); // 根据配置在 speedControllerStyle 中的 scale offsetX offsetY 缩放和移动速度控制器\n\n    var currentBBox = this.speedGroup.getCanvasBBox();\n    var centerX = (currentBBox.maxX + currentBBox.minX) / 2;\n    var centerY = (currentBBox.maxY + currentBBox.minY) / 2;\n    var matrix = this.speedGroup.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['s', scale, scale], ['t', centerX + offsetX * scale, centerY + offsetY * scale]]);\n    this.speedGroup.setMatrix(matrix);\n  };\n\n  ControllerBtn.prototype.getPointerPath = function (x, y) {\n    return [['M', x, y], ['L', x - 10, y - 4], ['L', x - 10, y + 4], ['Z']];\n  };\n\n  ControllerBtn.prototype.renderToggleTime = function () {\n    var _a;\n\n    var width = this.controllerCfg.width;\n\n    var timeTypeControllerStyle = __assign(__assign({}, DEFAULT_TIMETYPE_CONTROLLER_STYLE), this.controllerCfg.timeTypeControllerStyle || {});\n\n    var _b = timeTypeControllerStyle.scale,\n        scale = _b === void 0 ? 1 : _b,\n        _c = timeTypeControllerStyle.offsetX,\n        offsetX = _c === void 0 ? 0 : _c,\n        _d = timeTypeControllerStyle.offsetY,\n        offsetY = _d === void 0 ? 0 : _d,\n        _e = timeTypeControllerStyle.box,\n        box = _e === void 0 ? {} : _e,\n        _f = timeTypeControllerStyle.check,\n        check = _f === void 0 ? {} : _f,\n        _g = timeTypeControllerStyle.text,\n        text = _g === void 0 ? {} : _g;\n    this.toggleGroup = this.controllerGroup.addGroup({\n      name: 'toggle-group'\n    });\n    this.toggleGroup.addShape('rect', {\n      attrs: __assign({\n        x: width - TOGGLE_MODEL_OFFSET,\n        y: this.speedAxisY[0] + 3.5\n      }, box),\n      isChecked: false,\n      name: 'toggle-model'\n    });\n    this.checkedIcon = this.toggleGroup.addShape('path', {\n      attrs: __assign({\n        path: [['M', width - TOGGLE_MODEL_OFFSET + 3, this.speedAxisY[1] + 6], ['L', width - TOGGLE_MODEL_OFFSET + 7, this.speedAxisY[1] + 10], ['L', width - TOGGLE_MODEL_OFFSET + 12, this.speedAxisY[1] + 4]]\n      }, check),\n      capture: false\n    });\n    this.checkedIcon.hide();\n    this.checkedText = this.toggleGroup.addShape('text', {\n      attrs: __assign({\n        text: ((_a = this.controllerCfg) === null || _a === void 0 ? void 0 : _a.timePointControllerText) || '单一时间',\n        x: width - TOGGLE_MODEL_OFFSET + 15,\n        y: this.speedAxisY[0] + 4,\n        fontFamily: typeof window !== 'undefined' ? window.getComputedStyle(document.body, null).getPropertyValue('font-family') || 'Arial, sans-serif' : 'Arial, sans-serif'\n      }, text)\n    }); // 根据配置在 timeTypeControllerStyle 中的 scale offsetX offsetY 缩放和移动速度控制器\n\n    var currentBBox = this.toggleGroup.getCanvasBBox();\n    var centerX = (currentBBox.maxX + currentBBox.minX) / 2;\n    var centerY = (currentBBox.maxY + currentBBox.minY) / 2;\n    var matrix = this.toggleGroup.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['s', scale, scale], ['t', centerX + offsetX * scale, centerY + offsetY * scale]]);\n    this.toggleGroup.setMatrix(matrix);\n  };\n\n  ControllerBtn.prototype.bindEvent = function () {\n    var _this = this;\n\n    this.speedGroup.on('speed-rect:click', function (evt) {\n      var currentPointerY = evt.target.attr('y1');\n\n      var pointerMatrix = _this.speedPoint.attr('matrix');\n\n      var currentYIdx = _this.speedAxisY.indexOf(pointerMatrix[7] || 0);\n\n      var targetYIdx = _this.speedAxisY.indexOf(currentPointerY);\n\n      var yDiff = _this.speedAxisY[targetYIdx] - _this.speedAxisY[currentYIdx];\n      pointerMatrix = transform(pointerMatrix, [['t', 0, yDiff]]);\n\n      _this.speedPoint.setMatrix(pointerMatrix);\n\n      _this.currentSpeed = _this.speedAxisY.length - targetYIdx;\n\n      _this.speedText.attr('text', _this.currentSpeed + \".0X\");\n\n      _this.group.emit(TIMEBAR_CONFIG_CHANGE, {\n        speed: _this.currentSpeed,\n        type: _this.currentType\n      });\n    });\n    this.speedGroup.on('mousewheel', function (evt) {\n      evt.preventDefault();\n      var pointerMatrix = _this.speedPoint.attr('matrix') || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n      var currentPointerY = pointerMatrix[7];\n\n      var currentYIdx = _this.speedAxisY.indexOf(currentPointerY);\n\n      if (currentYIdx === -1) {\n        // 找到最近的一个 y\n        var minDist_1 = Infinity;\n\n        _this.speedAxisY.forEach(function (y, idx) {\n          var dist = Math.abs(y - currentPointerY);\n\n          if (minDist_1 > dist) {\n            minDist_1 = dist;\n            currentYIdx = idx;\n          }\n        });\n      }\n\n      if (evt.originalEvent.deltaY > 0) currentYIdx = Math.max(0, currentYIdx - 1);else currentYIdx = Math.min(_this.speedAxisY.length - 1, currentYIdx + 1);\n      var yDiff = _this.speedAxisY[currentYIdx] - currentPointerY;\n      pointerMatrix = transform(pointerMatrix, [['t', 0, yDiff]]);\n\n      _this.speedPoint.setMatrix(pointerMatrix);\n\n      _this.currentSpeed = _this.speedAxisY.length - currentYIdx;\n\n      _this.speedText.attr('text', _this.currentSpeed + \".0X\");\n\n      _this.group.emit(TIMEBAR_CONFIG_CHANGE, {\n        speed: _this.currentSpeed,\n        type: _this.currentType\n      });\n    });\n\n    if (this.toggleGroup) {\n      this.toggleGroup.on('toggle-model:click', function (evt) {\n        var _a, _b;\n\n        var isChecked = evt.target.get('isChecked');\n\n        if (!isChecked) {\n          _this.checkedIcon.show();\n\n          _this.checkedText.attr('text', ((_a = _this.controllerCfg) === null || _a === void 0 ? void 0 : _a.timeRangeControllerText) || '时间范围');\n\n          _this.currentType = 'single';\n        } else {\n          _this.checkedIcon.hide();\n\n          _this.checkedText.attr('text', ((_b = _this.controllerCfg) === null || _b === void 0 ? void 0 : _b.timePointControllerText) || '单一时间');\n\n          _this.currentType = 'range';\n        }\n\n        evt.target.set('isChecked', !isChecked);\n\n        _this.group.emit(TIMEBAR_CONFIG_CHANGE, {\n          type: _this.currentType,\n          speed: _this.currentSpeed\n        });\n      });\n    }\n  };\n\n  ControllerBtn.prototype.destroy = function () {\n    this.speedGroup.off('speed-rect:click');\n\n    if (this.toggleGroup) {\n      this.toggleGroup.off('toggle-model:click');\n      this.toggleGroup.destroy();\n    }\n\n    this.speedGroup.destroy();\n  };\n\n  return ControllerBtn;\n}();\n\nexport default ControllerBtn;","map":{"version":3,"sources":["C:/Users/Home/Desktop/cs-2005/node_modules/@antv/g6-plugin/es/timeBar/controllerBtn.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","deepMix","ext","Button","TIMEBAR_CONFIG_CHANGE","PRE_STEP_BTN","NEXT_STEP_BTN","transform","DEFAULT_RECT_FILL","DEFAULT_RECT_STROKE","DEFAULT_PLAYBTN_STYLE","fill","fillOpacity","stroke","DEFAULT_PREBTN_STYLE","DEFAULT_NEXTBTN_STYLE","DEFAULT_SPEED_CONTROLLER_STYLE","pointer","lineWidth","scroller","lineAppendWidth","cursor","text","textBaseline","DEFAULT_TIMETYPE_CONTROLLER_STYLE","check","box","radius","width","height","fontSize","DEFAULT_CONTROLLER_CONFIG","speed","loop","hideTimeTypeController","preBtnStyle","nextBtnStyle","playBtnStyle","speedControllerStyle","timeTypeControllerStyle","SPEED_CONTROLLER_OFFSET","TOGGLE_MODEL_OFFSET","ControllerBtn","cfg","controllerCfg","group","controllerGroup","addGroup","name","speedAxisY","currentSpeed","currentType","fontFamily","init","renderPlayButton","getNextMarkerPath","x","y","len","getPreMarkerPath","_a","_b","r","realY","container","addShape","attrs","playButton","update","isPlay","style","prePaddingX","offsetX","prePaddingY","offsetY","preR","scale","path","nxtPaddingX","nxtPaddingY","nxtR","toBack","renderSpeedBtn","renderToggleTime","bindEvent","_c","currentBBox","getCanvasBBox","centerX","maxX","minX","centerY","maxY","minY","matrix","setMatrix","_d","_e","_f","_g","speedGroup","speedNum","maxSpeed","axisY","startX","x1","x2","y1","y2","push","speedText","speedPoint","getPointerPath","getMatrix","toggleGroup","isChecked","checkedIcon","capture","hide","checkedText","timePointControllerText","window","getComputedStyle","document","body","getPropertyValue","_this","on","evt","currentPointerY","target","attr","pointerMatrix","currentYIdx","indexOf","targetYIdx","yDiff","emit","type","preventDefault","minDist_1","Infinity","forEach","idx","dist","Math","abs","originalEvent","deltaY","max","min","get","show","timeRangeControllerText","set","destroy","off"],"mappings":"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","sourcesContent":["var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport { deepMix } from '@antv/util';\nimport { ext } from '@antv/matrix-util';\nimport Button from './timeButton';\nimport { TIMEBAR_CONFIG_CHANGE, PRE_STEP_BTN, NEXT_STEP_BTN } from './constant';\nvar transform = ext.transform;\nvar DEFAULT_RECT_FILL = '#aaa';\nvar DEFAULT_RECT_STROKE = 'green';\nvar DEFAULT_PLAYBTN_STYLE = {\n  fill: '#aaa',\n  fillOpacity: 0.35,\n  stroke: '#aaa'\n};\nvar DEFAULT_PREBTN_STYLE = {\n  fill: '#fff'\n};\nvar DEFAULT_NEXTBTN_STYLE = {\n  fill: 'green'\n};\nvar DEFAULT_SPEED_CONTROLLER_STYLE = {\n  pointer: {\n    fill: '#aaa',\n    lineWidth: 0\n  },\n  scroller: {\n    stroke: '#aaa',\n    fill: '#aaa',\n    lineWidth: 1,\n    lineAppendWidth: 5,\n    cursor: 'pointer'\n  },\n  text: {\n    fill: '#aaa',\n    textBaseline: 'top'\n  }\n};\nvar DEFAULT_TIMETYPE_CONTROLLER_STYLE = {\n  check: {\n    stroke: 'green',\n    lineWidth: 3\n  },\n  box: {\n    fill: '#fff',\n    stroke: '#aaa',\n    lineWidth: 2,\n    radius: 3,\n    width: 12,\n    height: 12\n  },\n  text: {\n    fill: '#aaa',\n    fontSize: 12,\n    textBaseline: 'top'\n  }\n};\nvar DEFAULT_CONTROLLER_CONFIG = {\n  speed: 1,\n  loop: false,\n  fill: '#fff',\n  stroke: '#fff',\n  hideTimeTypeController: false,\n  preBtnStyle: {\n    fill: '#aaa',\n    stroke: '#aaa'\n  },\n  nextBtnStyle: {\n    fill: '#aaa',\n    stroke: '#aaa'\n  },\n  playBtnStyle: {\n    fill: '#aaa',\n    stroke: '#aaa',\n    fillOpacity: 0.05\n  },\n  speedControllerStyle: DEFAULT_SPEED_CONTROLLER_STYLE,\n  timeTypeControllerStyle: DEFAULT_TIMETYPE_CONTROLLER_STYLE\n};\nvar SPEED_CONTROLLER_OFFSET = 110;\nvar TOGGLE_MODEL_OFFSET = 50;\n\nvar ControllerBtn =\n/** @class */\nfunction () {\n  function ControllerBtn(cfg) {\n    this.controllerCfg = deepMix({}, DEFAULT_CONTROLLER_CONFIG, cfg);\n    this.group = cfg.group;\n    this.controllerGroup = this.group.addGroup({\n      name: 'controller-group'\n    });\n    this.speedAxisY = [];\n    this.currentSpeed = this.controllerCfg.speed;\n    this.currentType = 'range';\n    this.fontFamily = cfg.fontFamily || 'Arial, sans-serif';\n    this.init();\n  }\n\n  ControllerBtn.prototype.init = function () {\n    this.renderPlayButton();\n  };\n  /** 获取播放键 marker path */\n\n\n  ControllerBtn.prototype.getNextMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x + len, y], ['L', x, y + len], ['Z', x, y - len], ['M', x, y], ['L', x - len, y - len], ['L', x - len, y + len], ['Z']];\n  };\n\n  ControllerBtn.prototype.getPreMarkerPath = function (x, y, len) {\n    return [['M', x, y - len], ['L', x - len, y], ['L', x, y + len], ['L', x, y - len], ['M', x, y], ['L', x + len, y - len], ['L', x + len, y + len], ['Z']];\n  };\n\n  ControllerBtn.prototype.renderPlayButton = function () {\n    var controllerCfg = this.controllerCfg;\n    var width = controllerCfg.width,\n        height = controllerCfg.height,\n        x = controllerCfg.x,\n        y = controllerCfg.y,\n        hideTimeTypeController = controllerCfg.hideTimeTypeController,\n        _a = controllerCfg.fill,\n        fill = _a === void 0 ? DEFAULT_RECT_FILL : _a,\n        _b = controllerCfg.stroke,\n        stroke = _b === void 0 ? DEFAULT_RECT_STROKE : _b;\n\n    var playBtnStyle = __assign(__assign({}, DEFAULT_PLAYBTN_STYLE), controllerCfg.playBtnStyle || {});\n\n    var preBtnStyle = __assign(__assign({}, DEFAULT_PREBTN_STYLE), controllerCfg.preBtnStyle || {});\n\n    var nextBtnStyle = __assign(__assign({}, DEFAULT_NEXTBTN_STYLE), controllerCfg.nextBtnStyle || {});\n\n    var r = height / 2 - 5;\n    var realY = y + 10; // 绘制最外层的矩形包围框\n\n    var container = this.controllerGroup.addShape('rect', {\n      attrs: {\n        x: x,\n        y: realY,\n        width: width,\n        height: height,\n        stroke: stroke,\n        fill: fill\n      },\n      name: 'container-rect'\n    });\n\n    if (this.playButton) {\n      this.playButton.update({\n        x: width / 2,\n        y: realY,\n        r: r\n      });\n    } else {\n      this.playButton = new Button({\n        group: this.controllerGroup,\n        x: width / 2,\n        y: realY + r + 5,\n        r: r,\n        isPlay: this.isPlay,\n        style: playBtnStyle\n      });\n    } // 后退按钮\n\n\n    var prePaddingX = preBtnStyle.offsetX || 0;\n    var prePaddingY = preBtnStyle.offsetY || 0;\n    var preR = (preBtnStyle.scale || 1) * r;\n    this.controllerGroup.addShape('path', {\n      attrs: __assign({\n        path: this.getPreMarkerPath(width / 2 - 5 * r + prePaddingX, realY + r + 5 + prePaddingY, preR * 0.5)\n      }, preBtnStyle),\n      name: PRE_STEP_BTN\n    }); // 前进按钮\n\n    var nxtPaddingX = nextBtnStyle.offsetX || 0;\n    var nxtPaddingY = nextBtnStyle.offsetY || 0;\n    var nxtR = (nextBtnStyle.scale || 1) * r;\n    this.controllerGroup.addShape('path', {\n      attrs: __assign({\n        path: this.getNextMarkerPath(width / 2 + 5 * r + nxtPaddingX, realY + r + 5 + nxtPaddingY, nxtR * 0.5)\n      }, nextBtnStyle),\n      name: NEXT_STEP_BTN\n    });\n    container.toBack(); // 调节speed的按钮\n\n    this.renderSpeedBtn();\n\n    if (!hideTimeTypeController) {\n      this.renderToggleTime();\n    }\n\n    this.bindEvent(); // 根据配置的 scale、offsetX，offsetY 缩放和移动控制栏\n\n    var _c = this.controllerCfg.scale,\n        scale = _c === void 0 ? 1 : _c;\n    var currentBBox = this.controllerGroup.getCanvasBBox();\n    var centerX = (currentBBox.maxX + currentBBox.minX) / 2;\n    var centerY = (currentBBox.maxY + currentBBox.minY) / 2;\n    var matrix = transform([1, 0, 0, 0, 1, 0, 0, 0, 1], [['t', -centerX, -centerY], ['s', scale, scale], ['t', centerX, centerY]]);\n    this.controllerGroup.setMatrix(matrix);\n  };\n\n  ControllerBtn.prototype.renderSpeedBtn = function () {\n    var _a = this.controllerCfg,\n        y = _a.y,\n        width = _a.width,\n        hideTimeTypeController = _a.hideTimeTypeController;\n\n    var speedControllerStyle = __assign(__assign({}, DEFAULT_SPEED_CONTROLLER_STYLE), this.controllerCfg.speedControllerStyle || {});\n\n    var _b = speedControllerStyle.scroller,\n        scroller = _b === void 0 ? {} : _b,\n        _c = speedControllerStyle.text,\n        text = _c === void 0 ? {} : _c,\n        _d = speedControllerStyle.pointer,\n        pointer = _d === void 0 ? {} : _d,\n        _e = speedControllerStyle.scale,\n        scale = _e === void 0 ? 1 : _e,\n        _f = speedControllerStyle.offsetX,\n        offsetX = _f === void 0 ? 0 : _f,\n        _g = speedControllerStyle.offsetY,\n        offsetY = _g === void 0 ? 0 : _g;\n    var speedGroup = this.controllerGroup.addGroup({\n      name: 'speed-group'\n    });\n    this.speedGroup = speedGroup;\n    var speedNum = [];\n    var maxSpeed = 5;\n    this.speedAxisY = [19, 22, 26, 32, 39]; // 增加speed刻度\n\n    for (var i = 0; i < 5; i++) {\n      var axisY = y + this.speedAxisY[i]; // 灰色刻度\n\n      var startX = width - (!hideTimeTypeController ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET);\n      speedGroup.addShape('line', {\n        attrs: __assign({\n          x1: startX,\n          x2: startX + 15,\n          y1: axisY,\n          y2: axisY\n        }, scroller),\n        speed: maxSpeed,\n        name: 'speed-rect'\n      });\n      this.speedAxisY[i] = axisY;\n      speedNum.push(maxSpeed);\n      maxSpeed = maxSpeed - 1;\n    } // 速度文本\n\n\n    this.speedText = speedGroup.addShape('text', {\n      attrs: __assign({\n        x: width - (!hideTimeTypeController ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET) + 20,\n        y: this.speedAxisY[0] + 4,\n        text: \"1.0X\",\n        fontFamily: this.fontFamily || 'Arial, sans-serif'\n      }, text)\n    });\n    this.speedPoint = speedGroup.addShape('path', {\n      attrs: __assign({\n        path: this.getPointerPath(width - (!hideTimeTypeController ? SPEED_CONTROLLER_OFFSET : TOGGLE_MODEL_OFFSET), 0),\n        matrix: [1, 0, 0, 0, 1, 0, 0, this.speedAxisY[4], 1]\n      }, pointer)\n    }); // 根据配置在 speedControllerStyle 中的 scale offsetX offsetY 缩放和移动速度控制器\n\n    var currentBBox = this.speedGroup.getCanvasBBox();\n    var centerX = (currentBBox.maxX + currentBBox.minX) / 2;\n    var centerY = (currentBBox.maxY + currentBBox.minY) / 2;\n    var matrix = this.speedGroup.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['s', scale, scale], ['t', centerX + offsetX * scale, centerY + offsetY * scale]]);\n    this.speedGroup.setMatrix(matrix);\n  };\n\n  ControllerBtn.prototype.getPointerPath = function (x, y) {\n    return [['M', x, y], ['L', x - 10, y - 4], ['L', x - 10, y + 4], ['Z']];\n  };\n\n  ControllerBtn.prototype.renderToggleTime = function () {\n    var _a;\n\n    var width = this.controllerCfg.width;\n\n    var timeTypeControllerStyle = __assign(__assign({}, DEFAULT_TIMETYPE_CONTROLLER_STYLE), this.controllerCfg.timeTypeControllerStyle || {});\n\n    var _b = timeTypeControllerStyle.scale,\n        scale = _b === void 0 ? 1 : _b,\n        _c = timeTypeControllerStyle.offsetX,\n        offsetX = _c === void 0 ? 0 : _c,\n        _d = timeTypeControllerStyle.offsetY,\n        offsetY = _d === void 0 ? 0 : _d,\n        _e = timeTypeControllerStyle.box,\n        box = _e === void 0 ? {} : _e,\n        _f = timeTypeControllerStyle.check,\n        check = _f === void 0 ? {} : _f,\n        _g = timeTypeControllerStyle.text,\n        text = _g === void 0 ? {} : _g;\n    this.toggleGroup = this.controllerGroup.addGroup({\n      name: 'toggle-group'\n    });\n    this.toggleGroup.addShape('rect', {\n      attrs: __assign({\n        x: width - TOGGLE_MODEL_OFFSET,\n        y: this.speedAxisY[0] + 3.5\n      }, box),\n      isChecked: false,\n      name: 'toggle-model'\n    });\n    this.checkedIcon = this.toggleGroup.addShape('path', {\n      attrs: __assign({\n        path: [['M', width - TOGGLE_MODEL_OFFSET + 3, this.speedAxisY[1] + 6], ['L', width - TOGGLE_MODEL_OFFSET + 7, this.speedAxisY[1] + 10], ['L', width - TOGGLE_MODEL_OFFSET + 12, this.speedAxisY[1] + 4]]\n      }, check),\n      capture: false\n    });\n    this.checkedIcon.hide();\n    this.checkedText = this.toggleGroup.addShape('text', {\n      attrs: __assign({\n        text: ((_a = this.controllerCfg) === null || _a === void 0 ? void 0 : _a.timePointControllerText) || '单一时间',\n        x: width - TOGGLE_MODEL_OFFSET + 15,\n        y: this.speedAxisY[0] + 4,\n        fontFamily: typeof window !== 'undefined' ? window.getComputedStyle(document.body, null).getPropertyValue('font-family') || 'Arial, sans-serif' : 'Arial, sans-serif'\n      }, text)\n    }); // 根据配置在 timeTypeControllerStyle 中的 scale offsetX offsetY 缩放和移动速度控制器\n\n    var currentBBox = this.toggleGroup.getCanvasBBox();\n    var centerX = (currentBBox.maxX + currentBBox.minX) / 2;\n    var centerY = (currentBBox.maxY + currentBBox.minY) / 2;\n    var matrix = this.toggleGroup.getMatrix() || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n    matrix = transform(matrix, [['t', -centerX, -centerY], ['s', scale, scale], ['t', centerX + offsetX * scale, centerY + offsetY * scale]]);\n    this.toggleGroup.setMatrix(matrix);\n  };\n\n  ControllerBtn.prototype.bindEvent = function () {\n    var _this = this;\n\n    this.speedGroup.on('speed-rect:click', function (evt) {\n      var currentPointerY = evt.target.attr('y1');\n\n      var pointerMatrix = _this.speedPoint.attr('matrix');\n\n      var currentYIdx = _this.speedAxisY.indexOf(pointerMatrix[7] || 0);\n\n      var targetYIdx = _this.speedAxisY.indexOf(currentPointerY);\n\n      var yDiff = _this.speedAxisY[targetYIdx] - _this.speedAxisY[currentYIdx];\n      pointerMatrix = transform(pointerMatrix, [['t', 0, yDiff]]);\n\n      _this.speedPoint.setMatrix(pointerMatrix);\n\n      _this.currentSpeed = _this.speedAxisY.length - targetYIdx;\n\n      _this.speedText.attr('text', _this.currentSpeed + \".0X\");\n\n      _this.group.emit(TIMEBAR_CONFIG_CHANGE, {\n        speed: _this.currentSpeed,\n        type: _this.currentType\n      });\n    });\n    this.speedGroup.on('mousewheel', function (evt) {\n      evt.preventDefault();\n      var pointerMatrix = _this.speedPoint.attr('matrix') || [1, 0, 0, 0, 1, 0, 0, 0, 1];\n      var currentPointerY = pointerMatrix[7];\n\n      var currentYIdx = _this.speedAxisY.indexOf(currentPointerY);\n\n      if (currentYIdx === -1) {\n        // 找到最近的一个 y\n        var minDist_1 = Infinity;\n\n        _this.speedAxisY.forEach(function (y, idx) {\n          var dist = Math.abs(y - currentPointerY);\n\n          if (minDist_1 > dist) {\n            minDist_1 = dist;\n            currentYIdx = idx;\n          }\n        });\n      }\n\n      if (evt.originalEvent.deltaY > 0) currentYIdx = Math.max(0, currentYIdx - 1);else currentYIdx = Math.min(_this.speedAxisY.length - 1, currentYIdx + 1);\n      var yDiff = _this.speedAxisY[currentYIdx] - currentPointerY;\n      pointerMatrix = transform(pointerMatrix, [['t', 0, yDiff]]);\n\n      _this.speedPoint.setMatrix(pointerMatrix);\n\n      _this.currentSpeed = _this.speedAxisY.length - currentYIdx;\n\n      _this.speedText.attr('text', _this.currentSpeed + \".0X\");\n\n      _this.group.emit(TIMEBAR_CONFIG_CHANGE, {\n        speed: _this.currentSpeed,\n        type: _this.currentType\n      });\n    });\n\n    if (this.toggleGroup) {\n      this.toggleGroup.on('toggle-model:click', function (evt) {\n        var _a, _b;\n\n        var isChecked = evt.target.get('isChecked');\n\n        if (!isChecked) {\n          _this.checkedIcon.show();\n\n          _this.checkedText.attr('text', ((_a = _this.controllerCfg) === null || _a === void 0 ? void 0 : _a.timeRangeControllerText) || '时间范围');\n\n          _this.currentType = 'single';\n        } else {\n          _this.checkedIcon.hide();\n\n          _this.checkedText.attr('text', ((_b = _this.controllerCfg) === null || _b === void 0 ? void 0 : _b.timePointControllerText) || '单一时间');\n\n          _this.currentType = 'range';\n        }\n\n        evt.target.set('isChecked', !isChecked);\n\n        _this.group.emit(TIMEBAR_CONFIG_CHANGE, {\n          type: _this.currentType,\n          speed: _this.currentSpeed\n        });\n      });\n    }\n  };\n\n  ControllerBtn.prototype.destroy = function () {\n    this.speedGroup.off('speed-rect:click');\n\n    if (this.toggleGroup) {\n      this.toggleGroup.off('toggle-model:click');\n      this.toggleGroup.destroy();\n    }\n\n    this.speedGroup.destroy();\n  };\n\n  return ControllerBtn;\n}();\n\nexport default ControllerBtn;"]},"metadata":{},"sourceType":"module"}