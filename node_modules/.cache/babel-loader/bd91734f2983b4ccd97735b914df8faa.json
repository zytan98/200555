{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n/**\n * 基于 G 的时间轴组件\n */\n\n\nimport { Canvas as GCanvas } from '@antv/g-canvas';\nimport { Canvas as GSVGCanvas } from '@antv/g-svg';\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport Base from '../base';\nimport TrendTimeBar from './trendTimeBar';\nimport TimeBarSlice from './timeBarSlice';\nimport { VALUE_CHANGE } from './constant';\nimport { isString, throttle } from '@antv/util'; // simple 版本默认高度\n\nvar DEFAULT_SIMPLE_HEIGHT = 4; // trend 版本默认高度\n\nvar DEFAULT_TREND_HEIGHT = 26;\n\nvar TimeBar =\n/** @class */\nfunction (_super) {\n  __extends(TimeBar, _super);\n\n  function TimeBar() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeBar.prototype.getDefaultCfgs = function () {\n    return {\n      container: null,\n      className: 'g6-component-timebar',\n      padding: 10,\n      type: 'trend',\n      trend: {\n        data: [],\n        isArea: false,\n        smooth: true\n      },\n      controllerCfg: {\n        speed: 1,\n        loop: false\n      },\n      slider: {\n        start: 0.1,\n        end: 0.9,\n        minText: 'min',\n        maxText: 'max'\n      },\n      tick: {\n        start: 0.1,\n        end: 0.9,\n        data: []\n      },\n      textStyle: {},\n      filterEdge: false\n    };\n  };\n  /**\n   * 初始化 TimeBar 的容器\n   */\n\n\n  TimeBar.prototype.initContainer = function () {\n    var graph = this.get('graph');\n    var _a = this._cfgs,\n        width = _a.width,\n        height = _a.height;\n    var className = this.get('className') || 'g6-component-timebar';\n    var container = this.get('container');\n    var graphContainer = this.get('graph').get('container');\n    var timeBarContainer;\n\n    if (!container) {\n      timeBarContainer = createDom(\"<div class='\" + className + \"'></div>\");\n      modifyCSS(timeBarContainer, {\n        position: 'relative'\n      });\n    } else {\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      timeBarContainer = container;\n    }\n\n    graphContainer.appendChild(timeBarContainer);\n    this.set('timeBarContainer', timeBarContainer);\n    var canvas;\n    var renderer = graph.get('renderer');\n\n    if (renderer === 'SVG') {\n      canvas = new GSVGCanvas({\n        container: timeBarContainer,\n        width: width,\n        height: height\n      });\n    } else {\n      canvas = new GCanvas({\n        container: timeBarContainer,\n        width: width,\n        height: height\n      });\n    }\n\n    this.set('canvas', canvas);\n  };\n\n  TimeBar.prototype.init = function () {\n    this.initContainer();\n    var canvas = this.get('canvas');\n    var timeBarGroup = canvas.addGroup({\n      name: 'timebar-group'\n    });\n    this.set('timeBarGroup', timeBarGroup);\n    this.renderTrend();\n    this.initEvent();\n    var fontFamily = typeof window !== 'undefined' ? window.getComputedStyle(document.body, null).getPropertyValue('font-family') || 'Arial, sans-serif' : 'Arial, sans-serif';\n    this.set('fontFamily', fontFamily);\n  };\n\n  TimeBar.prototype.renderTrend = function () {\n    var _a = this._cfgs,\n        width = _a.width,\n        x = _a.x,\n        y = _a.y,\n        padding = _a.padding,\n        type = _a.type,\n        trend = _a.trend,\n        slider = _a.slider,\n        controllerCfg = _a.controllerCfg,\n        textStyle = _a.textStyle,\n        tick = _a.tick,\n        backgroundStyle = _a.backgroundStyle,\n        foregroundStyle = _a.foregroundStyle;\n\n    var data = trend.data,\n        other = __rest(trend, [\"data\"]);\n\n    var realWidth = width - 2 * padding;\n    var defaultHeight = type === 'trend' ? DEFAULT_TREND_HEIGHT : DEFAULT_SIMPLE_HEIGHT;\n    var graph = this.get('graph');\n    var group = this.get('timeBarGroup');\n    var canvas = this.get('canvas');\n    var timebar = null;\n\n    if (type === 'trend' || type === 'simple') {\n      timebar = new TrendTimeBar(__assign(__assign({\n        graph: graph,\n        canvas: canvas,\n        group: group,\n        type: type,\n        x: x + padding,\n        y: type === 'trend' ? y + padding : y + padding + 15,\n        width: realWidth,\n        height: defaultHeight,\n        padding: padding,\n        backgroundStyle: backgroundStyle,\n        foregroundStyle: foregroundStyle,\n        trendCfg: __assign(__assign({}, other), {\n          data: data.map(function (d) {\n            return d.value;\n          })\n        })\n      }, slider), {\n        tick: {\n          ticks: data,\n          tickLabelFormatter: tick.tickLabelFormatter,\n          tickLabelStyle: tick.tickLabelStyle,\n          tickLineStyle: tick.tickLineStyle\n        },\n        handlerStyle: __assign(__assign({}, slider.handlerStyle), {\n          height: slider.height || defaultHeight\n        }),\n        controllerCfg: controllerCfg,\n        textStyle: textStyle\n      }));\n    } else if (type === 'tick') {\n      // 刻度时间轴\n      timebar = new TimeBarSlice(__assign({\n        graph: graph,\n        canvas: canvas,\n        group: group,\n        x: x + padding,\n        y: y + padding\n      }, tick));\n    }\n\n    this.set('timebar', timebar);\n  };\n\n  TimeBar.prototype.filterData = function (evt) {\n    var _a;\n\n    var value = evt.value;\n    var trendData = null;\n    var type = this._cfgs.type;\n\n    if (type === 'trend' || type === 'simple') {\n      trendData = this._cfgs.trend.data;\n    } else if (type === 'tick') {\n      trendData = this._cfgs.tick.data;\n    }\n\n    if (!trendData || trendData.length === 0) {\n      console.warn('请配置 TimeBar 组件的数据');\n      return;\n    }\n\n    var rangeChange = this.get('rangeChange');\n    var graph = this.get('graph');\n    var min = Math.round(trendData.length * value[0]);\n    var max = Math.round(trendData.length * value[1]);\n    max = max >= trendData.length ? trendData.length - 1 : max;\n    min = min >= trendData.length ? trendData.length - 1 : min;\n    var tickLabelFormatter = (_a = this._cfgs.tick) === null || _a === void 0 ? void 0 : _a.tickLabelFormatter;\n    var minText = tickLabelFormatter ? tickLabelFormatter(trendData[min]) : trendData[min].date;\n    var maxText = tickLabelFormatter ? tickLabelFormatter(trendData[max]) : trendData[max].date;\n\n    if (type !== 'tick') {\n      var timebar = this.get('timebar');\n      timebar.setText(minText, maxText);\n    }\n\n    if (rangeChange) {\n      rangeChange(graph, minText, maxText);\n    } else {\n      // 自动过滤数据，并渲染 graph\n      if (!this.cacheGraphData || this.cacheGraphData.nodes && this.cacheGraphData.nodes.length === 0) {\n        this.cacheGraphData = graph.get('data'); // graph.save() as GraphData;\n      } // 过滤不在 min 和 max 范围内的节点\n\n\n      var filterData = this.cacheGraphData.nodes.filter(function (d) {\n        return d.date >= trendData[min].date && d.date <= trendData[max].date;\n      });\n      var nodeIds_1 = filterData.map(function (node) {\n        return node.id;\n      });\n      var fileterEdges = [];\n\n      if (this.cacheGraphData.edges) {\n        // 过滤 source 或 target 不在 min 和 max 范围内的边\n        fileterEdges = this.cacheGraphData.edges.filter(function (edge) {\n          return nodeIds_1.includes(edge.source) && nodeIds_1.includes(edge.target);\n        });\n\n        if (this.get('filterEdge')) {\n          fileterEdges = fileterEdges.filter(function (edge) {\n            return edge.date >= trendData[min].date && edge.date <= trendData[max].date;\n          });\n        }\n      }\n\n      graph.changeData({\n        nodes: filterData,\n        edges: fileterEdges\n      });\n    }\n  };\n\n  TimeBar.prototype.initEvent = function () {\n    var _this = this;\n\n    var start = 0;\n    var end = 0;\n    var type = this._cfgs.type;\n\n    if (!type || type === 'trend' || type === 'simple') {\n      start = this._cfgs.slider.start;\n      end = this._cfgs.slider.end;\n    } else if (type === 'tick') {\n      start = this._cfgs.tick.start;\n      end = this._cfgs.tick.end;\n    }\n\n    var graph = this.get('graph');\n    graph.on('afterrender', function (e) {\n      _this.filterData({\n        value: [start, end]\n      });\n    }); // 时间轴的值发生改变的事件\n\n    graph.on(VALUE_CHANGE, throttle(function (e) {\n      _this.filterData(e);\n    }, 200, {\n      trailing: true,\n      leading: true\n    }));\n  };\n\n  TimeBar.prototype.destroy = function () {\n    var timebar = this.get('timebar');\n\n    if (timebar && timebar.destory) {\n      timebar.destory();\n    }\n\n    _super.prototype.destroy.call(this);\n\n    var timeBarContainer = this.get('timeBarContainer');\n\n    if (timeBarContainer) {\n      var container = this.get('container');\n\n      if (!container) {\n        container = this.get('graph').get('container');\n      }\n\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      container.removeChild(timeBarContainer);\n    }\n  };\n\n  return TimeBar;\n}(Base);\n\nexport default TimeBar;","map":{"version":3,"sources":["C:/Users/Home/Desktop/cs-2005/node_modules/@antv/g6-plugin/es/timeBar/index.js"],"names":["__extends","_extendStatics","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","__assign","assign","t","s","i","n","arguments","length","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","Canvas","GCanvas","GSVGCanvas","createDom","modifyCSS","Base","TrendTimeBar","TimeBarSlice","VALUE_CHANGE","isString","throttle","DEFAULT_SIMPLE_HEIGHT","DEFAULT_TREND_HEIGHT","TimeBar","_super","getDefaultCfgs","container","className","padding","type","trend","data","isArea","smooth","controllerCfg","speed","loop","slider","start","end","minText","maxText","tick","textStyle","filterEdge","initContainer","graph","get","_a","_cfgs","width","height","graphContainer","timeBarContainer","position","document","getElementById","appendChild","set","canvas","renderer","init","timeBarGroup","addGroup","name","renderTrend","initEvent","fontFamily","window","getComputedStyle","body","getPropertyValue","x","y","backgroundStyle","foregroundStyle","other","realWidth","defaultHeight","group","timebar","trendCfg","map","value","ticks","tickLabelFormatter","tickLabelStyle","tickLineStyle","handlerStyle","filterData","evt","trendData","console","warn","rangeChange","min","Math","round","max","date","setText","cacheGraphData","nodes","filter","nodeIds_1","node","id","fileterEdges","edges","edge","includes","source","target","changeData","_this","on","trailing","leading","destroy","destory","removeChild"],"mappings":"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","sourcesContent":["var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __rest = this && this.__rest || function (s, e) {\n  var t = {};\n\n  for (var p in s) {\n    if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  }\n\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\n/**\n * 基于 G 的时间轴组件\n */\n\n\nimport { Canvas as GCanvas } from '@antv/g-canvas';\nimport { Canvas as GSVGCanvas } from '@antv/g-svg';\nimport { createDom, modifyCSS } from '@antv/dom-util';\nimport Base from '../base';\nimport TrendTimeBar from './trendTimeBar';\nimport TimeBarSlice from './timeBarSlice';\nimport { VALUE_CHANGE } from './constant';\nimport { isString, throttle } from '@antv/util'; // simple 版本默认高度\n\nvar DEFAULT_SIMPLE_HEIGHT = 4; // trend 版本默认高度\n\nvar DEFAULT_TREND_HEIGHT = 26;\n\nvar TimeBar =\n/** @class */\nfunction (_super) {\n  __extends(TimeBar, _super);\n\n  function TimeBar() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  TimeBar.prototype.getDefaultCfgs = function () {\n    return {\n      container: null,\n      className: 'g6-component-timebar',\n      padding: 10,\n      type: 'trend',\n      trend: {\n        data: [],\n        isArea: false,\n        smooth: true\n      },\n      controllerCfg: {\n        speed: 1,\n        loop: false\n      },\n      slider: {\n        start: 0.1,\n        end: 0.9,\n        minText: 'min',\n        maxText: 'max'\n      },\n      tick: {\n        start: 0.1,\n        end: 0.9,\n        data: []\n      },\n      textStyle: {},\n      filterEdge: false\n    };\n  };\n  /**\n   * 初始化 TimeBar 的容器\n   */\n\n\n  TimeBar.prototype.initContainer = function () {\n    var graph = this.get('graph');\n    var _a = this._cfgs,\n        width = _a.width,\n        height = _a.height;\n    var className = this.get('className') || 'g6-component-timebar';\n    var container = this.get('container');\n    var graphContainer = this.get('graph').get('container');\n    var timeBarContainer;\n\n    if (!container) {\n      timeBarContainer = createDom(\"<div class='\" + className + \"'></div>\");\n      modifyCSS(timeBarContainer, {\n        position: 'relative'\n      });\n    } else {\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      timeBarContainer = container;\n    }\n\n    graphContainer.appendChild(timeBarContainer);\n    this.set('timeBarContainer', timeBarContainer);\n    var canvas;\n    var renderer = graph.get('renderer');\n\n    if (renderer === 'SVG') {\n      canvas = new GSVGCanvas({\n        container: timeBarContainer,\n        width: width,\n        height: height\n      });\n    } else {\n      canvas = new GCanvas({\n        container: timeBarContainer,\n        width: width,\n        height: height\n      });\n    }\n\n    this.set('canvas', canvas);\n  };\n\n  TimeBar.prototype.init = function () {\n    this.initContainer();\n    var canvas = this.get('canvas');\n    var timeBarGroup = canvas.addGroup({\n      name: 'timebar-group'\n    });\n    this.set('timeBarGroup', timeBarGroup);\n    this.renderTrend();\n    this.initEvent();\n    var fontFamily = typeof window !== 'undefined' ? window.getComputedStyle(document.body, null).getPropertyValue('font-family') || 'Arial, sans-serif' : 'Arial, sans-serif';\n    this.set('fontFamily', fontFamily);\n  };\n\n  TimeBar.prototype.renderTrend = function () {\n    var _a = this._cfgs,\n        width = _a.width,\n        x = _a.x,\n        y = _a.y,\n        padding = _a.padding,\n        type = _a.type,\n        trend = _a.trend,\n        slider = _a.slider,\n        controllerCfg = _a.controllerCfg,\n        textStyle = _a.textStyle,\n        tick = _a.tick,\n        backgroundStyle = _a.backgroundStyle,\n        foregroundStyle = _a.foregroundStyle;\n\n    var data = trend.data,\n        other = __rest(trend, [\"data\"]);\n\n    var realWidth = width - 2 * padding;\n    var defaultHeight = type === 'trend' ? DEFAULT_TREND_HEIGHT : DEFAULT_SIMPLE_HEIGHT;\n    var graph = this.get('graph');\n    var group = this.get('timeBarGroup');\n    var canvas = this.get('canvas');\n    var timebar = null;\n\n    if (type === 'trend' || type === 'simple') {\n      timebar = new TrendTimeBar(__assign(__assign({\n        graph: graph,\n        canvas: canvas,\n        group: group,\n        type: type,\n        x: x + padding,\n        y: type === 'trend' ? y + padding : y + padding + 15,\n        width: realWidth,\n        height: defaultHeight,\n        padding: padding,\n        backgroundStyle: backgroundStyle,\n        foregroundStyle: foregroundStyle,\n        trendCfg: __assign(__assign({}, other), {\n          data: data.map(function (d) {\n            return d.value;\n          })\n        })\n      }, slider), {\n        tick: {\n          ticks: data,\n          tickLabelFormatter: tick.tickLabelFormatter,\n          tickLabelStyle: tick.tickLabelStyle,\n          tickLineStyle: tick.tickLineStyle\n        },\n        handlerStyle: __assign(__assign({}, slider.handlerStyle), {\n          height: slider.height || defaultHeight\n        }),\n        controllerCfg: controllerCfg,\n        textStyle: textStyle\n      }));\n    } else if (type === 'tick') {\n      // 刻度时间轴\n      timebar = new TimeBarSlice(__assign({\n        graph: graph,\n        canvas: canvas,\n        group: group,\n        x: x + padding,\n        y: y + padding\n      }, tick));\n    }\n\n    this.set('timebar', timebar);\n  };\n\n  TimeBar.prototype.filterData = function (evt) {\n    var _a;\n\n    var value = evt.value;\n    var trendData = null;\n    var type = this._cfgs.type;\n\n    if (type === 'trend' || type === 'simple') {\n      trendData = this._cfgs.trend.data;\n    } else if (type === 'tick') {\n      trendData = this._cfgs.tick.data;\n    }\n\n    if (!trendData || trendData.length === 0) {\n      console.warn('请配置 TimeBar 组件的数据');\n      return;\n    }\n\n    var rangeChange = this.get('rangeChange');\n    var graph = this.get('graph');\n    var min = Math.round(trendData.length * value[0]);\n    var max = Math.round(trendData.length * value[1]);\n    max = max >= trendData.length ? trendData.length - 1 : max;\n    min = min >= trendData.length ? trendData.length - 1 : min;\n    var tickLabelFormatter = (_a = this._cfgs.tick) === null || _a === void 0 ? void 0 : _a.tickLabelFormatter;\n    var minText = tickLabelFormatter ? tickLabelFormatter(trendData[min]) : trendData[min].date;\n    var maxText = tickLabelFormatter ? tickLabelFormatter(trendData[max]) : trendData[max].date;\n\n    if (type !== 'tick') {\n      var timebar = this.get('timebar');\n      timebar.setText(minText, maxText);\n    }\n\n    if (rangeChange) {\n      rangeChange(graph, minText, maxText);\n    } else {\n      // 自动过滤数据，并渲染 graph\n      if (!this.cacheGraphData || this.cacheGraphData.nodes && this.cacheGraphData.nodes.length === 0) {\n        this.cacheGraphData = graph.get('data'); // graph.save() as GraphData;\n      } // 过滤不在 min 和 max 范围内的节点\n\n\n      var filterData = this.cacheGraphData.nodes.filter(function (d) {\n        return d.date >= trendData[min].date && d.date <= trendData[max].date;\n      });\n      var nodeIds_1 = filterData.map(function (node) {\n        return node.id;\n      });\n      var fileterEdges = [];\n\n      if (this.cacheGraphData.edges) {\n        // 过滤 source 或 target 不在 min 和 max 范围内的边\n        fileterEdges = this.cacheGraphData.edges.filter(function (edge) {\n          return nodeIds_1.includes(edge.source) && nodeIds_1.includes(edge.target);\n        });\n\n        if (this.get('filterEdge')) {\n          fileterEdges = fileterEdges.filter(function (edge) {\n            return edge.date >= trendData[min].date && edge.date <= trendData[max].date;\n          });\n        }\n      }\n\n      graph.changeData({\n        nodes: filterData,\n        edges: fileterEdges\n      });\n    }\n  };\n\n  TimeBar.prototype.initEvent = function () {\n    var _this = this;\n\n    var start = 0;\n    var end = 0;\n    var type = this._cfgs.type;\n\n    if (!type || type === 'trend' || type === 'simple') {\n      start = this._cfgs.slider.start;\n      end = this._cfgs.slider.end;\n    } else if (type === 'tick') {\n      start = this._cfgs.tick.start;\n      end = this._cfgs.tick.end;\n    }\n\n    var graph = this.get('graph');\n    graph.on('afterrender', function (e) {\n      _this.filterData({\n        value: [start, end]\n      });\n    }); // 时间轴的值发生改变的事件\n\n    graph.on(VALUE_CHANGE, throttle(function (e) {\n      _this.filterData(e);\n    }, 200, {\n      trailing: true,\n      leading: true\n    }));\n  };\n\n  TimeBar.prototype.destroy = function () {\n    var timebar = this.get('timebar');\n\n    if (timebar && timebar.destory) {\n      timebar.destory();\n    }\n\n    _super.prototype.destroy.call(this);\n\n    var timeBarContainer = this.get('timeBarContainer');\n\n    if (timeBarContainer) {\n      var container = this.get('container');\n\n      if (!container) {\n        container = this.get('graph').get('container');\n      }\n\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      container.removeChild(timeBarContainer);\n    }\n  };\n\n  return TimeBar;\n}(Base);\n\nexport default TimeBar;"]},"metadata":{},"sourceType":"module"}