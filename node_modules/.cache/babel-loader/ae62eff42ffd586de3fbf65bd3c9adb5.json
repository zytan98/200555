{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Date.prototype.toString.call(Reflect.construct(Date, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nimport { gl } from '../..';\nimport { Component } from '../../ComponentManager';\nexport var MaterialComponent = /*#__PURE__*/function (_Component) {\n  _inherits(MaterialComponent, _Component);\n\n  var _super = _createSuper(MaterialComponent); // control flow in shaders, eg. USE_UV, USE_MAP...\n\n\n  function MaterialComponent(data) {\n    var _this;\n\n    _classCallCheck(this, MaterialComponent);\n\n    _this = _super.call(this, data);\n    _this.vertexShaderGLSL = void 0;\n    _this.fragmentShaderGLSL = void 0;\n    _this.defines = {};\n    _this.dirty = true;\n    _this.uniforms = [];\n    _this.cull = {\n      enable: true,\n      face: gl.BACK\n    };\n    _this.depth = {\n      enable: true\n    };\n    _this.blend = void 0;\n    _this.entity = void 0;\n    _this.type = void 0;\n    Object.assign(_assertThisInitialized(_this), data);\n    return _this;\n  }\n\n  _createClass(MaterialComponent, [{\n    key: \"setDefines\",\n    value: function setDefines(defines) {\n      this.defines = _objectSpread(_objectSpread({}, this.defines), defines);\n      return this;\n    }\n  }, {\n    key: \"setCull\",\n    value: function setCull(cull) {\n      this.cull = cull;\n      return this;\n    }\n  }, {\n    key: \"setDepth\",\n    value: function setDepth(depth) {\n      this.depth = depth;\n      return this;\n    }\n  }, {\n    key: \"setBlend\",\n    value: function setBlend(blend) {\n      this.blend = blend;\n      return this;\n    }\n  }, {\n    key: \"setUniform\",\n    value: function setUniform(name, data) {\n      var _this2 = this;\n\n      if (typeof name !== 'string') {\n        Object.keys(name).forEach(function (key) {\n          return _this2.setUniform(key, name[key]);\n        });\n        return this;\n      }\n\n      var existedUniform = this.uniforms.find(function (u) {\n        return u.name === name;\n      });\n\n      if (!existedUniform) {\n        this.uniforms.push({\n          name: name,\n          dirty: true,\n          data: data\n        });\n      } else {\n        existedUniform.dirty = true;\n        existedUniform.data = data;\n      }\n\n      this.dirty = true;\n      return this;\n    }\n  }]);\n\n  return MaterialComponent;\n}(Component);","map":{"version":3,"sources":["../../../src/components/material/MaterialComponent.ts"],"names":["MaterialComponent","vertexShaderGLSL","fragmentShaderGLSL","defines","dirty","uniforms","cull","enable","face","gl","BACK","depth","blend","entity","type","Object","name","existedUniform","u","data"],"mappings":"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","sourcesContent":["import { Entity, gl } from '../..';\nimport { Component } from '../../ComponentManager';\nimport { NonFunctionProperties } from '../../ComponentManager';\nimport { IModelInitializationOptions } from '../renderer/IModel';\nimport { BufferData } from '../renderer/IRendererService';\nimport { IUniformBinding } from './interface';\n\nexport class MaterialComponent extends Component<MaterialComponent> {\n  public vertexShaderGLSL: string;\n\n  public fragmentShaderGLSL: string;\n\n  // control flow in shaders, eg. USE_UV, USE_MAP...\n  public defines: Record<string, boolean | number> = {};\n\n  public dirty = true;\n\n  public uniforms: IUniformBinding[] = [];\n\n  public cull: IModelInitializationOptions['cull'] = {\n    enable: true,\n    face: gl.BACK,\n  };\n\n  public depth: IModelInitializationOptions['depth'] = {\n    enable: true,\n  };\n\n  public blend: IModelInitializationOptions['blend'];\n\n  public entity: Entity;\n\n  public type: string;\n\n  constructor(data: Partial<NonFunctionProperties<MaterialComponent>>) {\n    super(data);\n\n    Object.assign(this, data);\n  }\n\n  public setDefines(defines: Record<string, boolean | number>) {\n    this.defines = { ...this.defines, ...defines };\n    return this;\n  }\n\n  public setCull(cull: IModelInitializationOptions['cull']) {\n    this.cull = cull;\n    return this;\n  }\n\n  public setDepth(depth: IModelInitializationOptions['depth']) {\n    this.depth = depth;\n    return this;\n  }\n\n  public setBlend(blend: IModelInitializationOptions['blend']) {\n    this.blend = blend;\n    return this;\n  }\n\n  public setUniform(\n    name: string | Record<string, BufferData>,\n    data?: BufferData,\n  ) {\n    if (typeof name !== 'string') {\n      Object.keys(name).forEach((key) => this.setUniform(key, name[key]));\n      return this;\n    }\n\n    const existedUniform = this.uniforms.find((u) => u.name === name);\n    if (!existedUniform) {\n      this.uniforms.push({\n        name,\n        dirty: true,\n        data: data!,\n      });\n    } else {\n      existedUniform.dirty = true;\n      existedUniform.data = data!;\n    }\n\n    this.dirty = true;\n    return this;\n  }\n}\n"]},"metadata":{},"sourceType":"module"}