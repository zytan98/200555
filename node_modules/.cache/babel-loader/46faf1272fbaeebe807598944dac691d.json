{"ast":null,"code":"var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { modifyCSS, createDom } from '@antv/dom-util';\nimport { isArray, isString } from '@antv/util';\nimport insertCss from 'insert-css';\nimport Base from '../base';\ninsertCss(\"\\n  .g6-component-tooltip {\\n    border: 1px solid #e2e2e2;\\n    border-radius: 4px;\\n    font-size: 12px;\\n    color: #545454;\\n    background-color: rgba(255, 255, 255, 0.9);\\n    padding: 10px 8px;\\n    box-shadow: rgb(174, 174, 174) 0px 0px 10px;\\n  }\\n  .tooltip-type {\\n    padding: 0;\\n    margin: 0;\\n  }\\n  .tooltip-id {\\n    color: #531dab;\\n  }\\n\");\n\nvar Tooltip =\n/** @class */\nfunction (_super) {\n  __extends(Tooltip, _super);\n\n  function Tooltip() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Tooltip.prototype.getDefaultCfgs = function () {\n    return {\n      offsetX: 6,\n      offsetY: 6,\n      // 指定菜单内容，function(e) {...}\n      getContent: function getContent(e) {\n        return \"\\n          <h4 class='tooltip-type'>\\u7C7B\\u578B\\uFF1A\" + e.item.getType() + \"</h4>\\n          <span class='tooltip-id'>ID\\uFF1A\" + e.item.getID() + \"</span>\\n        \";\n      },\n      shouldBegin: function shouldBegin(e) {\n        return true;\n      },\n      itemTypes: ['node', 'edge', 'combo'],\n      trigger: 'mouseenter',\n      fixToNode: undefined\n    };\n  }; // class-methods-use-this\n\n\n  Tooltip.prototype.getEvents = function () {\n    if (this.get('trigger') === 'click') {\n      return {\n        'node:click': 'onClick',\n        'edge:click': 'onClick',\n        'combo:click': 'onClick',\n        'canvas:click': 'onMouseLeave',\n        afterremoveitem: 'onMouseLeave',\n        contextmenu: 'onMouseLeave',\n        'drag': 'onMouseLeave'\n      };\n    }\n\n    return {\n      'node:mouseenter': 'onMouseEnter',\n      'node:mouseleave': 'onMouseLeave',\n      'node:mousemove': 'onMouseMove',\n      'edge:mouseenter': 'onMouseEnter',\n      'edge:mouseleave': 'onMouseLeave',\n      'edge:mousemove': 'onMouseMove',\n      'combo:mouseenter': 'onMouseEnter',\n      'combo:mouseleave': 'onMouseLeave',\n      'combo:mousemove': 'onMouseMove',\n      afterremoveitem: 'onMouseLeave',\n      contextmenu: 'onMouseLeave',\n      'node:drag': 'onMouseLeave'\n    };\n  };\n\n  Tooltip.prototype.init = function () {\n    var className = this.get('className') || 'g6-component-tooltip';\n    var tooltip = createDom(\"<div class=\" + className + \"></div>\");\n    var container = this.get('container');\n\n    if (!container) {\n      container = this.get('graph').get('container');\n    }\n\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n\n    modifyCSS(tooltip, {\n      position: 'absolute',\n      visibility: 'hidden',\n      display: 'none'\n    });\n    container.appendChild(tooltip);\n    this.set('tooltip', tooltip);\n  };\n\n  Tooltip.prototype.onClick = function (e) {\n    var itemTypes = this.get('itemTypes');\n    if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n    var item = e.item;\n    var graph = this.get('graph'); // 若与上一次同一 item，隐藏该 tooltip\n\n    if (this.currentTarget === item) {\n      this.currentTarget = null;\n      this.hideTooltip();\n      graph.emit('tooltipchange', {\n        item: e.item,\n        action: 'hide'\n      });\n    } else {\n      this.currentTarget = item;\n      this.showTooltip(e);\n      graph.emit('tooltipchange', {\n        item: e.item,\n        action: 'show'\n      });\n    }\n  };\n\n  Tooltip.prototype.onMouseEnter = function (e) {\n    var itemTypes = this.get('itemTypes');\n    if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n    var item = e.item;\n    var graph = this.get('graph');\n    this.currentTarget = item;\n    this.showTooltip(e);\n    graph.emit('tooltipchange', {\n      item: e.item,\n      action: 'show'\n    });\n  };\n\n  Tooltip.prototype.onMouseMove = function (e) {\n    var itemTypes = this.get('itemTypes');\n    if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n\n    if (!this.currentTarget || e.item !== this.currentTarget) {\n      return;\n    }\n\n    this.showTooltip(e);\n  };\n\n  Tooltip.prototype.onMouseLeave = function () {\n    this.hideTooltip();\n    var graph = this.get('graph');\n    graph.emit('tooltipchange', {\n      item: this.currentTarget,\n      action: 'hide'\n    });\n    this.currentTarget = null;\n  };\n\n  Tooltip.prototype.showTooltip = function (e) {\n    if (!e.item) {\n      return;\n    }\n\n    var itemTypes = this.get('itemTypes');\n    if (e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n    var container = this.get('tooltip');\n    var getContent = this.get('getContent');\n    var tooltip = getContent(e);\n\n    if (isString(tooltip)) {\n      container.innerHTML = tooltip;\n    } else {\n      container.innerHTML = tooltip.outerHTML;\n    }\n\n    this.updatePosition(e);\n  };\n\n  Tooltip.prototype.hideTooltip = function () {\n    var tooltip = this.get('tooltip');\n\n    if (tooltip) {\n      modifyCSS(tooltip, {\n        visibility: 'hidden',\n        display: 'none'\n      });\n    }\n  };\n\n  Tooltip.prototype.updatePosition = function (e) {\n    var shouldBegin = this.get('shouldBegin');\n    var tooltip = this.get('tooltip');\n\n    if (!shouldBegin(e)) {\n      modifyCSS(tooltip, {\n        visibility: 'hidden',\n        display: 'none'\n      });\n      return;\n    }\n\n    var graph = this.get('graph');\n    var width = graph.get('width');\n    var height = graph.get('height');\n    var offsetX = this.get('offsetX') || 0;\n    var offsetY = this.get('offsetY') || 0; // const mousePos = graph.getPointByClient(e.clientX, e.clientY);\n\n    var point = graph.getPointByClient(e.clientX, e.clientY);\n    var fixToNode = this.get('fixToNode');\n    var item = e.item;\n\n    if (item.getType && item.getType() === 'node' && fixToNode && isArray(fixToNode) && fixToNode.length >= 2) {\n      var itemBBox = item.getBBox();\n      point = {\n        x: itemBBox.minX + itemBBox.width * fixToNode[0],\n        y: itemBBox.minY + itemBBox.height * fixToNode[1]\n      };\n    }\n\n    var _a = graph.getCanvasByPoint(point.x, point.y),\n        x = _a.x,\n        y = _a.y;\n\n    var graphContainer = graph.getContainer();\n    var res = {\n      x: x + graphContainer.offsetLeft + offsetX,\n      y: y + graphContainer.offsetTop + offsetY\n    }; // 先修改为 visible 方可正确计算 bbox\n\n    modifyCSS(tooltip, {\n      visibility: 'visible',\n      display: 'unset'\n    });\n    var bbox = tooltip.getBoundingClientRect();\n\n    if (x + bbox.width + offsetX > width) {\n      res.x -= bbox.width + offsetX;\n    }\n\n    if (y + bbox.height + offsetY > height) {\n      res.y -= bbox.height + offsetY;\n    }\n\n    modifyCSS(tooltip, {\n      left: res.x + \"px\",\n      top: res.y + \"px\"\n    });\n  };\n\n  Tooltip.prototype.hide = function () {\n    this.onMouseLeave();\n  };\n\n  Tooltip.prototype.destroy = function () {\n    var tooltip = this.get('tooltip');\n\n    if (tooltip) {\n      var container = this.get('container');\n\n      if (!container) {\n        container = this.get('graph').get('container');\n      }\n\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      container.removeChild(tooltip);\n    }\n  };\n\n  return Tooltip;\n}(Base);\n\nexport default Tooltip;","map":{"version":3,"sources":["C:/Users/Home/Desktop/cs-2005/node_modules/@antv/g6-plugin/es/tooltip/index.js"],"names":["__extends","_extendStatics","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","TypeError","String","__","constructor","create","modifyCSS","createDom","isArray","isString","insertCss","Base","Tooltip","_super","apply","arguments","getDefaultCfgs","offsetX","offsetY","getContent","e","item","getType","getID","shouldBegin","itemTypes","trigger","fixToNode","undefined","getEvents","get","afterremoveitem","contextmenu","init","className","tooltip","container","document","getElementById","position","visibility","display","appendChild","set","onClick","indexOf","graph","currentTarget","hideTooltip","emit","action","showTooltip","onMouseEnter","onMouseMove","onMouseLeave","innerHTML","outerHTML","updatePosition","width","height","point","getPointByClient","clientX","clientY","length","itemBBox","getBBox","x","minX","y","minY","_a","getCanvasByPoint","graphContainer","getContainer","res","offsetLeft","offsetTop","bbox","getBoundingClientRect","left","top","hide","destroy","removeChild"],"mappings":"AAAA,IAAIA,SAAS,GAAG,QAAQ,KAAKA,SAAb,IAA0B,YAAY;AACpD,MAAIC,cAAc,GAAG,SAASC,aAAT,CAAuBC,CAAvB,EAA0BC,CAA1B,EAA6B;AAChDH,IAAAA,cAAc,GAAGI,MAAM,CAACC,cAAP,IAAyB;AACxCC,MAAAA,SAAS,EAAE;AAD6B,iBAE7BC,KAF6B,IAEpB,UAAUL,CAAV,EAAaC,CAAb,EAAgB;AACpCD,MAAAA,CAAC,CAACI,SAAF,GAAcH,CAAd;AACD,KAJgB,IAIZ,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACnB,WAAK,IAAIK,CAAT,IAAcL,CAAd,EAAiB;AACf,YAAIC,MAAM,CAACK,SAAP,CAAiBC,cAAjB,CAAgCC,IAAhC,CAAqCR,CAArC,EAAwCK,CAAxC,CAAJ,EAAgDN,CAAC,CAACM,CAAD,CAAD,GAAOL,CAAC,CAACK,CAAD,CAAR;AACjD;AACF,KARD;;AAUA,WAAOR,cAAc,CAACE,CAAD,EAAIC,CAAJ,CAArB;AACD,GAZD;;AAcA,SAAO,UAAUD,CAAV,EAAaC,CAAb,EAAgB;AACrB,QAAI,OAAOA,CAAP,KAAa,UAAb,IAA2BA,CAAC,KAAK,IAArC,EAA2C,MAAM,IAAIS,SAAJ,CAAc,yBAAyBC,MAAM,CAACV,CAAD,CAA/B,GAAqC,+BAAnD,CAAN;;AAE3CH,IAAAA,cAAc,CAACE,CAAD,EAAIC,CAAJ,CAAd;;AAEA,aAASW,EAAT,GAAc;AACZ,WAAKC,WAAL,GAAmBb,CAAnB;AACD;;AAEDA,IAAAA,CAAC,CAACO,SAAF,GAAcN,CAAC,KAAK,IAAN,GAAaC,MAAM,CAACY,MAAP,CAAcb,CAAd,CAAb,IAAiCW,EAAE,CAACL,SAAH,GAAeN,CAAC,CAACM,SAAjB,EAA4B,IAAIK,EAAJ,EAA7D,CAAd;AACD,GAVD;AAWD,CA1ByC,EAA1C;;AA4BA,SAASG,SAAT,EAAoBC,SAApB,QAAqC,gBAArC;AACA,SAASC,OAAT,EAAkBC,QAAlB,QAAkC,YAAlC;AACA,OAAOC,SAAP,MAAsB,YAAtB;AACA,OAAOC,IAAP,MAAiB,SAAjB;AACAD,SAAS,CAAC,uWAAD,CAAT;;AAEA,IAAIE,OAAO;AACX;AACA,UAAUC,MAAV,EAAkB;AAChBzB,EAAAA,SAAS,CAACwB,OAAD,EAAUC,MAAV,CAAT;;AAEA,WAASD,OAAT,GAAmB;AACjB,WAAOC,MAAM,KAAK,IAAX,IAAmBA,MAAM,CAACC,KAAP,CAAa,IAAb,EAAmBC,SAAnB,CAAnB,IAAoD,IAA3D;AACD;;AAEDH,EAAAA,OAAO,CAACd,SAAR,CAAkBkB,cAAlB,GAAmC,YAAY;AAC7C,WAAO;AACLC,MAAAA,OAAO,EAAE,CADJ;AAELC,MAAAA,OAAO,EAAE,CAFJ;AAGL;AACAC,MAAAA,UAAU,EAAE,SAASA,UAAT,CAAoBC,CAApB,EAAuB;AACjC,eAAO,4DAA4DA,CAAC,CAACC,IAAF,CAAOC,OAAP,EAA5D,GAA+E,oDAA/E,GAAsIF,CAAC,CAACC,IAAF,CAAOE,KAAP,EAAtI,GAAuJ,mBAA9J;AACD,OANI;AAOLC,MAAAA,WAAW,EAAE,SAASA,WAAT,CAAqBJ,CAArB,EAAwB;AACnC,eAAO,IAAP;AACD,OATI;AAULK,MAAAA,SAAS,EAAE,CAAC,MAAD,EAAS,MAAT,EAAiB,OAAjB,CAVN;AAWLC,MAAAA,OAAO,EAAE,YAXJ;AAYLC,MAAAA,SAAS,EAAEC;AAZN,KAAP;AAcD,GAfD,CAPgB,CAsBb;;;AAGHhB,EAAAA,OAAO,CAACd,SAAR,CAAkB+B,SAAlB,GAA8B,YAAY;AACxC,QAAI,KAAKC,GAAL,CAAS,SAAT,MAAwB,OAA5B,EAAqC;AACnC,aAAO;AACL,sBAAc,SADT;AAEL,sBAAc,SAFT;AAGL,uBAAe,SAHV;AAIL,wBAAgB,cAJX;AAKLC,QAAAA,eAAe,EAAE,cALZ;AAMLC,QAAAA,WAAW,EAAE,cANR;AAOL,gBAAQ;AAPH,OAAP;AASD;;AAED,WAAO;AACL,yBAAmB,cADd;AAEL,yBAAmB,cAFd;AAGL,wBAAkB,aAHb;AAIL,yBAAmB,cAJd;AAKL,yBAAmB,cALd;AAML,wBAAkB,aANb;AAOL,0BAAoB,cAPf;AAQL,0BAAoB,cARf;AASL,yBAAmB,aATd;AAULD,MAAAA,eAAe,EAAE,cAVZ;AAWLC,MAAAA,WAAW,EAAE,cAXR;AAYL,mBAAa;AAZR,KAAP;AAcD,GA3BD;;AA6BApB,EAAAA,OAAO,CAACd,SAAR,CAAkBmC,IAAlB,GAAyB,YAAY;AACnC,QAAIC,SAAS,GAAG,KAAKJ,GAAL,CAAS,WAAT,KAAyB,sBAAzC;AACA,QAAIK,OAAO,GAAG5B,SAAS,CAAC,gBAAgB2B,SAAhB,GAA4B,SAA7B,CAAvB;AACA,QAAIE,SAAS,GAAG,KAAKN,GAAL,CAAS,WAAT,CAAhB;;AAEA,QAAI,CAACM,SAAL,EAAgB;AACdA,MAAAA,SAAS,GAAG,KAAKN,GAAL,CAAS,OAAT,EAAkBA,GAAlB,CAAsB,WAAtB,CAAZ;AACD;;AAED,QAAIrB,QAAQ,CAAC2B,SAAD,CAAZ,EAAyB;AACvBA,MAAAA,SAAS,GAAGC,QAAQ,CAACC,cAAT,CAAwBF,SAAxB,CAAZ;AACD;;AAED9B,IAAAA,SAAS,CAAC6B,OAAD,EAAU;AACjBI,MAAAA,QAAQ,EAAE,UADO;AAEjBC,MAAAA,UAAU,EAAE,QAFK;AAGjBC,MAAAA,OAAO,EAAE;AAHQ,KAAV,CAAT;AAKAL,IAAAA,SAAS,CAACM,WAAV,CAAsBP,OAAtB;AACA,SAAKQ,GAAL,CAAS,SAAT,EAAoBR,OAApB;AACD,GApBD;;AAsBAvB,EAAAA,OAAO,CAACd,SAAR,CAAkB8C,OAAlB,GAA4B,UAAUxB,CAAV,EAAa;AACvC,QAAIK,SAAS,GAAG,KAAKK,GAAL,CAAS,WAAT,CAAhB;AACA,QAAIV,CAAC,CAACC,IAAF,IAAUD,CAAC,CAACC,IAAF,CAAOC,OAAjB,IAA4BG,SAAS,CAACoB,OAAV,CAAkBzB,CAAC,CAACC,IAAF,CAAOC,OAAP,EAAlB,MAAwC,CAAC,CAAzE,EAA4E;AAC5E,QAAID,IAAI,GAAGD,CAAC,CAACC,IAAb;AACA,QAAIyB,KAAK,GAAG,KAAKhB,GAAL,CAAS,OAAT,CAAZ,CAJuC,CAIR;;AAE/B,QAAI,KAAKiB,aAAL,KAAuB1B,IAA3B,EAAiC;AAC/B,WAAK0B,aAAL,GAAqB,IAArB;AACA,WAAKC,WAAL;AACAF,MAAAA,KAAK,CAACG,IAAN,CAAW,eAAX,EAA4B;AAC1B5B,QAAAA,IAAI,EAAED,CAAC,CAACC,IADkB;AAE1B6B,QAAAA,MAAM,EAAE;AAFkB,OAA5B;AAID,KAPD,MAOO;AACL,WAAKH,aAAL,GAAqB1B,IAArB;AACA,WAAK8B,WAAL,CAAiB/B,CAAjB;AACA0B,MAAAA,KAAK,CAACG,IAAN,CAAW,eAAX,EAA4B;AAC1B5B,QAAAA,IAAI,EAAED,CAAC,CAACC,IADkB;AAE1B6B,QAAAA,MAAM,EAAE;AAFkB,OAA5B;AAID;AACF,GArBD;;AAuBAtC,EAAAA,OAAO,CAACd,SAAR,CAAkBsD,YAAlB,GAAiC,UAAUhC,CAAV,EAAa;AAC5C,QAAIK,SAAS,GAAG,KAAKK,GAAL,CAAS,WAAT,CAAhB;AACA,QAAIV,CAAC,CAACC,IAAF,IAAUD,CAAC,CAACC,IAAF,CAAOC,OAAjB,IAA4BG,SAAS,CAACoB,OAAV,CAAkBzB,CAAC,CAACC,IAAF,CAAOC,OAAP,EAAlB,MAAwC,CAAC,CAAzE,EAA4E;AAC5E,QAAID,IAAI,GAAGD,CAAC,CAACC,IAAb;AACA,QAAIyB,KAAK,GAAG,KAAKhB,GAAL,CAAS,OAAT,CAAZ;AACA,SAAKiB,aAAL,GAAqB1B,IAArB;AACA,SAAK8B,WAAL,CAAiB/B,CAAjB;AACA0B,IAAAA,KAAK,CAACG,IAAN,CAAW,eAAX,EAA4B;AAC1B5B,MAAAA,IAAI,EAAED,CAAC,CAACC,IADkB;AAE1B6B,MAAAA,MAAM,EAAE;AAFkB,KAA5B;AAID,GAXD;;AAaAtC,EAAAA,OAAO,CAACd,SAAR,CAAkBuD,WAAlB,GAAgC,UAAUjC,CAAV,EAAa;AAC3C,QAAIK,SAAS,GAAG,KAAKK,GAAL,CAAS,WAAT,CAAhB;AACA,QAAIV,CAAC,CAACC,IAAF,IAAUD,CAAC,CAACC,IAAF,CAAOC,OAAjB,IAA4BG,SAAS,CAACoB,OAAV,CAAkBzB,CAAC,CAACC,IAAF,CAAOC,OAAP,EAAlB,MAAwC,CAAC,CAAzE,EAA4E;;AAE5E,QAAI,CAAC,KAAKyB,aAAN,IAAuB3B,CAAC,CAACC,IAAF,KAAW,KAAK0B,aAA3C,EAA0D;AACxD;AACD;;AAED,SAAKI,WAAL,CAAiB/B,CAAjB;AACD,GATD;;AAWAR,EAAAA,OAAO,CAACd,SAAR,CAAkBwD,YAAlB,GAAiC,YAAY;AAC3C,SAAKN,WAAL;AACA,QAAIF,KAAK,GAAG,KAAKhB,GAAL,CAAS,OAAT,CAAZ;AACAgB,IAAAA,KAAK,CAACG,IAAN,CAAW,eAAX,EAA4B;AAC1B5B,MAAAA,IAAI,EAAE,KAAK0B,aADe;AAE1BG,MAAAA,MAAM,EAAE;AAFkB,KAA5B;AAIA,SAAKH,aAAL,GAAqB,IAArB;AACD,GARD;;AAUAnC,EAAAA,OAAO,CAACd,SAAR,CAAkBqD,WAAlB,GAAgC,UAAU/B,CAAV,EAAa;AAC3C,QAAI,CAACA,CAAC,CAACC,IAAP,EAAa;AACX;AACD;;AAED,QAAII,SAAS,GAAG,KAAKK,GAAL,CAAS,WAAT,CAAhB;AACA,QAAIV,CAAC,CAACC,IAAF,CAAOC,OAAP,IAAkBG,SAAS,CAACoB,OAAV,CAAkBzB,CAAC,CAACC,IAAF,CAAOC,OAAP,EAAlB,MAAwC,CAAC,CAA/D,EAAkE;AAClE,QAAIc,SAAS,GAAG,KAAKN,GAAL,CAAS,SAAT,CAAhB;AACA,QAAIX,UAAU,GAAG,KAAKW,GAAL,CAAS,YAAT,CAAjB;AACA,QAAIK,OAAO,GAAGhB,UAAU,CAACC,CAAD,CAAxB;;AAEA,QAAIX,QAAQ,CAAC0B,OAAD,CAAZ,EAAuB;AACrBC,MAAAA,SAAS,CAACmB,SAAV,GAAsBpB,OAAtB;AACD,KAFD,MAEO;AACLC,MAAAA,SAAS,CAACmB,SAAV,GAAsBpB,OAAO,CAACqB,SAA9B;AACD;;AAED,SAAKC,cAAL,CAAoBrC,CAApB;AACD,GAlBD;;AAoBAR,EAAAA,OAAO,CAACd,SAAR,CAAkBkD,WAAlB,GAAgC,YAAY;AAC1C,QAAIb,OAAO,GAAG,KAAKL,GAAL,CAAS,SAAT,CAAd;;AAEA,QAAIK,OAAJ,EAAa;AACX7B,MAAAA,SAAS,CAAC6B,OAAD,EAAU;AACjBK,QAAAA,UAAU,EAAE,QADK;AAEjBC,QAAAA,OAAO,EAAE;AAFQ,OAAV,CAAT;AAID;AACF,GATD;;AAWA7B,EAAAA,OAAO,CAACd,SAAR,CAAkB2D,cAAlB,GAAmC,UAAUrC,CAAV,EAAa;AAC9C,QAAII,WAAW,GAAG,KAAKM,GAAL,CAAS,aAAT,CAAlB;AACA,QAAIK,OAAO,GAAG,KAAKL,GAAL,CAAS,SAAT,CAAd;;AAEA,QAAI,CAACN,WAAW,CAACJ,CAAD,CAAhB,EAAqB;AACnBd,MAAAA,SAAS,CAAC6B,OAAD,EAAU;AACjBK,QAAAA,UAAU,EAAE,QADK;AAEjBC,QAAAA,OAAO,EAAE;AAFQ,OAAV,CAAT;AAIA;AACD;;AAED,QAAIK,KAAK,GAAG,KAAKhB,GAAL,CAAS,OAAT,CAAZ;AACA,QAAI4B,KAAK,GAAGZ,KAAK,CAAChB,GAAN,CAAU,OAAV,CAAZ;AACA,QAAI6B,MAAM,GAAGb,KAAK,CAAChB,GAAN,CAAU,QAAV,CAAb;AACA,QAAIb,OAAO,GAAG,KAAKa,GAAL,CAAS,SAAT,KAAuB,CAArC;AACA,QAAIZ,OAAO,GAAG,KAAKY,GAAL,CAAS,SAAT,KAAuB,CAArC,CAhB8C,CAgBN;;AAExC,QAAI8B,KAAK,GAAGd,KAAK,CAACe,gBAAN,CAAuBzC,CAAC,CAAC0C,OAAzB,EAAkC1C,CAAC,CAAC2C,OAApC,CAAZ;AACA,QAAIpC,SAAS,GAAG,KAAKG,GAAL,CAAS,WAAT,CAAhB;AACA,QAAIT,IAAI,GAAGD,CAAC,CAACC,IAAb;;AAEA,QAAIA,IAAI,CAACC,OAAL,IAAgBD,IAAI,CAACC,OAAL,OAAmB,MAAnC,IAA6CK,SAA7C,IAA0DnB,OAAO,CAACmB,SAAD,CAAjE,IAAgFA,SAAS,CAACqC,MAAV,IAAoB,CAAxG,EAA2G;AACzG,UAAIC,QAAQ,GAAG5C,IAAI,CAAC6C,OAAL,EAAf;AACAN,MAAAA,KAAK,GAAG;AACNO,QAAAA,CAAC,EAAEF,QAAQ,CAACG,IAAT,GAAgBH,QAAQ,CAACP,KAAT,GAAiB/B,SAAS,CAAC,CAAD,CADvC;AAEN0C,QAAAA,CAAC,EAAEJ,QAAQ,CAACK,IAAT,GAAgBL,QAAQ,CAACN,MAAT,GAAkBhC,SAAS,CAAC,CAAD;AAFxC,OAAR;AAID;;AAED,QAAI4C,EAAE,GAAGzB,KAAK,CAAC0B,gBAAN,CAAuBZ,KAAK,CAACO,CAA7B,EAAgCP,KAAK,CAACS,CAAtC,CAAT;AAAA,QACIF,CAAC,GAAGI,EAAE,CAACJ,CADX;AAAA,QAEIE,CAAC,GAAGE,EAAE,CAACF,CAFX;;AAIA,QAAII,cAAc,GAAG3B,KAAK,CAAC4B,YAAN,EAArB;AACA,QAAIC,GAAG,GAAG;AACRR,MAAAA,CAAC,EAAEA,CAAC,GAAGM,cAAc,CAACG,UAAnB,GAAgC3D,OAD3B;AAERoD,MAAAA,CAAC,EAAEA,CAAC,GAAGI,cAAc,CAACI,SAAnB,GAA+B3D;AAF1B,KAAV,CAnC8C,CAsC3C;;AAEHZ,IAAAA,SAAS,CAAC6B,OAAD,EAAU;AACjBK,MAAAA,UAAU,EAAE,SADK;AAEjBC,MAAAA,OAAO,EAAE;AAFQ,KAAV,CAAT;AAIA,QAAIqC,IAAI,GAAG3C,OAAO,CAAC4C,qBAAR,EAAX;;AAEA,QAAIZ,CAAC,GAAGW,IAAI,CAACpB,KAAT,GAAiBzC,OAAjB,GAA2ByC,KAA/B,EAAsC;AACpCiB,MAAAA,GAAG,CAACR,CAAJ,IAASW,IAAI,CAACpB,KAAL,GAAazC,OAAtB;AACD;;AAED,QAAIoD,CAAC,GAAGS,IAAI,CAACnB,MAAT,GAAkBzC,OAAlB,GAA4ByC,MAAhC,EAAwC;AACtCgB,MAAAA,GAAG,CAACN,CAAJ,IAASS,IAAI,CAACnB,MAAL,GAAczC,OAAvB;AACD;;AAEDZ,IAAAA,SAAS,CAAC6B,OAAD,EAAU;AACjB6C,MAAAA,IAAI,EAAEL,GAAG,CAACR,CAAJ,GAAQ,IADG;AAEjBc,MAAAA,GAAG,EAAEN,GAAG,CAACN,CAAJ,GAAQ;AAFI,KAAV,CAAT;AAID,GA1DD;;AA4DAzD,EAAAA,OAAO,CAACd,SAAR,CAAkBoF,IAAlB,GAAyB,YAAY;AACnC,SAAK5B,YAAL;AACD,GAFD;;AAIA1C,EAAAA,OAAO,CAACd,SAAR,CAAkBqF,OAAlB,GAA4B,YAAY;AACtC,QAAIhD,OAAO,GAAG,KAAKL,GAAL,CAAS,SAAT,CAAd;;AAEA,QAAIK,OAAJ,EAAa;AACX,UAAIC,SAAS,GAAG,KAAKN,GAAL,CAAS,WAAT,CAAhB;;AAEA,UAAI,CAACM,SAAL,EAAgB;AACdA,QAAAA,SAAS,GAAG,KAAKN,GAAL,CAAS,OAAT,EAAkBA,GAAlB,CAAsB,WAAtB,CAAZ;AACD;;AAED,UAAIrB,QAAQ,CAAC2B,SAAD,CAAZ,EAAyB;AACvBA,QAAAA,SAAS,GAAGC,QAAQ,CAACC,cAAT,CAAwBF,SAAxB,CAAZ;AACD;;AAEDA,MAAAA,SAAS,CAACgD,WAAV,CAAsBjD,OAAtB;AACD;AACF,GAhBD;;AAkBA,SAAOvB,OAAP;AACD,CAvPD,CAuPED,IAvPF,CAFA;;AA2PA,eAAeC,OAAf","sourcesContent":["var __extends = this && this.__extends || function () {\n  var _extendStatics = function extendStatics(d, b) {\n    _extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) {\n        if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p];\n      }\n    };\n\n    return _extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    if (typeof b !== \"function\" && b !== null) throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n\n    _extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nimport { modifyCSS, createDom } from '@antv/dom-util';\nimport { isArray, isString } from '@antv/util';\nimport insertCss from 'insert-css';\nimport Base from '../base';\ninsertCss(\"\\n  .g6-component-tooltip {\\n    border: 1px solid #e2e2e2;\\n    border-radius: 4px;\\n    font-size: 12px;\\n    color: #545454;\\n    background-color: rgba(255, 255, 255, 0.9);\\n    padding: 10px 8px;\\n    box-shadow: rgb(174, 174, 174) 0px 0px 10px;\\n  }\\n  .tooltip-type {\\n    padding: 0;\\n    margin: 0;\\n  }\\n  .tooltip-id {\\n    color: #531dab;\\n  }\\n\");\n\nvar Tooltip =\n/** @class */\nfunction (_super) {\n  __extends(Tooltip, _super);\n\n  function Tooltip() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  Tooltip.prototype.getDefaultCfgs = function () {\n    return {\n      offsetX: 6,\n      offsetY: 6,\n      // 指定菜单内容，function(e) {...}\n      getContent: function getContent(e) {\n        return \"\\n          <h4 class='tooltip-type'>\\u7C7B\\u578B\\uFF1A\" + e.item.getType() + \"</h4>\\n          <span class='tooltip-id'>ID\\uFF1A\" + e.item.getID() + \"</span>\\n        \";\n      },\n      shouldBegin: function shouldBegin(e) {\n        return true;\n      },\n      itemTypes: ['node', 'edge', 'combo'],\n      trigger: 'mouseenter',\n      fixToNode: undefined\n    };\n  }; // class-methods-use-this\n\n\n  Tooltip.prototype.getEvents = function () {\n    if (this.get('trigger') === 'click') {\n      return {\n        'node:click': 'onClick',\n        'edge:click': 'onClick',\n        'combo:click': 'onClick',\n        'canvas:click': 'onMouseLeave',\n        afterremoveitem: 'onMouseLeave',\n        contextmenu: 'onMouseLeave',\n        'drag': 'onMouseLeave'\n      };\n    }\n\n    return {\n      'node:mouseenter': 'onMouseEnter',\n      'node:mouseleave': 'onMouseLeave',\n      'node:mousemove': 'onMouseMove',\n      'edge:mouseenter': 'onMouseEnter',\n      'edge:mouseleave': 'onMouseLeave',\n      'edge:mousemove': 'onMouseMove',\n      'combo:mouseenter': 'onMouseEnter',\n      'combo:mouseleave': 'onMouseLeave',\n      'combo:mousemove': 'onMouseMove',\n      afterremoveitem: 'onMouseLeave',\n      contextmenu: 'onMouseLeave',\n      'node:drag': 'onMouseLeave'\n    };\n  };\n\n  Tooltip.prototype.init = function () {\n    var className = this.get('className') || 'g6-component-tooltip';\n    var tooltip = createDom(\"<div class=\" + className + \"></div>\");\n    var container = this.get('container');\n\n    if (!container) {\n      container = this.get('graph').get('container');\n    }\n\n    if (isString(container)) {\n      container = document.getElementById(container);\n    }\n\n    modifyCSS(tooltip, {\n      position: 'absolute',\n      visibility: 'hidden',\n      display: 'none'\n    });\n    container.appendChild(tooltip);\n    this.set('tooltip', tooltip);\n  };\n\n  Tooltip.prototype.onClick = function (e) {\n    var itemTypes = this.get('itemTypes');\n    if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n    var item = e.item;\n    var graph = this.get('graph'); // 若与上一次同一 item，隐藏该 tooltip\n\n    if (this.currentTarget === item) {\n      this.currentTarget = null;\n      this.hideTooltip();\n      graph.emit('tooltipchange', {\n        item: e.item,\n        action: 'hide'\n      });\n    } else {\n      this.currentTarget = item;\n      this.showTooltip(e);\n      graph.emit('tooltipchange', {\n        item: e.item,\n        action: 'show'\n      });\n    }\n  };\n\n  Tooltip.prototype.onMouseEnter = function (e) {\n    var itemTypes = this.get('itemTypes');\n    if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n    var item = e.item;\n    var graph = this.get('graph');\n    this.currentTarget = item;\n    this.showTooltip(e);\n    graph.emit('tooltipchange', {\n      item: e.item,\n      action: 'show'\n    });\n  };\n\n  Tooltip.prototype.onMouseMove = function (e) {\n    var itemTypes = this.get('itemTypes');\n    if (e.item && e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n\n    if (!this.currentTarget || e.item !== this.currentTarget) {\n      return;\n    }\n\n    this.showTooltip(e);\n  };\n\n  Tooltip.prototype.onMouseLeave = function () {\n    this.hideTooltip();\n    var graph = this.get('graph');\n    graph.emit('tooltipchange', {\n      item: this.currentTarget,\n      action: 'hide'\n    });\n    this.currentTarget = null;\n  };\n\n  Tooltip.prototype.showTooltip = function (e) {\n    if (!e.item) {\n      return;\n    }\n\n    var itemTypes = this.get('itemTypes');\n    if (e.item.getType && itemTypes.indexOf(e.item.getType()) === -1) return;\n    var container = this.get('tooltip');\n    var getContent = this.get('getContent');\n    var tooltip = getContent(e);\n\n    if (isString(tooltip)) {\n      container.innerHTML = tooltip;\n    } else {\n      container.innerHTML = tooltip.outerHTML;\n    }\n\n    this.updatePosition(e);\n  };\n\n  Tooltip.prototype.hideTooltip = function () {\n    var tooltip = this.get('tooltip');\n\n    if (tooltip) {\n      modifyCSS(tooltip, {\n        visibility: 'hidden',\n        display: 'none'\n      });\n    }\n  };\n\n  Tooltip.prototype.updatePosition = function (e) {\n    var shouldBegin = this.get('shouldBegin');\n    var tooltip = this.get('tooltip');\n\n    if (!shouldBegin(e)) {\n      modifyCSS(tooltip, {\n        visibility: 'hidden',\n        display: 'none'\n      });\n      return;\n    }\n\n    var graph = this.get('graph');\n    var width = graph.get('width');\n    var height = graph.get('height');\n    var offsetX = this.get('offsetX') || 0;\n    var offsetY = this.get('offsetY') || 0; // const mousePos = graph.getPointByClient(e.clientX, e.clientY);\n\n    var point = graph.getPointByClient(e.clientX, e.clientY);\n    var fixToNode = this.get('fixToNode');\n    var item = e.item;\n\n    if (item.getType && item.getType() === 'node' && fixToNode && isArray(fixToNode) && fixToNode.length >= 2) {\n      var itemBBox = item.getBBox();\n      point = {\n        x: itemBBox.minX + itemBBox.width * fixToNode[0],\n        y: itemBBox.minY + itemBBox.height * fixToNode[1]\n      };\n    }\n\n    var _a = graph.getCanvasByPoint(point.x, point.y),\n        x = _a.x,\n        y = _a.y;\n\n    var graphContainer = graph.getContainer();\n    var res = {\n      x: x + graphContainer.offsetLeft + offsetX,\n      y: y + graphContainer.offsetTop + offsetY\n    }; // 先修改为 visible 方可正确计算 bbox\n\n    modifyCSS(tooltip, {\n      visibility: 'visible',\n      display: 'unset'\n    });\n    var bbox = tooltip.getBoundingClientRect();\n\n    if (x + bbox.width + offsetX > width) {\n      res.x -= bbox.width + offsetX;\n    }\n\n    if (y + bbox.height + offsetY > height) {\n      res.y -= bbox.height + offsetY;\n    }\n\n    modifyCSS(tooltip, {\n      left: res.x + \"px\",\n      top: res.y + \"px\"\n    });\n  };\n\n  Tooltip.prototype.hide = function () {\n    this.onMouseLeave();\n  };\n\n  Tooltip.prototype.destroy = function () {\n    var tooltip = this.get('tooltip');\n\n    if (tooltip) {\n      var container = this.get('container');\n\n      if (!container) {\n        container = this.get('graph').get('container');\n      }\n\n      if (isString(container)) {\n        container = document.getElementById(container);\n      }\n\n      container.removeChild(tooltip);\n    }\n  };\n\n  return Tooltip;\n}(Base);\n\nexport default Tooltip;"]},"metadata":{},"sourceType":"module"}