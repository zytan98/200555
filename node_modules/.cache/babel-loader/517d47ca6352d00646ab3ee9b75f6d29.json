{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.circularDependencyToException = exports.listMetadataForTarget = exports.listRegisteredBindingsForServiceIdentifier = exports.getServiceIdentifierAsString = exports.getFunctionName = void 0;\n\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\n\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n  if (typeof serviceIdentifier === \"function\") {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier.name;\n  } else if (typeof serviceIdentifier === \"symbol\") {\n    return serviceIdentifier.toString();\n  } else {\n    var _serviceIdentifier = serviceIdentifier;\n    return _serviceIdentifier;\n  }\n}\n\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\n\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n  var registeredBindingsList = \"\";\n  var registeredBindings = getBindings(container, serviceIdentifier);\n\n  if (registeredBindings.length !== 0) {\n    registeredBindingsList = \"\\nRegistered bindings:\";\n    registeredBindings.forEach(function (binding) {\n      var name = \"Object\";\n\n      if (binding.implementationType !== null) {\n        name = getFunctionName(binding.implementationType);\n      }\n\n      registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n\n      if (binding.constraint.metaData) {\n        registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n      }\n    });\n  }\n\n  return registeredBindingsList;\n}\n\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\n\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n  if (request.parentRequest === null) {\n    return false;\n  } else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n    return true;\n  } else {\n    return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n  }\n}\n\nfunction dependencyChainToString(request) {\n  function _createStringArr(req, result) {\n    if (result === void 0) {\n      result = [];\n    }\n\n    var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n    result.push(serviceIdentifier);\n\n    if (req.parentRequest !== null) {\n      return _createStringArr(req.parentRequest, result);\n    }\n\n    return result;\n  }\n\n  var stringArr = _createStringArr(request);\n\n  return stringArr.reverse().join(\" --> \");\n}\n\nfunction circularDependencyToException(request) {\n  request.childRequests.forEach(function (childRequest) {\n    if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n      var services = dependencyChainToString(childRequest);\n      throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n    } else {\n      circularDependencyToException(childRequest);\n    }\n  });\n}\n\nexports.circularDependencyToException = circularDependencyToException;\n\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n  if (target.isTagged() || target.isNamed()) {\n    var m_1 = \"\";\n    var namedTag = target.getNamedTag();\n    var otherTags = target.getCustomTags();\n\n    if (namedTag !== null) {\n      m_1 += namedTag.toString() + \"\\n\";\n    }\n\n    if (otherTags !== null) {\n      otherTags.forEach(function (tag) {\n        m_1 += tag.toString() + \"\\n\";\n      });\n    }\n\n    return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n  } else {\n    return \" \" + serviceIdentifierString;\n  }\n}\n\nexports.listMetadataForTarget = listMetadataForTarget;\n\nfunction getFunctionName(v) {\n  if (v.name) {\n    return v.name;\n  } else {\n    var name_1 = v.toString();\n    var match = name_1.match(/^function\\s*([^\\s(]+)/);\n    return match ? match[1] : \"Anonymous function: \" + name_1;\n  }\n}\n\nexports.getFunctionName = getFunctionName;","map":{"version":3,"sources":["../../src/utils/serialization.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.circularDependencyToException = exports.listMetadataForTarget = exports.listRegisteredBindingsForServiceIdentifier = exports.getServiceIdentifierAsString = exports.getFunctionName = void 0;\nvar ERROR_MSGS = require(\"../constants/error_msgs\");\nfunction getServiceIdentifierAsString(serviceIdentifier) {\n    if (typeof serviceIdentifier === \"function\") {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier.name;\n    }\n    else if (typeof serviceIdentifier === \"symbol\") {\n        return serviceIdentifier.toString();\n    }\n    else {\n        var _serviceIdentifier = serviceIdentifier;\n        return _serviceIdentifier;\n    }\n}\nexports.getServiceIdentifierAsString = getServiceIdentifierAsString;\nfunction listRegisteredBindingsForServiceIdentifier(container, serviceIdentifier, getBindings) {\n    var registeredBindingsList = \"\";\n    var registeredBindings = getBindings(container, serviceIdentifier);\n    if (registeredBindings.length !== 0) {\n        registeredBindingsList = \"\\nRegistered bindings:\";\n        registeredBindings.forEach(function (binding) {\n            var name = \"Object\";\n            if (binding.implementationType !== null) {\n                name = getFunctionName(binding.implementationType);\n            }\n            registeredBindingsList = registeredBindingsList + \"\\n \" + name;\n            if (binding.constraint.metaData) {\n                registeredBindingsList = registeredBindingsList + \" - \" + binding.constraint.metaData;\n            }\n        });\n    }\n    return registeredBindingsList;\n}\nexports.listRegisteredBindingsForServiceIdentifier = listRegisteredBindingsForServiceIdentifier;\nfunction alreadyDependencyChain(request, serviceIdentifier) {\n    if (request.parentRequest === null) {\n        return false;\n    }\n    else if (request.parentRequest.serviceIdentifier === serviceIdentifier) {\n        return true;\n    }\n    else {\n        return alreadyDependencyChain(request.parentRequest, serviceIdentifier);\n    }\n}\nfunction dependencyChainToString(request) {\n    function _createStringArr(req, result) {\n        if (result === void 0) { result = []; }\n        var serviceIdentifier = getServiceIdentifierAsString(req.serviceIdentifier);\n        result.push(serviceIdentifier);\n        if (req.parentRequest !== null) {\n            return _createStringArr(req.parentRequest, result);\n        }\n        return result;\n    }\n    var stringArr = _createStringArr(request);\n    return stringArr.reverse().join(\" --> \");\n}\nfunction circularDependencyToException(request) {\n    request.childRequests.forEach(function (childRequest) {\n        if (alreadyDependencyChain(childRequest, childRequest.serviceIdentifier)) {\n            var services = dependencyChainToString(childRequest);\n            throw new Error(ERROR_MSGS.CIRCULAR_DEPENDENCY + \" \" + services);\n        }\n        else {\n            circularDependencyToException(childRequest);\n        }\n    });\n}\nexports.circularDependencyToException = circularDependencyToException;\nfunction listMetadataForTarget(serviceIdentifierString, target) {\n    if (target.isTagged() || target.isNamed()) {\n        var m_1 = \"\";\n        var namedTag = target.getNamedTag();\n        var otherTags = target.getCustomTags();\n        if (namedTag !== null) {\n            m_1 += namedTag.toString() + \"\\n\";\n        }\n        if (otherTags !== null) {\n            otherTags.forEach(function (tag) {\n                m_1 += tag.toString() + \"\\n\";\n            });\n        }\n        return \" \" + serviceIdentifierString + \"\\n \" + serviceIdentifierString + \" - \" + m_1;\n    }\n    else {\n        return \" \" + serviceIdentifierString;\n    }\n}\nexports.listMetadataForTarget = listMetadataForTarget;\nfunction getFunctionName(v) {\n    if (v.name) {\n        return v.name;\n    }\n    else {\n        var name_1 = v.toString();\n        var match = name_1.match(/^function\\s*([^\\s(]+)/);\n        return match ? match[1] : \"Anonymous function: \" + name_1;\n    }\n}\nexports.getFunctionName = getFunctionName;\n//# sourceMappingURL=serialization.js.map"]},"metadata":{},"sourceType":"script"}