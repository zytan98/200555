{"ast":null,"code":"import rescale from 'ml-array-rescale';\nimport { inspectMatrix, inspectMatrixWithOptions } from './inspect';\nimport { installMathOperations } from './mathOperations';\nimport { sumByRow, sumByColumn, sumAll, productByRow, productByColumn, productAll, varianceByRow, varianceByColumn, varianceAll, centerByRow, centerByColumn, centerAll, scaleByRow, scaleByColumn, scaleAll, getScaleByRow, getScaleByColumn, getScaleAll } from './stat';\nimport { checkRowVector, checkRowIndex, checkColumnIndex, checkColumnVector, checkRange, checkIndices, checkNonEmpty } from './util';\nexport class AbstractMatrix {\n  static from1DArray(newRows, newColumns, newData) {\n    let length = newRows * newColumns;\n\n    if (length !== newData.length) {\n      throw new RangeError('data length does not match given dimensions');\n    }\n\n    let newMatrix = new Matrix(newRows, newColumns);\n\n    for (let row = 0; row < newRows; row++) {\n      for (let column = 0; column < newColumns; column++) {\n        newMatrix.set(row, column, newData[row * newColumns + column]);\n      }\n    }\n\n    return newMatrix;\n  }\n\n  static rowVector(newData) {\n    let vector = new Matrix(1, newData.length);\n\n    for (let i = 0; i < newData.length; i++) {\n      vector.set(0, i, newData[i]);\n    }\n\n    return vector;\n  }\n\n  static columnVector(newData) {\n    let vector = new Matrix(newData.length, 1);\n\n    for (let i = 0; i < newData.length; i++) {\n      vector.set(i, 0, newData[i]);\n    }\n\n    return vector;\n  }\n\n  static zeros(rows, columns) {\n    return new Matrix(rows, columns);\n  }\n\n  static ones(rows, columns) {\n    return new Matrix(rows, columns).fill(1);\n  }\n\n  static rand(rows, columns, options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      random = Math.random\n    } = options;\n    let matrix = new Matrix(rows, columns);\n\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        matrix.set(i, j, random());\n      }\n    }\n\n    return matrix;\n  }\n\n  static randInt(rows, columns, options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      min = 0,\n      max = 1000,\n      random = Math.random\n    } = options;\n    if (!Number.isInteger(min)) throw new TypeError('min must be an integer');\n    if (!Number.isInteger(max)) throw new TypeError('max must be an integer');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let interval = max - min;\n    let matrix = new Matrix(rows, columns);\n\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        let value = min + Math.round(random() * interval);\n        matrix.set(i, j, value);\n      }\n    }\n\n    return matrix;\n  }\n\n  static eye(rows, columns, value) {\n    if (columns === undefined) columns = rows;\n    if (value === undefined) value = 1;\n    let min = Math.min(rows, columns);\n    let matrix = this.zeros(rows, columns);\n\n    for (let i = 0; i < min; i++) {\n      matrix.set(i, i, value);\n    }\n\n    return matrix;\n  }\n\n  static diag(data, rows, columns) {\n    let l = data.length;\n    if (rows === undefined) rows = l;\n    if (columns === undefined) columns = rows;\n    let min = Math.min(l, rows, columns);\n    let matrix = this.zeros(rows, columns);\n\n    for (let i = 0; i < min; i++) {\n      matrix.set(i, i, data[i]);\n    }\n\n    return matrix;\n  }\n\n  static min(matrix1, matrix2) {\n    matrix1 = this.checkMatrix(matrix1);\n    matrix2 = this.checkMatrix(matrix2);\n    let rows = matrix1.rows;\n    let columns = matrix1.columns;\n    let result = new Matrix(rows, columns);\n\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        result.set(i, j, Math.min(matrix1.get(i, j), matrix2.get(i, j)));\n      }\n    }\n\n    return result;\n  }\n\n  static max(matrix1, matrix2) {\n    matrix1 = this.checkMatrix(matrix1);\n    matrix2 = this.checkMatrix(matrix2);\n    let rows = matrix1.rows;\n    let columns = matrix1.columns;\n    let result = new this(rows, columns);\n\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        result.set(i, j, Math.max(matrix1.get(i, j), matrix2.get(i, j)));\n      }\n    }\n\n    return result;\n  }\n\n  static checkMatrix(value) {\n    return AbstractMatrix.isMatrix(value) ? value : new Matrix(value);\n  }\n\n  static isMatrix(value) {\n    return value != null && value.klass === 'Matrix';\n  }\n\n  get size() {\n    return this.rows * this.columns;\n  }\n\n  apply(callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('callback must be a function');\n    }\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        callback.call(this, i, j);\n      }\n    }\n\n    return this;\n  }\n\n  to1DArray() {\n    let array = [];\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        array.push(this.get(i, j));\n      }\n    }\n\n    return array;\n  }\n\n  to2DArray() {\n    let copy = [];\n\n    for (let i = 0; i < this.rows; i++) {\n      copy.push([]);\n\n      for (let j = 0; j < this.columns; j++) {\n        copy[i].push(this.get(i, j));\n      }\n    }\n\n    return copy;\n  }\n\n  toJSON() {\n    return this.to2DArray();\n  }\n\n  isRowVector() {\n    return this.rows === 1;\n  }\n\n  isColumnVector() {\n    return this.columns === 1;\n  }\n\n  isVector() {\n    return this.rows === 1 || this.columns === 1;\n  }\n\n  isSquare() {\n    return this.rows === this.columns;\n  }\n\n  isEmpty() {\n    return this.rows === 0 || this.columns === 0;\n  }\n\n  isSymmetric() {\n    if (this.isSquare()) {\n      for (let i = 0; i < this.rows; i++) {\n        for (let j = 0; j <= i; j++) {\n          if (this.get(i, j) !== this.get(j, i)) {\n            return false;\n          }\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  }\n\n  isEchelonForm() {\n    let i = 0;\n    let j = 0;\n    let previousColumn = -1;\n    let isEchelonForm = true;\n    let checked = false;\n\n    while (i < this.rows && isEchelonForm) {\n      j = 0;\n      checked = false;\n\n      while (j < this.columns && checked === false) {\n        if (this.get(i, j) === 0) {\n          j++;\n        } else if (this.get(i, j) === 1 && j > previousColumn) {\n          checked = true;\n          previousColumn = j;\n        } else {\n          isEchelonForm = false;\n          checked = true;\n        }\n      }\n\n      i++;\n    }\n\n    return isEchelonForm;\n  }\n\n  isReducedEchelonForm() {\n    let i = 0;\n    let j = 0;\n    let previousColumn = -1;\n    let isReducedEchelonForm = true;\n    let checked = false;\n\n    while (i < this.rows && isReducedEchelonForm) {\n      j = 0;\n      checked = false;\n\n      while (j < this.columns && checked === false) {\n        if (this.get(i, j) === 0) {\n          j++;\n        } else if (this.get(i, j) === 1 && j > previousColumn) {\n          checked = true;\n          previousColumn = j;\n        } else {\n          isReducedEchelonForm = false;\n          checked = true;\n        }\n      }\n\n      for (let k = j + 1; k < this.rows; k++) {\n        if (this.get(i, k) !== 0) {\n          isReducedEchelonForm = false;\n        }\n      }\n\n      i++;\n    }\n\n    return isReducedEchelonForm;\n  }\n\n  echelonForm() {\n    let result = this.clone();\n    let h = 0;\n    let k = 0;\n\n    while (h < result.rows && k < result.columns) {\n      let iMax = h;\n\n      for (let i = h; i < result.rows; i++) {\n        if (result.get(i, k) > result.get(iMax, k)) {\n          iMax = i;\n        }\n      }\n\n      if (result.get(iMax, k) === 0) {\n        k++;\n      } else {\n        result.swapRows(h, iMax);\n        let tmp = result.get(h, k);\n\n        for (let j = k; j < result.columns; j++) {\n          result.set(h, j, result.get(h, j) / tmp);\n        }\n\n        for (let i = h + 1; i < result.rows; i++) {\n          let factor = result.get(i, k) / result.get(h, k);\n          result.set(i, k, 0);\n\n          for (let j = k + 1; j < result.columns; j++) {\n            result.set(i, j, result.get(i, j) - result.get(h, j) * factor);\n          }\n        }\n\n        h++;\n        k++;\n      }\n    }\n\n    return result;\n  }\n\n  reducedEchelonForm() {\n    let result = this.echelonForm();\n    let m = result.columns;\n    let n = result.rows;\n    let h = n - 1;\n\n    while (h >= 0) {\n      if (result.maxRow(h) === 0) {\n        h--;\n      } else {\n        let p = 0;\n        let pivot = false;\n\n        while (p < n && pivot === false) {\n          if (result.get(h, p) === 1) {\n            pivot = true;\n          } else {\n            p++;\n          }\n        }\n\n        for (let i = 0; i < h; i++) {\n          let factor = result.get(i, p);\n\n          for (let j = p; j < m; j++) {\n            let tmp = result.get(i, j) - factor * result.get(h, j);\n            result.set(i, j, tmp);\n          }\n        }\n\n        h--;\n      }\n    }\n\n    return result;\n  }\n\n  set() {\n    throw new Error('set method is unimplemented');\n  }\n\n  get() {\n    throw new Error('get method is unimplemented');\n  }\n\n  repeat(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      rows = 1,\n      columns = 1\n    } = options;\n\n    if (!Number.isInteger(rows) || rows <= 0) {\n      throw new TypeError('rows must be a positive integer');\n    }\n\n    if (!Number.isInteger(columns) || columns <= 0) {\n      throw new TypeError('columns must be a positive integer');\n    }\n\n    let matrix = new Matrix(this.rows * rows, this.columns * columns);\n\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        matrix.setSubMatrix(this, this.rows * i, this.columns * j);\n      }\n    }\n\n    return matrix;\n  }\n\n  fill(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, value);\n      }\n    }\n\n    return this;\n  }\n\n  neg() {\n    return this.mulS(-1);\n  }\n\n  getRow(index) {\n    checkRowIndex(this, index);\n    let row = [];\n\n    for (let i = 0; i < this.columns; i++) {\n      row.push(this.get(index, i));\n    }\n\n    return row;\n  }\n\n  getRowVector(index) {\n    return Matrix.rowVector(this.getRow(index));\n  }\n\n  setRow(index, array) {\n    checkRowIndex(this, index);\n    array = checkRowVector(this, array);\n\n    for (let i = 0; i < this.columns; i++) {\n      this.set(index, i, array[i]);\n    }\n\n    return this;\n  }\n\n  swapRows(row1, row2) {\n    checkRowIndex(this, row1);\n    checkRowIndex(this, row2);\n\n    for (let i = 0; i < this.columns; i++) {\n      let temp = this.get(row1, i);\n      this.set(row1, i, this.get(row2, i));\n      this.set(row2, i, temp);\n    }\n\n    return this;\n  }\n\n  getColumn(index) {\n    checkColumnIndex(this, index);\n    let column = [];\n\n    for (let i = 0; i < this.rows; i++) {\n      column.push(this.get(i, index));\n    }\n\n    return column;\n  }\n\n  getColumnVector(index) {\n    return Matrix.columnVector(this.getColumn(index));\n  }\n\n  setColumn(index, array) {\n    checkColumnIndex(this, index);\n    array = checkColumnVector(this, array);\n\n    for (let i = 0; i < this.rows; i++) {\n      this.set(i, index, array[i]);\n    }\n\n    return this;\n  }\n\n  swapColumns(column1, column2) {\n    checkColumnIndex(this, column1);\n    checkColumnIndex(this, column2);\n\n    for (let i = 0; i < this.rows; i++) {\n      let temp = this.get(i, column1);\n      this.set(i, column1, this.get(i, column2));\n      this.set(i, column2, temp);\n    }\n\n    return this;\n  }\n\n  addRowVector(vector) {\n    vector = checkRowVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + vector[j]);\n      }\n    }\n\n    return this;\n  }\n\n  subRowVector(vector) {\n    vector = checkRowVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - vector[j]);\n      }\n    }\n\n    return this;\n  }\n\n  mulRowVector(vector) {\n    vector = checkRowVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * vector[j]);\n      }\n    }\n\n    return this;\n  }\n\n  divRowVector(vector) {\n    vector = checkRowVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / vector[j]);\n      }\n    }\n\n    return this;\n  }\n\n  addColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + vector[i]);\n      }\n    }\n\n    return this;\n  }\n\n  subColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - vector[i]);\n      }\n    }\n\n    return this;\n  }\n\n  mulColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * vector[i]);\n      }\n    }\n\n    return this;\n  }\n\n  divColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / vector[i]);\n      }\n    }\n\n    return this;\n  }\n\n  mulRow(index, value) {\n    checkRowIndex(this, index);\n\n    for (let i = 0; i < this.columns; i++) {\n      this.set(index, i, this.get(index, i) * value);\n    }\n\n    return this;\n  }\n\n  mulColumn(index, value) {\n    checkColumnIndex(this, index);\n\n    for (let i = 0; i < this.rows; i++) {\n      this.set(i, index, this.get(i, index) * value);\n    }\n\n    return this;\n  }\n\n  max() {\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    let v = this.get(0, 0);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) > v) {\n          v = this.get(i, j);\n        }\n      }\n    }\n\n    return v;\n  }\n\n  maxIndex() {\n    checkNonEmpty(this);\n    let v = this.get(0, 0);\n    let idx = [0, 0];\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) > v) {\n          v = this.get(i, j);\n          idx[0] = i;\n          idx[1] = j;\n        }\n      }\n    }\n\n    return idx;\n  }\n\n  min() {\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    let v = this.get(0, 0);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) < v) {\n          v = this.get(i, j);\n        }\n      }\n    }\n\n    return v;\n  }\n\n  minIndex() {\n    checkNonEmpty(this);\n    let v = this.get(0, 0);\n    let idx = [0, 0];\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) < v) {\n          v = this.get(i, j);\n          idx[0] = i;\n          idx[1] = j;\n        }\n      }\n    }\n\n    return idx;\n  }\n\n  maxRow(row) {\n    checkRowIndex(this, row);\n\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    let v = this.get(row, 0);\n\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) > v) {\n        v = this.get(row, i);\n      }\n    }\n\n    return v;\n  }\n\n  maxRowIndex(row) {\n    checkRowIndex(this, row);\n    checkNonEmpty(this);\n    let v = this.get(row, 0);\n    let idx = [row, 0];\n\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) > v) {\n        v = this.get(row, i);\n        idx[1] = i;\n      }\n    }\n\n    return idx;\n  }\n\n  minRow(row) {\n    checkRowIndex(this, row);\n\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    let v = this.get(row, 0);\n\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) < v) {\n        v = this.get(row, i);\n      }\n    }\n\n    return v;\n  }\n\n  minRowIndex(row) {\n    checkRowIndex(this, row);\n    checkNonEmpty(this);\n    let v = this.get(row, 0);\n    let idx = [row, 0];\n\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) < v) {\n        v = this.get(row, i);\n        idx[1] = i;\n      }\n    }\n\n    return idx;\n  }\n\n  maxColumn(column) {\n    checkColumnIndex(this, column);\n\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    let v = this.get(0, column);\n\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) > v) {\n        v = this.get(i, column);\n      }\n    }\n\n    return v;\n  }\n\n  maxColumnIndex(column) {\n    checkColumnIndex(this, column);\n    checkNonEmpty(this);\n    let v = this.get(0, column);\n    let idx = [0, column];\n\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) > v) {\n        v = this.get(i, column);\n        idx[0] = i;\n      }\n    }\n\n    return idx;\n  }\n\n  minColumn(column) {\n    checkColumnIndex(this, column);\n\n    if (this.isEmpty()) {\n      return NaN;\n    }\n\n    let v = this.get(0, column);\n\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) < v) {\n        v = this.get(i, column);\n      }\n    }\n\n    return v;\n  }\n\n  minColumnIndex(column) {\n    checkColumnIndex(this, column);\n    checkNonEmpty(this);\n    let v = this.get(0, column);\n    let idx = [0, column];\n\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) < v) {\n        v = this.get(i, column);\n        idx[0] = i;\n      }\n    }\n\n    return idx;\n  }\n\n  diag() {\n    let min = Math.min(this.rows, this.columns);\n    let diag = [];\n\n    for (let i = 0; i < min; i++) {\n      diag.push(this.get(i, i));\n    }\n\n    return diag;\n  }\n\n  norm(type = 'frobenius') {\n    let result = 0;\n\n    if (type === 'max') {\n      return this.max();\n    } else if (type === 'frobenius') {\n      for (let i = 0; i < this.rows; i++) {\n        for (let j = 0; j < this.columns; j++) {\n          result = result + this.get(i, j) * this.get(i, j);\n        }\n      }\n\n      return Math.sqrt(result);\n    } else {\n      throw new RangeError(`unknown norm type: ${type}`);\n    }\n  }\n\n  cumulativeSum() {\n    let sum = 0;\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        sum += this.get(i, j);\n        this.set(i, j, sum);\n      }\n    }\n\n    return this;\n  }\n\n  dot(vector2) {\n    if (AbstractMatrix.isMatrix(vector2)) vector2 = vector2.to1DArray();\n    let vector1 = this.to1DArray();\n\n    if (vector1.length !== vector2.length) {\n      throw new RangeError('vectors do not have the same size');\n    }\n\n    let dot = 0;\n\n    for (let i = 0; i < vector1.length; i++) {\n      dot += vector1[i] * vector2[i];\n    }\n\n    return dot;\n  }\n\n  mmul(other) {\n    other = Matrix.checkMatrix(other);\n    let m = this.rows;\n    let n = this.columns;\n    let p = other.columns;\n    let result = new Matrix(m, p);\n    let Bcolj = new Float64Array(n);\n\n    for (let j = 0; j < p; j++) {\n      for (let k = 0; k < n; k++) {\n        Bcolj[k] = other.get(k, j);\n      }\n\n      for (let i = 0; i < m; i++) {\n        let s = 0;\n\n        for (let k = 0; k < n; k++) {\n          s += this.get(i, k) * Bcolj[k];\n        }\n\n        result.set(i, j, s);\n      }\n    }\n\n    return result;\n  }\n\n  strassen2x2(other) {\n    other = Matrix.checkMatrix(other);\n    let result = new Matrix(2, 2);\n    const a11 = this.get(0, 0);\n    const b11 = other.get(0, 0);\n    const a12 = this.get(0, 1);\n    const b12 = other.get(0, 1);\n    const a21 = this.get(1, 0);\n    const b21 = other.get(1, 0);\n    const a22 = this.get(1, 1);\n    const b22 = other.get(1, 1); // Compute intermediate values.\n\n    const m1 = (a11 + a22) * (b11 + b22);\n    const m2 = (a21 + a22) * b11;\n    const m3 = a11 * (b12 - b22);\n    const m4 = a22 * (b21 - b11);\n    const m5 = (a11 + a12) * b22;\n    const m6 = (a21 - a11) * (b11 + b12);\n    const m7 = (a12 - a22) * (b21 + b22); // Combine intermediate values into the output.\n\n    const c00 = m1 + m4 - m5 + m7;\n    const c01 = m3 + m5;\n    const c10 = m2 + m4;\n    const c11 = m1 - m2 + m3 + m6;\n    result.set(0, 0, c00);\n    result.set(0, 1, c01);\n    result.set(1, 0, c10);\n    result.set(1, 1, c11);\n    return result;\n  }\n\n  strassen3x3(other) {\n    other = Matrix.checkMatrix(other);\n    let result = new Matrix(3, 3);\n    const a00 = this.get(0, 0);\n    const a01 = this.get(0, 1);\n    const a02 = this.get(0, 2);\n    const a10 = this.get(1, 0);\n    const a11 = this.get(1, 1);\n    const a12 = this.get(1, 2);\n    const a20 = this.get(2, 0);\n    const a21 = this.get(2, 1);\n    const a22 = this.get(2, 2);\n    const b00 = other.get(0, 0);\n    const b01 = other.get(0, 1);\n    const b02 = other.get(0, 2);\n    const b10 = other.get(1, 0);\n    const b11 = other.get(1, 1);\n    const b12 = other.get(1, 2);\n    const b20 = other.get(2, 0);\n    const b21 = other.get(2, 1);\n    const b22 = other.get(2, 2);\n    const m1 = (a00 + a01 + a02 - a10 - a11 - a21 - a22) * b11;\n    const m2 = (a00 - a10) * (-b01 + b11);\n    const m3 = a11 * (-b00 + b01 + b10 - b11 - b12 - b20 + b22);\n    const m4 = (-a00 + a10 + a11) * (b00 - b01 + b11);\n    const m5 = (a10 + a11) * (-b00 + b01);\n    const m6 = a00 * b00;\n    const m7 = (-a00 + a20 + a21) * (b00 - b02 + b12);\n    const m8 = (-a00 + a20) * (b02 - b12);\n    const m9 = (a20 + a21) * (-b00 + b02);\n    const m10 = (a00 + a01 + a02 - a11 - a12 - a20 - a21) * b12;\n    const m11 = a21 * (-b00 + b02 + b10 - b11 - b12 - b20 + b21);\n    const m12 = (-a02 + a21 + a22) * (b11 + b20 - b21);\n    const m13 = (a02 - a22) * (b11 - b21);\n    const m14 = a02 * b20;\n    const m15 = (a21 + a22) * (-b20 + b21);\n    const m16 = (-a02 + a11 + a12) * (b12 + b20 - b22);\n    const m17 = (a02 - a12) * (b12 - b22);\n    const m18 = (a11 + a12) * (-b20 + b22);\n    const m19 = a01 * b10;\n    const m20 = a12 * b21;\n    const m21 = a10 * b02;\n    const m22 = a20 * b01;\n    const m23 = a22 * b22;\n    const c00 = m6 + m14 + m19;\n    const c01 = m1 + m4 + m5 + m6 + m12 + m14 + m15;\n    const c02 = m6 + m7 + m9 + m10 + m14 + m16 + m18;\n    const c10 = m2 + m3 + m4 + m6 + m14 + m16 + m17;\n    const c11 = m2 + m4 + m5 + m6 + m20;\n    const c12 = m14 + m16 + m17 + m18 + m21;\n    const c20 = m6 + m7 + m8 + m11 + m12 + m13 + m14;\n    const c21 = m12 + m13 + m14 + m15 + m22;\n    const c22 = m6 + m7 + m8 + m9 + m23;\n    result.set(0, 0, c00);\n    result.set(0, 1, c01);\n    result.set(0, 2, c02);\n    result.set(1, 0, c10);\n    result.set(1, 1, c11);\n    result.set(1, 2, c12);\n    result.set(2, 0, c20);\n    result.set(2, 1, c21);\n    result.set(2, 2, c22);\n    return result;\n  }\n\n  mmulStrassen(y) {\n    y = Matrix.checkMatrix(y);\n    let x = this.clone();\n    let r1 = x.rows;\n    let c1 = x.columns;\n    let r2 = y.rows;\n    let c2 = y.columns;\n\n    if (c1 !== r2) {\n      // eslint-disable-next-line no-console\n      console.warn(`Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`);\n    } // Put a matrix into the top left of a matrix of zeros.\n    // `rows` and `cols` are the dimensions of the output matrix.\n\n\n    function embed(mat, rows, cols) {\n      let r = mat.rows;\n      let c = mat.columns;\n\n      if (r === rows && c === cols) {\n        return mat;\n      } else {\n        let resultat = AbstractMatrix.zeros(rows, cols);\n        resultat = resultat.setSubMatrix(mat, 0, 0);\n        return resultat;\n      }\n    } // Make sure both matrices are the same size.\n    // This is exclusively for simplicity:\n    // this algorithm can be implemented with matrices of different sizes.\n\n\n    let r = Math.max(r1, r2);\n    let c = Math.max(c1, c2);\n    x = embed(x, r, c);\n    y = embed(y, r, c); // Our recursive multiplication function.\n\n    function blockMult(a, b, rows, cols) {\n      // For small matrices, resort to naive multiplication.\n      if (rows <= 512 || cols <= 512) {\n        return a.mmul(b); // a is equivalent to this\n      } // Apply dynamic padding.\n\n\n      if (rows % 2 === 1 && cols % 2 === 1) {\n        a = embed(a, rows + 1, cols + 1);\n        b = embed(b, rows + 1, cols + 1);\n      } else if (rows % 2 === 1) {\n        a = embed(a, rows + 1, cols);\n        b = embed(b, rows + 1, cols);\n      } else if (cols % 2 === 1) {\n        a = embed(a, rows, cols + 1);\n        b = embed(b, rows, cols + 1);\n      }\n\n      let halfRows = parseInt(a.rows / 2, 10);\n      let halfCols = parseInt(a.columns / 2, 10); // Subdivide input matrices.\n\n      let a11 = a.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n      let b11 = b.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n      let a12 = a.subMatrix(0, halfRows - 1, halfCols, a.columns - 1);\n      let b12 = b.subMatrix(0, halfRows - 1, halfCols, b.columns - 1);\n      let a21 = a.subMatrix(halfRows, a.rows - 1, 0, halfCols - 1);\n      let b21 = b.subMatrix(halfRows, b.rows - 1, 0, halfCols - 1);\n      let a22 = a.subMatrix(halfRows, a.rows - 1, halfCols, a.columns - 1);\n      let b22 = b.subMatrix(halfRows, b.rows - 1, halfCols, b.columns - 1); // Compute intermediate values.\n\n      let m1 = blockMult(AbstractMatrix.add(a11, a22), AbstractMatrix.add(b11, b22), halfRows, halfCols);\n      let m2 = blockMult(AbstractMatrix.add(a21, a22), b11, halfRows, halfCols);\n      let m3 = blockMult(a11, AbstractMatrix.sub(b12, b22), halfRows, halfCols);\n      let m4 = blockMult(a22, AbstractMatrix.sub(b21, b11), halfRows, halfCols);\n      let m5 = blockMult(AbstractMatrix.add(a11, a12), b22, halfRows, halfCols);\n      let m6 = blockMult(AbstractMatrix.sub(a21, a11), AbstractMatrix.add(b11, b12), halfRows, halfCols);\n      let m7 = blockMult(AbstractMatrix.sub(a12, a22), AbstractMatrix.add(b21, b22), halfRows, halfCols); // Combine intermediate values into the output.\n\n      let c11 = AbstractMatrix.add(m1, m4);\n      c11.sub(m5);\n      c11.add(m7);\n      let c12 = AbstractMatrix.add(m3, m5);\n      let c21 = AbstractMatrix.add(m2, m4);\n      let c22 = AbstractMatrix.sub(m1, m2);\n      c22.add(m3);\n      c22.add(m6); // Crop output to the desired size (undo dynamic padding).\n\n      let resultat = AbstractMatrix.zeros(2 * c11.rows, 2 * c11.columns);\n      resultat = resultat.setSubMatrix(c11, 0, 0);\n      resultat = resultat.setSubMatrix(c12, c11.rows, 0);\n      resultat = resultat.setSubMatrix(c21, 0, c11.columns);\n      resultat = resultat.setSubMatrix(c22, c11.rows, c11.columns);\n      return resultat.subMatrix(0, rows - 1, 0, cols - 1);\n    }\n\n    return blockMult(x, y, r, c);\n  }\n\n  scaleRows(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      min = 0,\n      max = 1\n    } = options;\n    if (!Number.isFinite(min)) throw new TypeError('min must be a number');\n    if (!Number.isFinite(max)) throw new TypeError('max must be a number');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let newMatrix = new Matrix(this.rows, this.columns);\n\n    for (let i = 0; i < this.rows; i++) {\n      const row = this.getRow(i);\n\n      if (row.length > 0) {\n        rescale(row, {\n          min,\n          max,\n          output: row\n        });\n      }\n\n      newMatrix.setRow(i, row);\n    }\n\n    return newMatrix;\n  }\n\n  scaleColumns(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      min = 0,\n      max = 1\n    } = options;\n    if (!Number.isFinite(min)) throw new TypeError('min must be a number');\n    if (!Number.isFinite(max)) throw new TypeError('max must be a number');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let newMatrix = new Matrix(this.rows, this.columns);\n\n    for (let i = 0; i < this.columns; i++) {\n      const column = this.getColumn(i);\n\n      if (column.length) {\n        rescale(column, {\n          min: min,\n          max: max,\n          output: column\n        });\n      }\n\n      newMatrix.setColumn(i, column);\n    }\n\n    return newMatrix;\n  }\n\n  flipRows() {\n    const middle = Math.ceil(this.columns / 2);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < middle; j++) {\n        let first = this.get(i, j);\n        let last = this.get(i, this.columns - 1 - j);\n        this.set(i, j, last);\n        this.set(i, this.columns - 1 - j, first);\n      }\n    }\n\n    return this;\n  }\n\n  flipColumns() {\n    const middle = Math.ceil(this.rows / 2);\n\n    for (let j = 0; j < this.columns; j++) {\n      for (let i = 0; i < middle; i++) {\n        let first = this.get(i, j);\n        let last = this.get(this.rows - 1 - i, j);\n        this.set(i, j, last);\n        this.set(this.rows - 1 - i, j, first);\n      }\n    }\n\n    return this;\n  }\n\n  kroneckerProduct(other) {\n    other = Matrix.checkMatrix(other);\n    let m = this.rows;\n    let n = this.columns;\n    let p = other.rows;\n    let q = other.columns;\n    let result = new Matrix(m * p, n * q);\n\n    for (let i = 0; i < m; i++) {\n      for (let j = 0; j < n; j++) {\n        for (let k = 0; k < p; k++) {\n          for (let l = 0; l < q; l++) {\n            result.set(p * i + k, q * j + l, this.get(i, j) * other.get(k, l));\n          }\n        }\n      }\n    }\n\n    return result;\n  }\n\n  kroneckerSum(other) {\n    other = Matrix.checkMatrix(other);\n\n    if (!this.isSquare() || !other.isSquare()) {\n      throw new Error('Kronecker Sum needs two Square Matrices');\n    }\n\n    let m = this.rows;\n    let n = other.rows;\n    let AxI = this.kroneckerProduct(Matrix.eye(n, n));\n    let IxB = Matrix.eye(m, m).kroneckerProduct(other);\n    return AxI.add(IxB);\n  }\n\n  transpose() {\n    let result = new Matrix(this.columns, this.rows);\n\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        result.set(j, i, this.get(i, j));\n      }\n    }\n\n    return result;\n  }\n\n  sortRows(compareFunction = compareNumbers) {\n    for (let i = 0; i < this.rows; i++) {\n      this.setRow(i, this.getRow(i).sort(compareFunction));\n    }\n\n    return this;\n  }\n\n  sortColumns(compareFunction = compareNumbers) {\n    for (let i = 0; i < this.columns; i++) {\n      this.setColumn(i, this.getColumn(i).sort(compareFunction));\n    }\n\n    return this;\n  }\n\n  subMatrix(startRow, endRow, startColumn, endColumn) {\n    checkRange(this, startRow, endRow, startColumn, endColumn);\n    let newMatrix = new Matrix(endRow - startRow + 1, endColumn - startColumn + 1);\n\n    for (let i = startRow; i <= endRow; i++) {\n      for (let j = startColumn; j <= endColumn; j++) {\n        newMatrix.set(i - startRow, j - startColumn, this.get(i, j));\n      }\n    }\n\n    return newMatrix;\n  }\n\n  subMatrixRow(indices, startColumn, endColumn) {\n    if (startColumn === undefined) startColumn = 0;\n    if (endColumn === undefined) endColumn = this.columns - 1;\n\n    if (startColumn > endColumn || startColumn < 0 || startColumn >= this.columns || endColumn < 0 || endColumn >= this.columns) {\n      throw new RangeError('Argument out of range');\n    }\n\n    let newMatrix = new Matrix(indices.length, endColumn - startColumn + 1);\n\n    for (let i = 0; i < indices.length; i++) {\n      for (let j = startColumn; j <= endColumn; j++) {\n        if (indices[i] < 0 || indices[i] >= this.rows) {\n          throw new RangeError(`Row index out of range: ${indices[i]}`);\n        }\n\n        newMatrix.set(i, j - startColumn, this.get(indices[i], j));\n      }\n    }\n\n    return newMatrix;\n  }\n\n  subMatrixColumn(indices, startRow, endRow) {\n    if (startRow === undefined) startRow = 0;\n    if (endRow === undefined) endRow = this.rows - 1;\n\n    if (startRow > endRow || startRow < 0 || startRow >= this.rows || endRow < 0 || endRow >= this.rows) {\n      throw new RangeError('Argument out of range');\n    }\n\n    let newMatrix = new Matrix(endRow - startRow + 1, indices.length);\n\n    for (let i = 0; i < indices.length; i++) {\n      for (let j = startRow; j <= endRow; j++) {\n        if (indices[i] < 0 || indices[i] >= this.columns) {\n          throw new RangeError(`Column index out of range: ${indices[i]}`);\n        }\n\n        newMatrix.set(j - startRow, i, this.get(j, indices[i]));\n      }\n    }\n\n    return newMatrix;\n  }\n\n  setSubMatrix(matrix, startRow, startColumn) {\n    matrix = Matrix.checkMatrix(matrix);\n\n    if (matrix.isEmpty()) {\n      return this;\n    }\n\n    let endRow = startRow + matrix.rows - 1;\n    let endColumn = startColumn + matrix.columns - 1;\n    checkRange(this, startRow, endRow, startColumn, endColumn);\n\n    for (let i = 0; i < matrix.rows; i++) {\n      for (let j = 0; j < matrix.columns; j++) {\n        this.set(startRow + i, startColumn + j, matrix.get(i, j));\n      }\n    }\n\n    return this;\n  }\n\n  selection(rowIndices, columnIndices) {\n    let indices = checkIndices(this, rowIndices, columnIndices);\n    let newMatrix = new Matrix(rowIndices.length, columnIndices.length);\n\n    for (let i = 0; i < indices.row.length; i++) {\n      let rowIndex = indices.row[i];\n\n      for (let j = 0; j < indices.column.length; j++) {\n        let columnIndex = indices.column[j];\n        newMatrix.set(i, j, this.get(rowIndex, columnIndex));\n      }\n    }\n\n    return newMatrix;\n  }\n\n  trace() {\n    let min = Math.min(this.rows, this.columns);\n    let trace = 0;\n\n    for (let i = 0; i < min; i++) {\n      trace += this.get(i, i);\n    }\n\n    return trace;\n  }\n\n  clone() {\n    let newMatrix = new Matrix(this.rows, this.columns);\n\n    for (let row = 0; row < this.rows; row++) {\n      for (let column = 0; column < this.columns; column++) {\n        newMatrix.set(row, column, this.get(row, column));\n      }\n    }\n\n    return newMatrix;\n  }\n\n  sum(by) {\n    switch (by) {\n      case 'row':\n        return sumByRow(this);\n\n      case 'column':\n        return sumByColumn(this);\n\n      case undefined:\n        return sumAll(this);\n\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  product(by) {\n    switch (by) {\n      case 'row':\n        return productByRow(this);\n\n      case 'column':\n        return productByColumn(this);\n\n      case undefined:\n        return productAll(this);\n\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  mean(by) {\n    const sum = this.sum(by);\n\n    switch (by) {\n      case 'row':\n        {\n          for (let i = 0; i < this.rows; i++) {\n            sum[i] /= this.columns;\n          }\n\n          return sum;\n        }\n\n      case 'column':\n        {\n          for (let i = 0; i < this.columns; i++) {\n            sum[i] /= this.rows;\n          }\n\n          return sum;\n        }\n\n      case undefined:\n        return sum / this.size;\n\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  variance(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      unbiased = true,\n      mean = this.mean(by)\n    } = options;\n\n    if (typeof unbiased !== 'boolean') {\n      throw new TypeError('unbiased must be a boolean');\n    }\n\n    switch (by) {\n      case 'row':\n        {\n          if (!Array.isArray(mean)) {\n            throw new TypeError('mean must be an array');\n          }\n\n          return varianceByRow(this, unbiased, mean);\n        }\n\n      case 'column':\n        {\n          if (!Array.isArray(mean)) {\n            throw new TypeError('mean must be an array');\n          }\n\n          return varianceByColumn(this, unbiased, mean);\n        }\n\n      case undefined:\n        {\n          if (typeof mean !== 'number') {\n            throw new TypeError('mean must be a number');\n          }\n\n          return varianceAll(this, unbiased, mean);\n        }\n\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  standardDeviation(by, options) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n\n    const variance = this.variance(by, options);\n\n    if (by === undefined) {\n      return Math.sqrt(variance);\n    } else {\n      for (let i = 0; i < variance.length; i++) {\n        variance[i] = Math.sqrt(variance[i]);\n      }\n\n      return variance;\n    }\n  }\n\n  center(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    const {\n      center = this.mean(by)\n    } = options;\n\n    switch (by) {\n      case 'row':\n        {\n          if (!Array.isArray(center)) {\n            throw new TypeError('center must be an array');\n          }\n\n          centerByRow(this, center);\n          return this;\n        }\n\n      case 'column':\n        {\n          if (!Array.isArray(center)) {\n            throw new TypeError('center must be an array');\n          }\n\n          centerByColumn(this, center);\n          return this;\n        }\n\n      case undefined:\n        {\n          if (typeof center !== 'number') {\n            throw new TypeError('center must be a number');\n          }\n\n          centerAll(this, center);\n          return this;\n        }\n\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  scale(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n\n    let scale = options.scale;\n\n    switch (by) {\n      case 'row':\n        {\n          if (scale === undefined) {\n            scale = getScaleByRow(this);\n          } else if (!Array.isArray(scale)) {\n            throw new TypeError('scale must be an array');\n          }\n\n          scaleByRow(this, scale);\n          return this;\n        }\n\n      case 'column':\n        {\n          if (scale === undefined) {\n            scale = getScaleByColumn(this);\n          } else if (!Array.isArray(scale)) {\n            throw new TypeError('scale must be an array');\n          }\n\n          scaleByColumn(this, scale);\n          return this;\n        }\n\n      case undefined:\n        {\n          if (scale === undefined) {\n            scale = getScaleAll(this);\n          } else if (typeof scale !== 'number') {\n            throw new TypeError('scale must be a number');\n          }\n\n          scaleAll(this, scale);\n          return this;\n        }\n\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  toString(options) {\n    return inspectMatrixWithOptions(this, options);\n  }\n\n}\nAbstractMatrix.prototype.klass = 'Matrix';\n\nif (typeof Symbol !== 'undefined') {\n  AbstractMatrix.prototype[Symbol.for('nodejs.util.inspect.custom')] = inspectMatrix;\n}\n\nfunction compareNumbers(a, b) {\n  return a - b;\n} // Synonyms\n\n\nAbstractMatrix.random = AbstractMatrix.rand;\nAbstractMatrix.randomInt = AbstractMatrix.randInt;\nAbstractMatrix.diagonal = AbstractMatrix.diag;\nAbstractMatrix.prototype.diagonal = AbstractMatrix.prototype.diag;\nAbstractMatrix.identity = AbstractMatrix.eye;\nAbstractMatrix.prototype.negate = AbstractMatrix.prototype.neg;\nAbstractMatrix.prototype.tensorProduct = AbstractMatrix.prototype.kroneckerProduct;\nexport default class Matrix extends AbstractMatrix {\n  constructor(nRows, nColumns) {\n    super();\n\n    if (Matrix.isMatrix(nRows)) {\n      // eslint-disable-next-line no-constructor-return\n      return nRows.clone();\n    } else if (Number.isInteger(nRows) && nRows >= 0) {\n      // Create an empty matrix\n      this.data = [];\n\n      if (Number.isInteger(nColumns) && nColumns >= 0) {\n        for (let i = 0; i < nRows; i++) {\n          this.data.push(new Float64Array(nColumns));\n        }\n      } else {\n        throw new TypeError('nColumns must be a positive integer');\n      }\n    } else if (Array.isArray(nRows)) {\n      // Copy the values from the 2D array\n      const arrayData = nRows;\n      nRows = arrayData.length;\n      nColumns = nRows ? arrayData[0].length : 0;\n\n      if (typeof nColumns !== 'number') {\n        throw new TypeError('Data must be a 2D array with at least one element');\n      }\n\n      this.data = [];\n\n      for (let i = 0; i < nRows; i++) {\n        if (arrayData[i].length !== nColumns) {\n          throw new RangeError('Inconsistent array dimensions');\n        }\n\n        this.data.push(Float64Array.from(arrayData[i]));\n      }\n    } else {\n      throw new TypeError('First argument must be a positive number or an array');\n    }\n\n    this.rows = nRows;\n    this.columns = nColumns;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.data[rowIndex][columnIndex] = value;\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.data[rowIndex][columnIndex];\n  }\n\n  removeRow(index) {\n    checkRowIndex(this, index);\n    this.data.splice(index, 1);\n    this.rows -= 1;\n    return this;\n  }\n\n  addRow(index, array) {\n    if (array === undefined) {\n      array = index;\n      index = this.rows;\n    }\n\n    checkRowIndex(this, index, true);\n    array = Float64Array.from(checkRowVector(this, array));\n    this.data.splice(index, 0, array);\n    this.rows += 1;\n    return this;\n  }\n\n  removeColumn(index) {\n    checkColumnIndex(this, index);\n\n    for (let i = 0; i < this.rows; i++) {\n      const newRow = new Float64Array(this.columns - 1);\n\n      for (let j = 0; j < index; j++) {\n        newRow[j] = this.data[i][j];\n      }\n\n      for (let j = index + 1; j < this.columns; j++) {\n        newRow[j - 1] = this.data[i][j];\n      }\n\n      this.data[i] = newRow;\n    }\n\n    this.columns -= 1;\n    return this;\n  }\n\n  addColumn(index, array) {\n    if (typeof array === 'undefined') {\n      array = index;\n      index = this.columns;\n    }\n\n    checkColumnIndex(this, index, true);\n    array = checkColumnVector(this, array);\n\n    for (let i = 0; i < this.rows; i++) {\n      const newRow = new Float64Array(this.columns + 1);\n      let j = 0;\n\n      for (; j < index; j++) {\n        newRow[j] = this.data[i][j];\n      }\n\n      newRow[j++] = array[i];\n\n      for (; j < this.columns + 1; j++) {\n        newRow[j] = this.data[i][j - 1];\n      }\n\n      this.data[i] = newRow;\n    }\n\n    this.columns += 1;\n    return this;\n  }\n\n}\ninstallMathOperations(AbstractMatrix, Matrix);","map":{"version":3,"sources":["C:/Users/Home/Desktop/cs-2005/node_modules/ml-matrix/src/matrix.js"],"names":["rescale","inspectMatrix","inspectMatrixWithOptions","installMathOperations","sumByRow","sumByColumn","sumAll","productByRow","productByColumn","productAll","varianceByRow","varianceByColumn","varianceAll","centerByRow","centerByColumn","centerAll","scaleByRow","scaleByColumn","scaleAll","getScaleByRow","getScaleByColumn","getScaleAll","checkRowVector","checkRowIndex","checkColumnIndex","checkColumnVector","checkRange","checkIndices","checkNonEmpty","AbstractMatrix","from1DArray","newRows","newColumns","newData","length","RangeError","newMatrix","Matrix","row","column","set","rowVector","vector","i","columnVector","zeros","rows","columns","ones","fill","rand","options","TypeError","random","Math","matrix","j","randInt","min","max","Number","isInteger","interval","value","round","eye","undefined","diag","data","l","matrix1","matrix2","checkMatrix","result","get","isMatrix","klass","size","apply","callback","call","to1DArray","array","push","to2DArray","copy","toJSON","isRowVector","isColumnVector","isVector","isSquare","isEmpty","isSymmetric","isEchelonForm","previousColumn","checked","isReducedEchelonForm","k","echelonForm","clone","h","iMax","swapRows","tmp","factor","reducedEchelonForm","m","n","maxRow","p","pivot","Error","repeat","setSubMatrix","neg","mulS","getRow","index","getRowVector","setRow","row1","row2","temp","getColumn","getColumnVector","setColumn","swapColumns","column1","column2","addRowVector","subRowVector","mulRowVector","divRowVector","addColumnVector","subColumnVector","mulColumnVector","divColumnVector","mulRow","mulColumn","NaN","v","maxIndex","idx","minIndex","maxRowIndex","minRow","minRowIndex","maxColumn","maxColumnIndex","minColumn","minColumnIndex","norm","type","sqrt","cumulativeSum","sum","dot","vector2","vector1","mmul","other","Bcolj","Float64Array","s","strassen2x2","a11","b11","a12","b12","a21","b21","a22","b22","m1","m2","m3","m4","m5","m6","m7","c00","c01","c10","c11","strassen3x3","a00","a01","a02","a10","a20","b00","b01","b02","b10","b20","m8","m9","m10","m11","m12","m13","m14","m15","m16","m17","m18","m19","m20","m21","m22","m23","c02","c12","c20","c21","c22","mmulStrassen","y","x","r1","c1","r2","c2","console","warn","embed","mat","cols","r","c","resultat","blockMult","a","b","halfRows","parseInt","halfCols","subMatrix","add","sub","scaleRows","isFinite","output","scaleColumns","flipRows","middle","ceil","first","last","flipColumns","kroneckerProduct","q","kroneckerSum","AxI","IxB","transpose","sortRows","compareFunction","compareNumbers","sort","sortColumns","startRow","endRow","startColumn","endColumn","subMatrixRow","indices","subMatrixColumn","selection","rowIndices","columnIndices","rowIndex","columnIndex","trace","by","product","mean","variance","unbiased","Array","isArray","standardDeviation","center","scale","toString","prototype","Symbol","for","randomInt","diagonal","identity","negate","tensorProduct","constructor","nRows","nColumns","arrayData","from","removeRow","splice","addRow","removeColumn","newRow","addColumn"],"mappings":"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","sourcesContent":["import rescale from 'ml-array-rescale';\n\nimport { inspectMatrix, inspectMatrixWithOptions } from './inspect';\nimport { installMathOperations } from './mathOperations';\nimport {\n  sumByRow,\n  sumByColumn,\n  sumAll,\n  productByRow,\n  productByColumn,\n  productAll,\n  varianceByRow,\n  varianceByColumn,\n  varianceAll,\n  centerByRow,\n  centerByColumn,\n  centerAll,\n  scaleByRow,\n  scaleByColumn,\n  scaleAll,\n  getScaleByRow,\n  getScaleByColumn,\n  getScaleAll,\n} from './stat';\nimport {\n  checkRowVector,\n  checkRowIndex,\n  checkColumnIndex,\n  checkColumnVector,\n  checkRange,\n  checkIndices,\n  checkNonEmpty,\n} from './util';\n\nexport class AbstractMatrix {\n  static from1DArray(newRows, newColumns, newData) {\n    let length = newRows * newColumns;\n    if (length !== newData.length) {\n      throw new RangeError('data length does not match given dimensions');\n    }\n    let newMatrix = new Matrix(newRows, newColumns);\n    for (let row = 0; row < newRows; row++) {\n      for (let column = 0; column < newColumns; column++) {\n        newMatrix.set(row, column, newData[row * newColumns + column]);\n      }\n    }\n    return newMatrix;\n  }\n\n  static rowVector(newData) {\n    let vector = new Matrix(1, newData.length);\n    for (let i = 0; i < newData.length; i++) {\n      vector.set(0, i, newData[i]);\n    }\n    return vector;\n  }\n\n  static columnVector(newData) {\n    let vector = new Matrix(newData.length, 1);\n    for (let i = 0; i < newData.length; i++) {\n      vector.set(i, 0, newData[i]);\n    }\n    return vector;\n  }\n\n  static zeros(rows, columns) {\n    return new Matrix(rows, columns);\n  }\n\n  static ones(rows, columns) {\n    return new Matrix(rows, columns).fill(1);\n  }\n\n  static rand(rows, columns, options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { random = Math.random } = options;\n    let matrix = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        matrix.set(i, j, random());\n      }\n    }\n    return matrix;\n  }\n\n  static randInt(rows, columns, options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { min = 0, max = 1000, random = Math.random } = options;\n    if (!Number.isInteger(min)) throw new TypeError('min must be an integer');\n    if (!Number.isInteger(max)) throw new TypeError('max must be an integer');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let interval = max - min;\n    let matrix = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        let value = min + Math.round(random() * interval);\n        matrix.set(i, j, value);\n      }\n    }\n    return matrix;\n  }\n\n  static eye(rows, columns, value) {\n    if (columns === undefined) columns = rows;\n    if (value === undefined) value = 1;\n    let min = Math.min(rows, columns);\n    let matrix = this.zeros(rows, columns);\n    for (let i = 0; i < min; i++) {\n      matrix.set(i, i, value);\n    }\n    return matrix;\n  }\n\n  static diag(data, rows, columns) {\n    let l = data.length;\n    if (rows === undefined) rows = l;\n    if (columns === undefined) columns = rows;\n    let min = Math.min(l, rows, columns);\n    let matrix = this.zeros(rows, columns);\n    for (let i = 0; i < min; i++) {\n      matrix.set(i, i, data[i]);\n    }\n    return matrix;\n  }\n\n  static min(matrix1, matrix2) {\n    matrix1 = this.checkMatrix(matrix1);\n    matrix2 = this.checkMatrix(matrix2);\n    let rows = matrix1.rows;\n    let columns = matrix1.columns;\n    let result = new Matrix(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        result.set(i, j, Math.min(matrix1.get(i, j), matrix2.get(i, j)));\n      }\n    }\n    return result;\n  }\n\n  static max(matrix1, matrix2) {\n    matrix1 = this.checkMatrix(matrix1);\n    matrix2 = this.checkMatrix(matrix2);\n    let rows = matrix1.rows;\n    let columns = matrix1.columns;\n    let result = new this(rows, columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        result.set(i, j, Math.max(matrix1.get(i, j), matrix2.get(i, j)));\n      }\n    }\n    return result;\n  }\n\n  static checkMatrix(value) {\n    return AbstractMatrix.isMatrix(value) ? value : new Matrix(value);\n  }\n\n  static isMatrix(value) {\n    return value != null && value.klass === 'Matrix';\n  }\n\n  get size() {\n    return this.rows * this.columns;\n  }\n\n  apply(callback) {\n    if (typeof callback !== 'function') {\n      throw new TypeError('callback must be a function');\n    }\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        callback.call(this, i, j);\n      }\n    }\n    return this;\n  }\n\n  to1DArray() {\n    let array = [];\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        array.push(this.get(i, j));\n      }\n    }\n    return array;\n  }\n\n  to2DArray() {\n    let copy = [];\n    for (let i = 0; i < this.rows; i++) {\n      copy.push([]);\n      for (let j = 0; j < this.columns; j++) {\n        copy[i].push(this.get(i, j));\n      }\n    }\n    return copy;\n  }\n\n  toJSON() {\n    return this.to2DArray();\n  }\n\n  isRowVector() {\n    return this.rows === 1;\n  }\n\n  isColumnVector() {\n    return this.columns === 1;\n  }\n\n  isVector() {\n    return this.rows === 1 || this.columns === 1;\n  }\n\n  isSquare() {\n    return this.rows === this.columns;\n  }\n\n  isEmpty() {\n    return this.rows === 0 || this.columns === 0;\n  }\n\n  isSymmetric() {\n    if (this.isSquare()) {\n      for (let i = 0; i < this.rows; i++) {\n        for (let j = 0; j <= i; j++) {\n          if (this.get(i, j) !== this.get(j, i)) {\n            return false;\n          }\n        }\n      }\n      return true;\n    }\n    return false;\n  }\n\n  isEchelonForm() {\n    let i = 0;\n    let j = 0;\n    let previousColumn = -1;\n    let isEchelonForm = true;\n    let checked = false;\n    while (i < this.rows && isEchelonForm) {\n      j = 0;\n      checked = false;\n      while (j < this.columns && checked === false) {\n        if (this.get(i, j) === 0) {\n          j++;\n        } else if (this.get(i, j) === 1 && j > previousColumn) {\n          checked = true;\n          previousColumn = j;\n        } else {\n          isEchelonForm = false;\n          checked = true;\n        }\n      }\n      i++;\n    }\n    return isEchelonForm;\n  }\n\n  isReducedEchelonForm() {\n    let i = 0;\n    let j = 0;\n    let previousColumn = -1;\n    let isReducedEchelonForm = true;\n    let checked = false;\n    while (i < this.rows && isReducedEchelonForm) {\n      j = 0;\n      checked = false;\n      while (j < this.columns && checked === false) {\n        if (this.get(i, j) === 0) {\n          j++;\n        } else if (this.get(i, j) === 1 && j > previousColumn) {\n          checked = true;\n          previousColumn = j;\n        } else {\n          isReducedEchelonForm = false;\n          checked = true;\n        }\n      }\n      for (let k = j + 1; k < this.rows; k++) {\n        if (this.get(i, k) !== 0) {\n          isReducedEchelonForm = false;\n        }\n      }\n      i++;\n    }\n    return isReducedEchelonForm;\n  }\n\n  echelonForm() {\n    let result = this.clone();\n    let h = 0;\n    let k = 0;\n    while (h < result.rows && k < result.columns) {\n      let iMax = h;\n      for (let i = h; i < result.rows; i++) {\n        if (result.get(i, k) > result.get(iMax, k)) {\n          iMax = i;\n        }\n      }\n      if (result.get(iMax, k) === 0) {\n        k++;\n      } else {\n        result.swapRows(h, iMax);\n        let tmp = result.get(h, k);\n        for (let j = k; j < result.columns; j++) {\n          result.set(h, j, result.get(h, j) / tmp);\n        }\n        for (let i = h + 1; i < result.rows; i++) {\n          let factor = result.get(i, k) / result.get(h, k);\n          result.set(i, k, 0);\n          for (let j = k + 1; j < result.columns; j++) {\n            result.set(i, j, result.get(i, j) - result.get(h, j) * factor);\n          }\n        }\n        h++;\n        k++;\n      }\n    }\n    return result;\n  }\n\n  reducedEchelonForm() {\n    let result = this.echelonForm();\n    let m = result.columns;\n    let n = result.rows;\n    let h = n - 1;\n    while (h >= 0) {\n      if (result.maxRow(h) === 0) {\n        h--;\n      } else {\n        let p = 0;\n        let pivot = false;\n        while (p < n && pivot === false) {\n          if (result.get(h, p) === 1) {\n            pivot = true;\n          } else {\n            p++;\n          }\n        }\n        for (let i = 0; i < h; i++) {\n          let factor = result.get(i, p);\n          for (let j = p; j < m; j++) {\n            let tmp = result.get(i, j) - factor * result.get(h, j);\n            result.set(i, j, tmp);\n          }\n        }\n        h--;\n      }\n    }\n    return result;\n  }\n\n  set() {\n    throw new Error('set method is unimplemented');\n  }\n\n  get() {\n    throw new Error('get method is unimplemented');\n  }\n\n  repeat(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { rows = 1, columns = 1 } = options;\n    if (!Number.isInteger(rows) || rows <= 0) {\n      throw new TypeError('rows must be a positive integer');\n    }\n    if (!Number.isInteger(columns) || columns <= 0) {\n      throw new TypeError('columns must be a positive integer');\n    }\n    let matrix = new Matrix(this.rows * rows, this.columns * columns);\n    for (let i = 0; i < rows; i++) {\n      for (let j = 0; j < columns; j++) {\n        matrix.setSubMatrix(this, this.rows * i, this.columns * j);\n      }\n    }\n    return matrix;\n  }\n\n  fill(value) {\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, value);\n      }\n    }\n    return this;\n  }\n\n  neg() {\n    return this.mulS(-1);\n  }\n\n  getRow(index) {\n    checkRowIndex(this, index);\n    let row = [];\n    for (let i = 0; i < this.columns; i++) {\n      row.push(this.get(index, i));\n    }\n    return row;\n  }\n\n  getRowVector(index) {\n    return Matrix.rowVector(this.getRow(index));\n  }\n\n  setRow(index, array) {\n    checkRowIndex(this, index);\n    array = checkRowVector(this, array);\n    for (let i = 0; i < this.columns; i++) {\n      this.set(index, i, array[i]);\n    }\n    return this;\n  }\n\n  swapRows(row1, row2) {\n    checkRowIndex(this, row1);\n    checkRowIndex(this, row2);\n    for (let i = 0; i < this.columns; i++) {\n      let temp = this.get(row1, i);\n      this.set(row1, i, this.get(row2, i));\n      this.set(row2, i, temp);\n    }\n    return this;\n  }\n\n  getColumn(index) {\n    checkColumnIndex(this, index);\n    let column = [];\n    for (let i = 0; i < this.rows; i++) {\n      column.push(this.get(i, index));\n    }\n    return column;\n  }\n\n  getColumnVector(index) {\n    return Matrix.columnVector(this.getColumn(index));\n  }\n\n  setColumn(index, array) {\n    checkColumnIndex(this, index);\n    array = checkColumnVector(this, array);\n    for (let i = 0; i < this.rows; i++) {\n      this.set(i, index, array[i]);\n    }\n    return this;\n  }\n\n  swapColumns(column1, column2) {\n    checkColumnIndex(this, column1);\n    checkColumnIndex(this, column2);\n    for (let i = 0; i < this.rows; i++) {\n      let temp = this.get(i, column1);\n      this.set(i, column1, this.get(i, column2));\n      this.set(i, column2, temp);\n    }\n    return this;\n  }\n\n  addRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + vector[j]);\n      }\n    }\n    return this;\n  }\n\n  subRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - vector[j]);\n      }\n    }\n    return this;\n  }\n\n  mulRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * vector[j]);\n      }\n    }\n    return this;\n  }\n\n  divRowVector(vector) {\n    vector = checkRowVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / vector[j]);\n      }\n    }\n    return this;\n  }\n\n  addColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) + vector[i]);\n      }\n    }\n    return this;\n  }\n\n  subColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) - vector[i]);\n      }\n    }\n    return this;\n  }\n\n  mulColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) * vector[i]);\n      }\n    }\n    return this;\n  }\n\n  divColumnVector(vector) {\n    vector = checkColumnVector(this, vector);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        this.set(i, j, this.get(i, j) / vector[i]);\n      }\n    }\n    return this;\n  }\n\n  mulRow(index, value) {\n    checkRowIndex(this, index);\n    for (let i = 0; i < this.columns; i++) {\n      this.set(index, i, this.get(index, i) * value);\n    }\n    return this;\n  }\n\n  mulColumn(index, value) {\n    checkColumnIndex(this, index);\n    for (let i = 0; i < this.rows; i++) {\n      this.set(i, index, this.get(i, index) * value);\n    }\n    return this;\n  }\n\n  max() {\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(0, 0);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) > v) {\n          v = this.get(i, j);\n        }\n      }\n    }\n    return v;\n  }\n\n  maxIndex() {\n    checkNonEmpty(this);\n    let v = this.get(0, 0);\n    let idx = [0, 0];\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) > v) {\n          v = this.get(i, j);\n          idx[0] = i;\n          idx[1] = j;\n        }\n      }\n    }\n    return idx;\n  }\n\n  min() {\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(0, 0);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) < v) {\n          v = this.get(i, j);\n        }\n      }\n    }\n    return v;\n  }\n\n  minIndex() {\n    checkNonEmpty(this);\n    let v = this.get(0, 0);\n    let idx = [0, 0];\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        if (this.get(i, j) < v) {\n          v = this.get(i, j);\n          idx[0] = i;\n          idx[1] = j;\n        }\n      }\n    }\n    return idx;\n  }\n\n  maxRow(row) {\n    checkRowIndex(this, row);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(row, 0);\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) > v) {\n        v = this.get(row, i);\n      }\n    }\n    return v;\n  }\n\n  maxRowIndex(row) {\n    checkRowIndex(this, row);\n    checkNonEmpty(this);\n    let v = this.get(row, 0);\n    let idx = [row, 0];\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) > v) {\n        v = this.get(row, i);\n        idx[1] = i;\n      }\n    }\n    return idx;\n  }\n\n  minRow(row) {\n    checkRowIndex(this, row);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(row, 0);\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) < v) {\n        v = this.get(row, i);\n      }\n    }\n    return v;\n  }\n\n  minRowIndex(row) {\n    checkRowIndex(this, row);\n    checkNonEmpty(this);\n    let v = this.get(row, 0);\n    let idx = [row, 0];\n    for (let i = 1; i < this.columns; i++) {\n      if (this.get(row, i) < v) {\n        v = this.get(row, i);\n        idx[1] = i;\n      }\n    }\n    return idx;\n  }\n\n  maxColumn(column) {\n    checkColumnIndex(this, column);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(0, column);\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) > v) {\n        v = this.get(i, column);\n      }\n    }\n    return v;\n  }\n\n  maxColumnIndex(column) {\n    checkColumnIndex(this, column);\n    checkNonEmpty(this);\n    let v = this.get(0, column);\n    let idx = [0, column];\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) > v) {\n        v = this.get(i, column);\n        idx[0] = i;\n      }\n    }\n    return idx;\n  }\n\n  minColumn(column) {\n    checkColumnIndex(this, column);\n    if (this.isEmpty()) {\n      return NaN;\n    }\n    let v = this.get(0, column);\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) < v) {\n        v = this.get(i, column);\n      }\n    }\n    return v;\n  }\n\n  minColumnIndex(column) {\n    checkColumnIndex(this, column);\n    checkNonEmpty(this);\n    let v = this.get(0, column);\n    let idx = [0, column];\n    for (let i = 1; i < this.rows; i++) {\n      if (this.get(i, column) < v) {\n        v = this.get(i, column);\n        idx[0] = i;\n      }\n    }\n    return idx;\n  }\n\n  diag() {\n    let min = Math.min(this.rows, this.columns);\n    let diag = [];\n    for (let i = 0; i < min; i++) {\n      diag.push(this.get(i, i));\n    }\n    return diag;\n  }\n\n  norm(type = 'frobenius') {\n    let result = 0;\n    if (type === 'max') {\n      return this.max();\n    } else if (type === 'frobenius') {\n      for (let i = 0; i < this.rows; i++) {\n        for (let j = 0; j < this.columns; j++) {\n          result = result + this.get(i, j) * this.get(i, j);\n        }\n      }\n      return Math.sqrt(result);\n    } else {\n      throw new RangeError(`unknown norm type: ${type}`);\n    }\n  }\n\n  cumulativeSum() {\n    let sum = 0;\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        sum += this.get(i, j);\n        this.set(i, j, sum);\n      }\n    }\n    return this;\n  }\n\n  dot(vector2) {\n    if (AbstractMatrix.isMatrix(vector2)) vector2 = vector2.to1DArray();\n    let vector1 = this.to1DArray();\n    if (vector1.length !== vector2.length) {\n      throw new RangeError('vectors do not have the same size');\n    }\n    let dot = 0;\n    for (let i = 0; i < vector1.length; i++) {\n      dot += vector1[i] * vector2[i];\n    }\n    return dot;\n  }\n\n  mmul(other) {\n    other = Matrix.checkMatrix(other);\n\n    let m = this.rows;\n    let n = this.columns;\n    let p = other.columns;\n\n    let result = new Matrix(m, p);\n\n    let Bcolj = new Float64Array(n);\n    for (let j = 0; j < p; j++) {\n      for (let k = 0; k < n; k++) {\n        Bcolj[k] = other.get(k, j);\n      }\n\n      for (let i = 0; i < m; i++) {\n        let s = 0;\n        for (let k = 0; k < n; k++) {\n          s += this.get(i, k) * Bcolj[k];\n        }\n\n        result.set(i, j, s);\n      }\n    }\n    return result;\n  }\n\n  strassen2x2(other) {\n    other = Matrix.checkMatrix(other);\n    let result = new Matrix(2, 2);\n    const a11 = this.get(0, 0);\n    const b11 = other.get(0, 0);\n    const a12 = this.get(0, 1);\n    const b12 = other.get(0, 1);\n    const a21 = this.get(1, 0);\n    const b21 = other.get(1, 0);\n    const a22 = this.get(1, 1);\n    const b22 = other.get(1, 1);\n\n    // Compute intermediate values.\n    const m1 = (a11 + a22) * (b11 + b22);\n    const m2 = (a21 + a22) * b11;\n    const m3 = a11 * (b12 - b22);\n    const m4 = a22 * (b21 - b11);\n    const m5 = (a11 + a12) * b22;\n    const m6 = (a21 - a11) * (b11 + b12);\n    const m7 = (a12 - a22) * (b21 + b22);\n\n    // Combine intermediate values into the output.\n    const c00 = m1 + m4 - m5 + m7;\n    const c01 = m3 + m5;\n    const c10 = m2 + m4;\n    const c11 = m1 - m2 + m3 + m6;\n\n    result.set(0, 0, c00);\n    result.set(0, 1, c01);\n    result.set(1, 0, c10);\n    result.set(1, 1, c11);\n    return result;\n  }\n\n  strassen3x3(other) {\n    other = Matrix.checkMatrix(other);\n    let result = new Matrix(3, 3);\n\n    const a00 = this.get(0, 0);\n    const a01 = this.get(0, 1);\n    const a02 = this.get(0, 2);\n    const a10 = this.get(1, 0);\n    const a11 = this.get(1, 1);\n    const a12 = this.get(1, 2);\n    const a20 = this.get(2, 0);\n    const a21 = this.get(2, 1);\n    const a22 = this.get(2, 2);\n\n    const b00 = other.get(0, 0);\n    const b01 = other.get(0, 1);\n    const b02 = other.get(0, 2);\n    const b10 = other.get(1, 0);\n    const b11 = other.get(1, 1);\n    const b12 = other.get(1, 2);\n    const b20 = other.get(2, 0);\n    const b21 = other.get(2, 1);\n    const b22 = other.get(2, 2);\n\n    const m1 = (a00 + a01 + a02 - a10 - a11 - a21 - a22) * b11;\n    const m2 = (a00 - a10) * (-b01 + b11);\n    const m3 = a11 * (-b00 + b01 + b10 - b11 - b12 - b20 + b22);\n    const m4 = (-a00 + a10 + a11) * (b00 - b01 + b11);\n    const m5 = (a10 + a11) * (-b00 + b01);\n    const m6 = a00 * b00;\n    const m7 = (-a00 + a20 + a21) * (b00 - b02 + b12);\n    const m8 = (-a00 + a20) * (b02 - b12);\n    const m9 = (a20 + a21) * (-b00 + b02);\n    const m10 = (a00 + a01 + a02 - a11 - a12 - a20 - a21) * b12;\n    const m11 = a21 * (-b00 + b02 + b10 - b11 - b12 - b20 + b21);\n    const m12 = (-a02 + a21 + a22) * (b11 + b20 - b21);\n    const m13 = (a02 - a22) * (b11 - b21);\n    const m14 = a02 * b20;\n    const m15 = (a21 + a22) * (-b20 + b21);\n    const m16 = (-a02 + a11 + a12) * (b12 + b20 - b22);\n    const m17 = (a02 - a12) * (b12 - b22);\n    const m18 = (a11 + a12) * (-b20 + b22);\n    const m19 = a01 * b10;\n    const m20 = a12 * b21;\n    const m21 = a10 * b02;\n    const m22 = a20 * b01;\n    const m23 = a22 * b22;\n\n    const c00 = m6 + m14 + m19;\n    const c01 = m1 + m4 + m5 + m6 + m12 + m14 + m15;\n    const c02 = m6 + m7 + m9 + m10 + m14 + m16 + m18;\n    const c10 = m2 + m3 + m4 + m6 + m14 + m16 + m17;\n    const c11 = m2 + m4 + m5 + m6 + m20;\n    const c12 = m14 + m16 + m17 + m18 + m21;\n    const c20 = m6 + m7 + m8 + m11 + m12 + m13 + m14;\n    const c21 = m12 + m13 + m14 + m15 + m22;\n    const c22 = m6 + m7 + m8 + m9 + m23;\n\n    result.set(0, 0, c00);\n    result.set(0, 1, c01);\n    result.set(0, 2, c02);\n    result.set(1, 0, c10);\n    result.set(1, 1, c11);\n    result.set(1, 2, c12);\n    result.set(2, 0, c20);\n    result.set(2, 1, c21);\n    result.set(2, 2, c22);\n    return result;\n  }\n\n  mmulStrassen(y) {\n    y = Matrix.checkMatrix(y);\n    let x = this.clone();\n    let r1 = x.rows;\n    let c1 = x.columns;\n    let r2 = y.rows;\n    let c2 = y.columns;\n    if (c1 !== r2) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `Multiplying ${r1} x ${c1} and ${r2} x ${c2} matrix: dimensions do not match.`,\n      );\n    }\n\n    // Put a matrix into the top left of a matrix of zeros.\n    // `rows` and `cols` are the dimensions of the output matrix.\n    function embed(mat, rows, cols) {\n      let r = mat.rows;\n      let c = mat.columns;\n      if (r === rows && c === cols) {\n        return mat;\n      } else {\n        let resultat = AbstractMatrix.zeros(rows, cols);\n        resultat = resultat.setSubMatrix(mat, 0, 0);\n        return resultat;\n      }\n    }\n\n    // Make sure both matrices are the same size.\n    // This is exclusively for simplicity:\n    // this algorithm can be implemented with matrices of different sizes.\n\n    let r = Math.max(r1, r2);\n    let c = Math.max(c1, c2);\n    x = embed(x, r, c);\n    y = embed(y, r, c);\n\n    // Our recursive multiplication function.\n    function blockMult(a, b, rows, cols) {\n      // For small matrices, resort to naive multiplication.\n      if (rows <= 512 || cols <= 512) {\n        return a.mmul(b); // a is equivalent to this\n      }\n\n      // Apply dynamic padding.\n      if (rows % 2 === 1 && cols % 2 === 1) {\n        a = embed(a, rows + 1, cols + 1);\n        b = embed(b, rows + 1, cols + 1);\n      } else if (rows % 2 === 1) {\n        a = embed(a, rows + 1, cols);\n        b = embed(b, rows + 1, cols);\n      } else if (cols % 2 === 1) {\n        a = embed(a, rows, cols + 1);\n        b = embed(b, rows, cols + 1);\n      }\n\n      let halfRows = parseInt(a.rows / 2, 10);\n      let halfCols = parseInt(a.columns / 2, 10);\n      // Subdivide input matrices.\n      let a11 = a.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n      let b11 = b.subMatrix(0, halfRows - 1, 0, halfCols - 1);\n\n      let a12 = a.subMatrix(0, halfRows - 1, halfCols, a.columns - 1);\n      let b12 = b.subMatrix(0, halfRows - 1, halfCols, b.columns - 1);\n\n      let a21 = a.subMatrix(halfRows, a.rows - 1, 0, halfCols - 1);\n      let b21 = b.subMatrix(halfRows, b.rows - 1, 0, halfCols - 1);\n\n      let a22 = a.subMatrix(halfRows, a.rows - 1, halfCols, a.columns - 1);\n      let b22 = b.subMatrix(halfRows, b.rows - 1, halfCols, b.columns - 1);\n\n      // Compute intermediate values.\n      let m1 = blockMult(\n        AbstractMatrix.add(a11, a22),\n        AbstractMatrix.add(b11, b22),\n        halfRows,\n        halfCols,\n      );\n      let m2 = blockMult(AbstractMatrix.add(a21, a22), b11, halfRows, halfCols);\n      let m3 = blockMult(a11, AbstractMatrix.sub(b12, b22), halfRows, halfCols);\n      let m4 = blockMult(a22, AbstractMatrix.sub(b21, b11), halfRows, halfCols);\n      let m5 = blockMult(AbstractMatrix.add(a11, a12), b22, halfRows, halfCols);\n      let m6 = blockMult(\n        AbstractMatrix.sub(a21, a11),\n        AbstractMatrix.add(b11, b12),\n        halfRows,\n        halfCols,\n      );\n      let m7 = blockMult(\n        AbstractMatrix.sub(a12, a22),\n        AbstractMatrix.add(b21, b22),\n        halfRows,\n        halfCols,\n      );\n\n      // Combine intermediate values into the output.\n      let c11 = AbstractMatrix.add(m1, m4);\n      c11.sub(m5);\n      c11.add(m7);\n      let c12 = AbstractMatrix.add(m3, m5);\n      let c21 = AbstractMatrix.add(m2, m4);\n      let c22 = AbstractMatrix.sub(m1, m2);\n      c22.add(m3);\n      c22.add(m6);\n\n      // Crop output to the desired size (undo dynamic padding).\n      let resultat = AbstractMatrix.zeros(2 * c11.rows, 2 * c11.columns);\n      resultat = resultat.setSubMatrix(c11, 0, 0);\n      resultat = resultat.setSubMatrix(c12, c11.rows, 0);\n      resultat = resultat.setSubMatrix(c21, 0, c11.columns);\n      resultat = resultat.setSubMatrix(c22, c11.rows, c11.columns);\n      return resultat.subMatrix(0, rows - 1, 0, cols - 1);\n    }\n    return blockMult(x, y, r, c);\n  }\n\n  scaleRows(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { min = 0, max = 1 } = options;\n    if (!Number.isFinite(min)) throw new TypeError('min must be a number');\n    if (!Number.isFinite(max)) throw new TypeError('max must be a number');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let newMatrix = new Matrix(this.rows, this.columns);\n    for (let i = 0; i < this.rows; i++) {\n      const row = this.getRow(i);\n      if (row.length > 0) {\n        rescale(row, { min, max, output: row });\n      }\n      newMatrix.setRow(i, row);\n    }\n    return newMatrix;\n  }\n\n  scaleColumns(options = {}) {\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { min = 0, max = 1 } = options;\n    if (!Number.isFinite(min)) throw new TypeError('min must be a number');\n    if (!Number.isFinite(max)) throw new TypeError('max must be a number');\n    if (min >= max) throw new RangeError('min must be smaller than max');\n    let newMatrix = new Matrix(this.rows, this.columns);\n    for (let i = 0; i < this.columns; i++) {\n      const column = this.getColumn(i);\n      if (column.length) {\n        rescale(column, {\n          min: min,\n          max: max,\n          output: column,\n        });\n      }\n      newMatrix.setColumn(i, column);\n    }\n    return newMatrix;\n  }\n\n  flipRows() {\n    const middle = Math.ceil(this.columns / 2);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < middle; j++) {\n        let first = this.get(i, j);\n        let last = this.get(i, this.columns - 1 - j);\n        this.set(i, j, last);\n        this.set(i, this.columns - 1 - j, first);\n      }\n    }\n    return this;\n  }\n\n  flipColumns() {\n    const middle = Math.ceil(this.rows / 2);\n    for (let j = 0; j < this.columns; j++) {\n      for (let i = 0; i < middle; i++) {\n        let first = this.get(i, j);\n        let last = this.get(this.rows - 1 - i, j);\n        this.set(i, j, last);\n        this.set(this.rows - 1 - i, j, first);\n      }\n    }\n    return this;\n  }\n\n  kroneckerProduct(other) {\n    other = Matrix.checkMatrix(other);\n\n    let m = this.rows;\n    let n = this.columns;\n    let p = other.rows;\n    let q = other.columns;\n\n    let result = new Matrix(m * p, n * q);\n    for (let i = 0; i < m; i++) {\n      for (let j = 0; j < n; j++) {\n        for (let k = 0; k < p; k++) {\n          for (let l = 0; l < q; l++) {\n            result.set(p * i + k, q * j + l, this.get(i, j) * other.get(k, l));\n          }\n        }\n      }\n    }\n    return result;\n  }\n\n  kroneckerSum(other) {\n    other = Matrix.checkMatrix(other);\n    if (!this.isSquare() || !other.isSquare()) {\n      throw new Error('Kronecker Sum needs two Square Matrices');\n    }\n    let m = this.rows;\n    let n = other.rows;\n    let AxI = this.kroneckerProduct(Matrix.eye(n, n));\n    let IxB = Matrix.eye(m, m).kroneckerProduct(other);\n    return AxI.add(IxB);\n  }\n\n  transpose() {\n    let result = new Matrix(this.columns, this.rows);\n    for (let i = 0; i < this.rows; i++) {\n      for (let j = 0; j < this.columns; j++) {\n        result.set(j, i, this.get(i, j));\n      }\n    }\n    return result;\n  }\n\n  sortRows(compareFunction = compareNumbers) {\n    for (let i = 0; i < this.rows; i++) {\n      this.setRow(i, this.getRow(i).sort(compareFunction));\n    }\n    return this;\n  }\n\n  sortColumns(compareFunction = compareNumbers) {\n    for (let i = 0; i < this.columns; i++) {\n      this.setColumn(i, this.getColumn(i).sort(compareFunction));\n    }\n    return this;\n  }\n\n  subMatrix(startRow, endRow, startColumn, endColumn) {\n    checkRange(this, startRow, endRow, startColumn, endColumn);\n    let newMatrix = new Matrix(\n      endRow - startRow + 1,\n      endColumn - startColumn + 1,\n    );\n    for (let i = startRow; i <= endRow; i++) {\n      for (let j = startColumn; j <= endColumn; j++) {\n        newMatrix.set(i - startRow, j - startColumn, this.get(i, j));\n      }\n    }\n    return newMatrix;\n  }\n\n  subMatrixRow(indices, startColumn, endColumn) {\n    if (startColumn === undefined) startColumn = 0;\n    if (endColumn === undefined) endColumn = this.columns - 1;\n    if (\n      startColumn > endColumn ||\n      startColumn < 0 ||\n      startColumn >= this.columns ||\n      endColumn < 0 ||\n      endColumn >= this.columns\n    ) {\n      throw new RangeError('Argument out of range');\n    }\n\n    let newMatrix = new Matrix(indices.length, endColumn - startColumn + 1);\n    for (let i = 0; i < indices.length; i++) {\n      for (let j = startColumn; j <= endColumn; j++) {\n        if (indices[i] < 0 || indices[i] >= this.rows) {\n          throw new RangeError(`Row index out of range: ${indices[i]}`);\n        }\n        newMatrix.set(i, j - startColumn, this.get(indices[i], j));\n      }\n    }\n    return newMatrix;\n  }\n\n  subMatrixColumn(indices, startRow, endRow) {\n    if (startRow === undefined) startRow = 0;\n    if (endRow === undefined) endRow = this.rows - 1;\n    if (\n      startRow > endRow ||\n      startRow < 0 ||\n      startRow >= this.rows ||\n      endRow < 0 ||\n      endRow >= this.rows\n    ) {\n      throw new RangeError('Argument out of range');\n    }\n\n    let newMatrix = new Matrix(endRow - startRow + 1, indices.length);\n    for (let i = 0; i < indices.length; i++) {\n      for (let j = startRow; j <= endRow; j++) {\n        if (indices[i] < 0 || indices[i] >= this.columns) {\n          throw new RangeError(`Column index out of range: ${indices[i]}`);\n        }\n        newMatrix.set(j - startRow, i, this.get(j, indices[i]));\n      }\n    }\n    return newMatrix;\n  }\n\n  setSubMatrix(matrix, startRow, startColumn) {\n    matrix = Matrix.checkMatrix(matrix);\n    if (matrix.isEmpty()) {\n      return this;\n    }\n    let endRow = startRow + matrix.rows - 1;\n    let endColumn = startColumn + matrix.columns - 1;\n    checkRange(this, startRow, endRow, startColumn, endColumn);\n    for (let i = 0; i < matrix.rows; i++) {\n      for (let j = 0; j < matrix.columns; j++) {\n        this.set(startRow + i, startColumn + j, matrix.get(i, j));\n      }\n    }\n    return this;\n  }\n\n  selection(rowIndices, columnIndices) {\n    let indices = checkIndices(this, rowIndices, columnIndices);\n    let newMatrix = new Matrix(rowIndices.length, columnIndices.length);\n    for (let i = 0; i < indices.row.length; i++) {\n      let rowIndex = indices.row[i];\n      for (let j = 0; j < indices.column.length; j++) {\n        let columnIndex = indices.column[j];\n        newMatrix.set(i, j, this.get(rowIndex, columnIndex));\n      }\n    }\n    return newMatrix;\n  }\n\n  trace() {\n    let min = Math.min(this.rows, this.columns);\n    let trace = 0;\n    for (let i = 0; i < min; i++) {\n      trace += this.get(i, i);\n    }\n    return trace;\n  }\n\n  clone() {\n    let newMatrix = new Matrix(this.rows, this.columns);\n    for (let row = 0; row < this.rows; row++) {\n      for (let column = 0; column < this.columns; column++) {\n        newMatrix.set(row, column, this.get(row, column));\n      }\n    }\n    return newMatrix;\n  }\n\n  sum(by) {\n    switch (by) {\n      case 'row':\n        return sumByRow(this);\n      case 'column':\n        return sumByColumn(this);\n      case undefined:\n        return sumAll(this);\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  product(by) {\n    switch (by) {\n      case 'row':\n        return productByRow(this);\n      case 'column':\n        return productByColumn(this);\n      case undefined:\n        return productAll(this);\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  mean(by) {\n    const sum = this.sum(by);\n    switch (by) {\n      case 'row': {\n        for (let i = 0; i < this.rows; i++) {\n          sum[i] /= this.columns;\n        }\n        return sum;\n      }\n      case 'column': {\n        for (let i = 0; i < this.columns; i++) {\n          sum[i] /= this.rows;\n        }\n        return sum;\n      }\n      case undefined:\n        return sum / this.size;\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  variance(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { unbiased = true, mean = this.mean(by) } = options;\n    if (typeof unbiased !== 'boolean') {\n      throw new TypeError('unbiased must be a boolean');\n    }\n    switch (by) {\n      case 'row': {\n        if (!Array.isArray(mean)) {\n          throw new TypeError('mean must be an array');\n        }\n        return varianceByRow(this, unbiased, mean);\n      }\n      case 'column': {\n        if (!Array.isArray(mean)) {\n          throw new TypeError('mean must be an array');\n        }\n        return varianceByColumn(this, unbiased, mean);\n      }\n      case undefined: {\n        if (typeof mean !== 'number') {\n          throw new TypeError('mean must be a number');\n        }\n        return varianceAll(this, unbiased, mean);\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  standardDeviation(by, options) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    const variance = this.variance(by, options);\n    if (by === undefined) {\n      return Math.sqrt(variance);\n    } else {\n      for (let i = 0; i < variance.length; i++) {\n        variance[i] = Math.sqrt(variance[i]);\n      }\n      return variance;\n    }\n  }\n\n  center(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    const { center = this.mean(by) } = options;\n    switch (by) {\n      case 'row': {\n        if (!Array.isArray(center)) {\n          throw new TypeError('center must be an array');\n        }\n        centerByRow(this, center);\n        return this;\n      }\n      case 'column': {\n        if (!Array.isArray(center)) {\n          throw new TypeError('center must be an array');\n        }\n        centerByColumn(this, center);\n        return this;\n      }\n      case undefined: {\n        if (typeof center !== 'number') {\n          throw new TypeError('center must be a number');\n        }\n        centerAll(this, center);\n        return this;\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  scale(by, options = {}) {\n    if (typeof by === 'object') {\n      options = by;\n      by = undefined;\n    }\n    if (typeof options !== 'object') {\n      throw new TypeError('options must be an object');\n    }\n    let scale = options.scale;\n    switch (by) {\n      case 'row': {\n        if (scale === undefined) {\n          scale = getScaleByRow(this);\n        } else if (!Array.isArray(scale)) {\n          throw new TypeError('scale must be an array');\n        }\n        scaleByRow(this, scale);\n        return this;\n      }\n      case 'column': {\n        if (scale === undefined) {\n          scale = getScaleByColumn(this);\n        } else if (!Array.isArray(scale)) {\n          throw new TypeError('scale must be an array');\n        }\n        scaleByColumn(this, scale);\n        return this;\n      }\n      case undefined: {\n        if (scale === undefined) {\n          scale = getScaleAll(this);\n        } else if (typeof scale !== 'number') {\n          throw new TypeError('scale must be a number');\n        }\n        scaleAll(this, scale);\n        return this;\n      }\n      default:\n        throw new Error(`invalid option: ${by}`);\n    }\n  }\n\n  toString(options) {\n    return inspectMatrixWithOptions(this, options);\n  }\n}\n\nAbstractMatrix.prototype.klass = 'Matrix';\nif (typeof Symbol !== 'undefined') {\n  AbstractMatrix.prototype[\n    Symbol.for('nodejs.util.inspect.custom')\n  ] = inspectMatrix;\n}\n\nfunction compareNumbers(a, b) {\n  return a - b;\n}\n\n// Synonyms\nAbstractMatrix.random = AbstractMatrix.rand;\nAbstractMatrix.randomInt = AbstractMatrix.randInt;\nAbstractMatrix.diagonal = AbstractMatrix.diag;\nAbstractMatrix.prototype.diagonal = AbstractMatrix.prototype.diag;\nAbstractMatrix.identity = AbstractMatrix.eye;\nAbstractMatrix.prototype.negate = AbstractMatrix.prototype.neg;\nAbstractMatrix.prototype.tensorProduct =\n  AbstractMatrix.prototype.kroneckerProduct;\n\nexport default class Matrix extends AbstractMatrix {\n  constructor(nRows, nColumns) {\n    super();\n    if (Matrix.isMatrix(nRows)) {\n      // eslint-disable-next-line no-constructor-return\n      return nRows.clone();\n    } else if (Number.isInteger(nRows) && nRows >= 0) {\n      // Create an empty matrix\n      this.data = [];\n      if (Number.isInteger(nColumns) && nColumns >= 0) {\n        for (let i = 0; i < nRows; i++) {\n          this.data.push(new Float64Array(nColumns));\n        }\n      } else {\n        throw new TypeError('nColumns must be a positive integer');\n      }\n    } else if (Array.isArray(nRows)) {\n      // Copy the values from the 2D array\n      const arrayData = nRows;\n      nRows = arrayData.length;\n      nColumns = nRows ? arrayData[0].length : 0;\n      if (typeof nColumns !== 'number') {\n        throw new TypeError(\n          'Data must be a 2D array with at least one element',\n        );\n      }\n      this.data = [];\n      for (let i = 0; i < nRows; i++) {\n        if (arrayData[i].length !== nColumns) {\n          throw new RangeError('Inconsistent array dimensions');\n        }\n        this.data.push(Float64Array.from(arrayData[i]));\n      }\n    } else {\n      throw new TypeError(\n        'First argument must be a positive number or an array',\n      );\n    }\n    this.rows = nRows;\n    this.columns = nColumns;\n  }\n\n  set(rowIndex, columnIndex, value) {\n    this.data[rowIndex][columnIndex] = value;\n    return this;\n  }\n\n  get(rowIndex, columnIndex) {\n    return this.data[rowIndex][columnIndex];\n  }\n\n  removeRow(index) {\n    checkRowIndex(this, index);\n    this.data.splice(index, 1);\n    this.rows -= 1;\n    return this;\n  }\n\n  addRow(index, array) {\n    if (array === undefined) {\n      array = index;\n      index = this.rows;\n    }\n    checkRowIndex(this, index, true);\n    array = Float64Array.from(checkRowVector(this, array));\n    this.data.splice(index, 0, array);\n    this.rows += 1;\n    return this;\n  }\n\n  removeColumn(index) {\n    checkColumnIndex(this, index);\n    for (let i = 0; i < this.rows; i++) {\n      const newRow = new Float64Array(this.columns - 1);\n      for (let j = 0; j < index; j++) {\n        newRow[j] = this.data[i][j];\n      }\n      for (let j = index + 1; j < this.columns; j++) {\n        newRow[j - 1] = this.data[i][j];\n      }\n      this.data[i] = newRow;\n    }\n    this.columns -= 1;\n    return this;\n  }\n\n  addColumn(index, array) {\n    if (typeof array === 'undefined') {\n      array = index;\n      index = this.columns;\n    }\n    checkColumnIndex(this, index, true);\n    array = checkColumnVector(this, array);\n    for (let i = 0; i < this.rows; i++) {\n      const newRow = new Float64Array(this.columns + 1);\n      let j = 0;\n      for (; j < index; j++) {\n        newRow[j] = this.data[i][j];\n      }\n      newRow[j++] = array[i];\n      for (; j < this.columns + 1; j++) {\n        newRow[j] = this.data[i][j - 1];\n      }\n      this.data[i] = newRow;\n    }\n    this.columns += 1;\n    return this;\n  }\n}\n\ninstallMathOperations(AbstractMatrix, Matrix);\n"]},"metadata":{},"sourceType":"module"}