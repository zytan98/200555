{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport G6 from '@antv/g6';\nimport { isBoolean, mix, isPlainObject, clone, each, deepMix } from '@antv/util';\nimport { defaultMargin, defaultLabelStyle, defaultCardStyle } from '../constants';\nimport { getStyle, getCssPadding, getStatusBBox, getStatusCfg, createMarker, cloneBesidesImg, useEllipsis } from '../utils'; // 通用指标卡\n\nexport var registerIndicatorCardNode = function () {\n  var defaultTitleLabelStyle = {\n    fill: '#fff',\n    fontSize: 12\n  };\n  var defaultTitleRectStyle = {\n    fill: '#40a9ff',\n    radius: [2, 2, 0, 0]\n  };\n  var defaultIconStyle = {\n    width: 12,\n    height: 12\n  };\n  var ARROWS = ['startArrow', 'endArrow'];\n  var SHAPE_DEFAULT_ATTRS = {\n    lineWidth: 1,\n    stroke: undefined,\n    fill: undefined,\n    lineAppendWidth: 1,\n    opacity: undefined,\n    strokeOpacity: undefined,\n    fillOpacity: undefined,\n    x: 0,\n    y: 0,\n    r: 10,\n    width: 20,\n    height: 20,\n    shadowColor: undefined,\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0\n  };\n  var PATH_SHAPE_DEFAULT_ATTRS = {\n    lineWidth: 1,\n    stroke: '#000',\n    lineDash: undefined,\n    startArrow: false,\n    endArrow: false,\n    opacity: undefined,\n    strokeOpacity: undefined,\n    fillOpacity: undefined,\n    shadowColor: undefined,\n    shadowBlur: 0,\n    shadowOffsetX: 0,\n    shadowOffsetY: 0\n  };\n  var SHAPES_DEFAULT_ATTRS = {\n    edge: PATH_SHAPE_DEFAULT_ATTRS,\n    node: SHAPE_DEFAULT_ATTRS\n  };\n  G6.registerNode('indicator-card', {\n    // @ts-ignore\n    draw: function (cfg, group) {\n      var _a, _b;\n\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var _c = cfg.value,\n          value = _c === void 0 ? {} : _c,\n          nodeCfg = cfg.nodeCfg,\n          markerCfg = cfg.markerCfg;\n      var _d = nodeCfg,\n          titleCfg = _d.title,\n          itemsCfg = _d.items,\n          _e = _d.label,\n          label = _e === void 0 ? {} : _e,\n          style = _d.style,\n          _f = _d.padding,\n          padding = _f === void 0 ? 0 : _f,\n          badge = _d.badge,\n          customContent = _d.customContent;\n      var appendPadding = getStatusBBox(badge);\n      var labelStyle = label.style;\n      var cardPadding = getCssPadding(padding);\n      var paddingArray = cardPadding.map(function (item, index) {\n        return item + appendPadding[index];\n      });\n\n      var _g = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {},\n          titleStyle = _g.style,\n          titleContainerStyle = _g.containerStyle,\n          _h = _g.autoEllipsis,\n          autoEllipsis = _h === void 0 ? true : _h;\n\n      var _j = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {},\n          itemStyle = _j.style,\n          itemContainerStyle = _j.containerStyle,\n          layout = _j.layout,\n          _k = _j.itemSpacing,\n          itemSpacing = _k === void 0 ? 4 : _k,\n          sort = _j.sort,\n          _l = _j.padding,\n          itemPadding = _l === void 0 ? [6, 0, 0] : _l;\n\n      var itemPaddingArray = getCssPadding(itemPadding);\n      var _m = value,\n          title = _m.title,\n          items = _m.items;\n      var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n      if (typeof size === 'number') size = [size, size];\n      var height = 0; // 统计容器总高度，动态设置\n\n      var shapeWidth = size[0];\n      var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3]; // card box\n\n      var cardStyle = getStyle(style, cfg, group);\n      var shape = group.addShape('rect', {\n        attrs: __assign(__assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1]\n        }, defaultCardStyle), cardStyle),\n        name: 'main-box',\n        draggable: true\n      }); // node title\n\n      var titleTextShape;\n      var itemShape;\n      var titleShape;\n\n      if (title) {\n        // title rect\n        titleShape = group.addShape('rect', {\n          attrs: __assign(__assign({\n            x: 0,\n            y: 0,\n            width: size[0],\n            height: 0\n          }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n          name: 'title-rect',\n          draggable: true\n        });\n\n        var textStyle = __assign(__assign({}, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group));\n\n        titleTextShape = group.addShape('text', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: paddingArray[0],\n            textBaseline: 'top',\n            text: autoEllipsis ? useEllipsis(title, textStyle === null || textStyle === void 0 ? void 0 : textStyle.fontSize, contentWidth) : title\n          }, textStyle),\n          name: 'title'\n        });\n        var titleHeight_1 = (titleTextShape ? titleTextShape.getBBox() : {\n          height: size[1] / 2\n        }).height;\n        titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight_1 + paddingArray[0] + paddingArray[2]);\n        height += titleShape.getBBox().height;\n      }\n\n      if (items) {\n        if (!titleShape) {\n          height += paddingArray[0];\n        }\n\n        itemShape = group.addShape('rect', {\n          attrs: __assign({\n            x: paddingArray[3],\n            y: height,\n            width: contentWidth,\n            height: 0\n          }, getStyle(itemContainerStyle, cfg, group)),\n          name: 'item-box',\n          draggable: true\n        });\n        height += itemPaddingArray[0];\n        var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n        var isArray_1 = Array.isArray(items);\n\n        var createRowItems_1 = function (item, contentWidth, startX, index) {\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var rowHeight = [];\n          var valueShapeWidth = 0;\n          var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n          keys.forEach(function (key, keyIndex) {\n            var x;\n            var isIcon = key.startsWith('icon'); // sort 直接均分，简单化\n\n            if (sort || layout === 'flex') {\n              x = keyIndex * contentWidth / keys.length;\n            } else if (layout === 'follow') {\n              x = valueShapeWidth;\n            } else {\n              // layout === 'bundled'\n              // 直接均分，icon 紧随 value\n              x = key === 'text' ? 0 : contentWidth / 2;\n              x += isIcon ? valueShapeWidth : 0;\n            }\n\n            var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n              attrs: __assign(__assign({\n                textBaseline: 'top',\n                x: startX + x,\n                y: height,\n                text: item[key],\n                img: item[key]\n              }, isIcon ? defaultIconStyle : defaultLabelStyle), getStyle(itemStyle || labelStyle, cfg, group, key)),\n              name: key + \"-\" + index + \"-\" + keyIndex\n            });\n\n            if (key === 'value' || layout === 'follow') {\n              valueShapeWidth += keyShape.getBBox().width;\n              valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n            }\n\n            rowHeight.push(keyShape.getBBox().height);\n          });\n          return rowHeight;\n        };\n\n        var createItems_1 = function (item, index) {\n          var _a;\n\n          if (index === void 0) {\n            index = 0;\n          }\n\n          var itemsHeight = [];\n\n          if (customContent) {\n            itemsHeight.push((_a = customContent(item, group, {\n              startX: paddingArray[3] + itemPaddingArray[3],\n              startY: height,\n              width: itemContentWidth_1\n            })) !== null && _a !== void 0 ? _a : 0);\n          } else {\n            itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n          }\n\n          height += Math.max.apply(Math, itemsHeight);\n\n          if (isArray_1 && index !== items.length - 1) {\n            height += defaultMargin;\n          }\n        };\n\n        if (Array.isArray(items)) {\n          items.forEach(function (item, index) {\n            createItems_1(item, index);\n          });\n        } else {\n          createItems_1(items);\n        }\n      }\n\n      var titleHeight = (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) || 0;\n      itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - titleHeight + itemPaddingArray[2], size[1]));\n      var itemHeight = (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) || 0;\n      var shapeHeight = items ? (titleHeight || paddingArray[0]) + itemHeight + paddingArray[2] : titleHeight + itemHeight;\n      shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n\n      if (badge) {\n        var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n        group.addShape('rect', {\n          attrs: __assign(__assign({\n            fill: '#40a9ff'\n          }, statusConfig), getStyle(badge.style, cfg, group)),\n          name: 'status-rect'\n        });\n      } // collapse marker\n\n\n      if (markerCfg) {\n        var stateCollapsed = ((_b = (_a = group === null || group === void 0 ? void 0 : group.get('item')) === null || _a === void 0 ? void 0 : _a.getModel()) !== null && _b !== void 0 ? _b : {}).collapsed;\n\n        var _o = shape.getBBox(),\n            shapeWidth_1 = _o.width,\n            shapeHeight_1 = _o.height;\n\n        var _p = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg,\n            show = _p.show,\n            _q = _p.position,\n            position = _q === void 0 ? 'right' : _q,\n            collapsed = _p.collapsed,\n            markerStyle = _p.style;\n\n        createMarker({\n          show: show,\n          position: position,\n          collapsed: stateCollapsed !== null && stateCollapsed !== void 0 ? stateCollapsed : collapsed,\n          style: markerStyle\n        }, group, [shapeWidth_1, shapeHeight_1]);\n        shape.attr('defaultCollapsed', collapsed);\n      }\n\n      return shape;\n    },\n\n    /**\n     * 更新节点，包含文本\n     * @override\n     * @param  {Object} cfg 节点的配置项\n     * @param  {Node} node 节点\n     */\n    // @ts-ignore\n    update: undefined,\n    // @ts-ignore\n    setState: function (name, value, item) {\n      var _a, _b;\n\n      var shape = item.get('keyShape');\n      if (!shape || shape.destroyed) return;\n      var type = item.getType();\n      var stateName = isBoolean(value) ? name : name + \":\" + value;\n      var itemStateStyle = item.getStateStyle(stateName); // const originStyle = item.getOriginStyle();\n      // 不允许设置一个不存在的状态\n\n      if (!itemStateStyle) {\n        return;\n      } // 要设置或取消的状态的样式\n      // 当没有 state 状态时，默认使用 model.stateStyles 中的样式\n\n\n      var styles = Object.assign({}, itemStateStyle);\n      var group = item.getContainer(); // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值。使用对象检索更快\n\n      var keptAttrs = {\n        x: 1,\n        y: 1,\n        cx: 1,\n        cy: 1\n      };\n\n      if (value) {\n        var _loop_1 = function (key) {\n          var _c;\n\n          var style = styles[key];\n\n          if (isPlainObject(style) && !ARROWS.includes(key)) {\n            var subShape = group.find(function (element) {\n              return element.get('name') === key;\n            });\n\n            if (subShape) {\n              subShape.attr(style);\n            }\n          } else {\n            // 非纯对象，则认为是设置到 keyShape 上面的\n            shape.attr((_c = {}, _c[key] = style, _c));\n          }\n        }; // style 为要设置的状态的样式\n\n\n        for (var key in styles) {\n          _loop_1(key);\n        }\n      } else {\n        // 所有生效的 state 的样式\n        var enableStatesStyle = cloneBesidesImg(item.getCurrentStatesStyle());\n        var model = item.getModel(); // 原始样式\n\n        var originStyle_1 = mix({}, model.style, cloneBesidesImg(item.getOriginStyle()));\n        var keyShapeName_1 = shape.get('name'); // cloning  shape.attr(), keys.forEach to avoid cloning the img attr, which leads to maximum clone heap #2383\n        // const keyShapeStyles = clone(shape.attr())\n\n        var shapeAttrs_1 = shape.attr();\n        var keyShapeStyles_1 = {};\n        Object.keys(shapeAttrs_1).forEach(function (key) {\n          if (key === 'img') return;\n          var attr = shapeAttrs_1[key];\n\n          if (attr && typeof attr === 'object') {\n            keyShapeStyles_1[key] = clone(attr);\n          } else {\n            keyShapeStyles_1[key] = attr;\n          }\n        }); // 已有样式 - 要取消的状态的样式\n\n        var filtetDisableStatesStyle = {};\n\n        var _loop_2 = function (p) {\n          var style = styles[p];\n\n          if (isPlainObject(style) && !ARROWS.includes(p)) {\n            var subShape_1 = group.find(function (element) {\n              return element.get('name') === p;\n            });\n\n            if (subShape_1) {\n              var subShapeStyles_1 = clone(subShape_1.attr());\n              each(style, function (v, key) {\n                if (p === keyShapeName_1 && keyShapeStyles_1[key] && !keptAttrs[key]) {\n                  delete keyShapeStyles_1[key];\n                  var value_1 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                  shape.attr(key, value_1);\n                } else if (subShapeStyles_1[key] || subShapeStyles_1[key] === 0) {\n                  delete subShapeStyles_1[key];\n                  var value_2 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                  subShape_1.attr(key, value_2);\n                }\n              });\n              filtetDisableStatesStyle[p] = subShapeStyles_1;\n            }\n          } else {\n            if (keyShapeStyles_1[p] && !keptAttrs[p]) {\n              delete keyShapeStyles_1[p];\n              var value_3 = originStyle_1[p] || (originStyle_1[keyShapeName_1] ? originStyle_1[keyShapeName_1][p] : undefined) || SHAPES_DEFAULT_ATTRS[type][p];\n              shape.attr(p, value_3);\n            }\n          }\n        }; // styles 为要取消的状态的样式\n\n\n        for (var p in styles) {\n          _loop_2(p);\n        } // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值后，\n        // 如果 keyShape 有 name 属性，则 filtetDisableStatesStyle 的格式为 { keyShapeName: {} }\n        // 否则为普通对象\n\n\n        if (!keyShapeName_1) {\n          mix(filtetDisableStatesStyle, keyShapeStyles_1);\n        } else {\n          filtetDisableStatesStyle[keyShapeName_1] = keyShapeStyles_1;\n        }\n\n        for (var key in enableStatesStyle) {\n          if (keptAttrs[key]) continue;\n          var enableStyle = enableStatesStyle[key];\n\n          if (!isPlainObject(enableStyle) || ARROWS.includes(key)) {\n            // 把样式属性merge到keyShape中\n            if (!keyShapeName_1) {\n              mix(originStyle_1, (_a = {}, _a[key] = enableStyle, _a));\n            } else {\n              mix(originStyle_1[keyShapeName_1], (_b = {}, _b[key] = enableStyle, _b));\n              delete originStyle_1[key];\n            }\n\n            delete enableStatesStyle[key];\n          }\n        }\n\n        var originstyles = {};\n        deepMix(originstyles, originStyle_1, filtetDisableStatesStyle, enableStatesStyle);\n        var keyShapeSetted = false;\n\n        var _loop_3 = function (originKey) {\n          var _d;\n\n          var style = originstyles[originKey];\n\n          if (isPlainObject(style) && !ARROWS.includes(originKey)) {\n            var subShape = group.find(function (element) {\n              return element.get('name') === originKey;\n            });\n\n            if (subShape) {\n              if (originKey === keyShapeName_1) {\n                keyShapeSetted = true;\n              }\n\n              if (originKey !== 'collapse-icon') subShape.attr(style);\n            }\n          } else if (!keyShapeSetted) {\n            var value_4 = style || SHAPES_DEFAULT_ATTRS[type][originKey];\n            shape.attr((_d = {}, _d[originKey] = value_4, _d));\n          }\n        };\n\n        for (var originKey in originstyles) {\n          _loop_3(originKey);\n        }\n      }\n    }\n  }, 'single-node');\n};","map":{"version":3,"sources":["C:/Users/Home/Desktop/cs-2005/node_modules/@ant-design/charts/es/graphs/flowAnalysisGraph/customItem.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","G6","isBoolean","mix","isPlainObject","clone","each","deepMix","defaultMargin","defaultLabelStyle","defaultCardStyle","getStyle","getCssPadding","getStatusBBox","getStatusCfg","createMarker","cloneBesidesImg","useEllipsis","registerIndicatorCardNode","defaultTitleLabelStyle","fill","fontSize","defaultTitleRectStyle","radius","defaultIconStyle","width","height","ARROWS","SHAPE_DEFAULT_ATTRS","lineWidth","stroke","undefined","lineAppendWidth","opacity","strokeOpacity","fillOpacity","x","y","r","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","PATH_SHAPE_DEFAULT_ATTRS","lineDash","startArrow","endArrow","SHAPES_DEFAULT_ATTRS","edge","node","registerNode","draw","cfg","group","_a","_b","_c","value","nodeCfg","markerCfg","_d","titleCfg","title","itemsCfg","items","_e","label","style","_f","padding","badge","customContent","appendPadding","labelStyle","cardPadding","paddingArray","map","item","index","_g","titleStyle","titleContainerStyle","containerStyle","_h","autoEllipsis","_j","itemStyle","itemContainerStyle","layout","_k","itemSpacing","sort","_l","itemPadding","itemPaddingArray","_m","size","shapeWidth","contentWidth","cardStyle","shape","addShape","attrs","name","draggable","titleTextShape","itemShape","titleShape","textStyle","textBaseline","text","titleHeight_1","getBBox","attr","itemContentWidth_1","isArray_1","Array","isArray","createRowItems_1","startX","rowHeight","valueShapeWidth","keys","forEach","key","keyIndex","isIcon","startsWith","keyShape","img","push","createItems_1","itemsHeight","startY","Math","max","titleHeight","itemHeight","shapeHeight","statusConfig","stateCollapsed","get","getModel","collapsed","_o","shapeWidth_1","shapeHeight_1","_p","show","_q","position","markerStyle","update","setState","destroyed","type","getType","stateName","itemStateStyle","getStateStyle","styles","getContainer","keptAttrs","cx","cy","_loop_1","includes","subShape","find","element","enableStatesStyle","getCurrentStatesStyle","model","originStyle_1","getOriginStyle","keyShapeName_1","shapeAttrs_1","keyShapeStyles_1","filtetDisableStatesStyle","_loop_2","subShape_1","subShapeStyles_1","v","value_1","value_2","value_3","enableStyle","originstyles","keyShapeSetted","_loop_3","originKey","value_4"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport G6 from '@antv/g6';\nimport { isBoolean, mix, isPlainObject, clone, each, deepMix } from '@antv/util';\nimport { defaultMargin, defaultLabelStyle, defaultCardStyle } from '../constants';\nimport { getStyle, getCssPadding, getStatusBBox, getStatusCfg, createMarker, cloneBesidesImg, useEllipsis, } from '../utils';\n// 通用指标卡\nexport var registerIndicatorCardNode = function () {\n    var defaultTitleLabelStyle = {\n        fill: '#fff',\n        fontSize: 12,\n    };\n    var defaultTitleRectStyle = {\n        fill: '#40a9ff',\n        radius: [2, 2, 0, 0],\n    };\n    var defaultIconStyle = {\n        width: 12,\n        height: 12,\n    };\n    var ARROWS = ['startArrow', 'endArrow'];\n    var SHAPE_DEFAULT_ATTRS = {\n        lineWidth: 1,\n        stroke: undefined,\n        fill: undefined,\n        lineAppendWidth: 1,\n        opacity: undefined,\n        strokeOpacity: undefined,\n        fillOpacity: undefined,\n        x: 0,\n        y: 0,\n        r: 10,\n        width: 20,\n        height: 20,\n        shadowColor: undefined,\n        shadowBlur: 0,\n        shadowOffsetX: 0,\n        shadowOffsetY: 0,\n    };\n    var PATH_SHAPE_DEFAULT_ATTRS = {\n        lineWidth: 1,\n        stroke: '#000',\n        lineDash: undefined,\n        startArrow: false,\n        endArrow: false,\n        opacity: undefined,\n        strokeOpacity: undefined,\n        fillOpacity: undefined,\n        shadowColor: undefined,\n        shadowBlur: 0,\n        shadowOffsetX: 0,\n        shadowOffsetY: 0,\n    };\n    var SHAPES_DEFAULT_ATTRS = {\n        edge: PATH_SHAPE_DEFAULT_ATTRS,\n        node: SHAPE_DEFAULT_ATTRS,\n    };\n    G6.registerNode('indicator-card', {\n        // @ts-ignore\n        draw: function (cfg, group) {\n            var _a, _b;\n            if (cfg === void 0) { cfg = {}; }\n            var _c = cfg.value, value = _c === void 0 ? {} : _c, nodeCfg = cfg.nodeCfg, markerCfg = cfg.markerCfg;\n            var _d = nodeCfg, titleCfg = _d.title, itemsCfg = _d.items, _e = _d.label, label = _e === void 0 ? {} : _e, style = _d.style, _f = _d.padding, padding = _f === void 0 ? 0 : _f, badge = _d.badge, customContent = _d.customContent;\n            var appendPadding = getStatusBBox(badge);\n            var labelStyle = label.style;\n            var cardPadding = getCssPadding(padding);\n            var paddingArray = cardPadding.map(function (item, index) { return item + appendPadding[index]; });\n            var _g = titleCfg !== null && titleCfg !== void 0 ? titleCfg : {}, titleStyle = _g.style, titleContainerStyle = _g.containerStyle, _h = _g.autoEllipsis, autoEllipsis = _h === void 0 ? true : _h;\n            var _j = itemsCfg !== null && itemsCfg !== void 0 ? itemsCfg : {}, itemStyle = _j.style, itemContainerStyle = _j.containerStyle, layout = _j.layout, _k = _j.itemSpacing, itemSpacing = _k === void 0 ? 4 : _k, sort = _j.sort, _l = _j.padding, itemPadding = _l === void 0 ? [6, 0, 0] : _l;\n            var itemPaddingArray = getCssPadding(itemPadding);\n            var _m = value, title = _m.title, items = _m.items;\n            var size = (cfg === null || cfg === void 0 ? void 0 : cfg.size) || [100, 30];\n            if (typeof size === 'number')\n                size = [size, size];\n            var height = 0; // 统计容器总高度，动态设置\n            var shapeWidth = size[0];\n            var contentWidth = shapeWidth - paddingArray[1] - paddingArray[3];\n            // card box\n            var cardStyle = getStyle(style, cfg, group);\n            var shape = group.addShape('rect', {\n                attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: size[1] }, defaultCardStyle), cardStyle),\n                name: 'main-box',\n                draggable: true,\n            });\n            // node title\n            var titleTextShape;\n            var itemShape;\n            var titleShape;\n            if (title) {\n                // title rect\n                titleShape = group.addShape('rect', {\n                    attrs: __assign(__assign({ x: 0, y: 0, width: size[0], height: 0 }, defaultTitleRectStyle), getStyle(titleContainerStyle, cfg, group)),\n                    name: 'title-rect',\n                    draggable: true,\n                });\n                var textStyle = __assign(__assign({}, defaultTitleLabelStyle), getStyle(titleStyle, cfg, group));\n                titleTextShape = group.addShape('text', {\n                    attrs: __assign({ x: paddingArray[3], y: paddingArray[0], textBaseline: 'top', text: autoEllipsis ? useEllipsis(title, textStyle === null || textStyle === void 0 ? void 0 : textStyle.fontSize, contentWidth) : title }, textStyle),\n                    name: 'title',\n                });\n                var titleHeight_1 = (titleTextShape\n                    ? titleTextShape.getBBox()\n                    : { height: size[1] / 2 }).height;\n                titleShape === null || titleShape === void 0 ? void 0 : titleShape.attr('height', titleHeight_1 + paddingArray[0] + paddingArray[2]);\n                height += titleShape.getBBox().height;\n            }\n            if (items) {\n                if (!titleShape) {\n                    height += paddingArray[0];\n                }\n                itemShape = group.addShape('rect', {\n                    attrs: __assign({ x: paddingArray[3], y: height, width: contentWidth, height: 0 }, getStyle(itemContainerStyle, cfg, group)),\n                    name: 'item-box',\n                    draggable: true,\n                });\n                height += itemPaddingArray[0];\n                var itemContentWidth_1 = contentWidth - itemPaddingArray[1] - itemPaddingArray[3];\n                var isArray_1 = Array.isArray(items);\n                var createRowItems_1 = function (item, contentWidth, startX, index) {\n                    if (index === void 0) { index = 0; }\n                    var rowHeight = [];\n                    var valueShapeWidth = 0;\n                    var keys = sort ? Object.keys(item) : ['text', 'value', 'icon'];\n                    keys.forEach(function (key, keyIndex) {\n                        var x;\n                        var isIcon = key.startsWith('icon');\n                        // sort 直接均分，简单化\n                        if (sort || layout === 'flex') {\n                            x = (keyIndex * contentWidth) / keys.length;\n                        }\n                        else if (layout === 'follow') {\n                            x = valueShapeWidth;\n                        }\n                        else {\n                            // layout === 'bundled'\n                            // 直接均分，icon 紧随 value\n                            x = key === 'text' ? 0 : contentWidth / 2;\n                            x += isIcon ? valueShapeWidth : 0;\n                        }\n                        var keyShape = group.addShape(isIcon ? 'image' : 'text', {\n                            attrs: __assign(__assign({ textBaseline: 'top', x: startX + x, y: height, text: item[key], img: item[key] }, (isIcon ? defaultIconStyle : defaultLabelStyle)), getStyle(itemStyle || labelStyle, cfg, group, key)),\n                            name: key + \"-\" + index + \"-\" + keyIndex,\n                        });\n                        if (key === 'value' || layout === 'follow') {\n                            valueShapeWidth += keyShape.getBBox().width;\n                            valueShapeWidth += layout === 'follow' ? itemSpacing : 0;\n                        }\n                        rowHeight.push(keyShape.getBBox().height);\n                    });\n                    return rowHeight;\n                };\n                var createItems_1 = function (item, index) {\n                    var _a;\n                    if (index === void 0) { index = 0; }\n                    var itemsHeight = [];\n                    if (customContent) {\n                        itemsHeight.push((_a = customContent(item, group, {\n                            startX: paddingArray[3] + itemPaddingArray[3],\n                            startY: height,\n                            width: itemContentWidth_1,\n                        })) !== null && _a !== void 0 ? _a : 0);\n                    }\n                    else {\n                        itemsHeight.push.apply(itemsHeight, createRowItems_1(item, itemContentWidth_1, paddingArray[3] + itemPaddingArray[3], index));\n                    }\n                    height += Math.max.apply(Math, itemsHeight);\n                    if (isArray_1 && index !== items.length - 1) {\n                        height += defaultMargin;\n                    }\n                };\n                if (Array.isArray(items)) {\n                    items.forEach(function (item, index) {\n                        createItems_1(item, index);\n                    });\n                }\n                else {\n                    createItems_1(items);\n                }\n            }\n            var titleHeight = (titleShape === null || titleShape === void 0 ? void 0 : titleShape.getBBox().height) || 0;\n            itemShape === null || itemShape === void 0 ? void 0 : itemShape.attr('height', Math.max(height - titleHeight + itemPaddingArray[2], size[1]));\n            var itemHeight = (itemShape === null || itemShape === void 0 ? void 0 : itemShape.getBBox().height) || 0;\n            var shapeHeight = items\n                ? (titleHeight || paddingArray[0]) + itemHeight + paddingArray[2]\n                : titleHeight + itemHeight;\n            shape === null || shape === void 0 ? void 0 : shape.attr('height', shapeHeight);\n            if (badge) {\n                var statusConfig = getStatusCfg(badge, [size[0], shapeHeight]);\n                group.addShape('rect', {\n                    attrs: __assign(__assign({ fill: '#40a9ff' }, statusConfig), getStyle(badge.style, cfg, group)),\n                    name: 'status-rect',\n                });\n            }\n            // collapse marker\n            if (markerCfg) {\n                var stateCollapsed = ((_b = (_a = group === null || group === void 0 ? void 0 : group.get('item')) === null || _a === void 0 ? void 0 : _a.getModel()) !== null && _b !== void 0 ? _b : {}).collapsed;\n                var _o = shape.getBBox(), shapeWidth_1 = _o.width, shapeHeight_1 = _o.height;\n                var _p = typeof markerCfg === 'function' ? markerCfg(cfg, group) : markerCfg, show = _p.show, _q = _p.position, position = _q === void 0 ? 'right' : _q, collapsed = _p.collapsed, markerStyle = _p.style;\n                createMarker({\n                    show: show,\n                    position: position,\n                    collapsed: stateCollapsed !== null && stateCollapsed !== void 0 ? stateCollapsed : collapsed,\n                    style: markerStyle,\n                }, group, [shapeWidth_1, shapeHeight_1]);\n                shape.attr('defaultCollapsed', collapsed);\n            }\n            return shape;\n        },\n        /**\n         * 更新节点，包含文本\n         * @override\n         * @param  {Object} cfg 节点的配置项\n         * @param  {Node} node 节点\n         */\n        // @ts-ignore\n        update: undefined,\n        // @ts-ignore\n        setState: function (name, value, item) {\n            var _a, _b;\n            var shape = item.get('keyShape');\n            if (!shape || shape.destroyed)\n                return;\n            var type = item.getType();\n            var stateName = isBoolean(value) ? name : name + \":\" + value;\n            var itemStateStyle = item.getStateStyle(stateName);\n            // const originStyle = item.getOriginStyle();\n            // 不允许设置一个不存在的状态\n            if (!itemStateStyle) {\n                return;\n            }\n            // 要设置或取消的状态的样式\n            // 当没有 state 状态时，默认使用 model.stateStyles 中的样式\n            var styles = Object.assign({}, itemStateStyle);\n            var group = item.getContainer();\n            // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值。使用对象检索更快\n            var keptAttrs = { x: 1, y: 1, cx: 1, cy: 1 };\n            if (value) {\n                var _loop_1 = function (key) {\n                    var _c;\n                    var style = styles[key];\n                    if (isPlainObject(style) && !ARROWS.includes(key)) {\n                        var subShape = group.find(function (element) { return element.get('name') === key; });\n                        if (subShape) {\n                            subShape.attr(style);\n                        }\n                    }\n                    else {\n                        // 非纯对象，则认为是设置到 keyShape 上面的\n                        shape.attr((_c = {},\n                            _c[key] = style,\n                            _c));\n                    }\n                };\n                // style 为要设置的状态的样式\n                for (var key in styles) {\n                    _loop_1(key);\n                }\n            }\n            else {\n                // 所有生效的 state 的样式\n                var enableStatesStyle = cloneBesidesImg(item.getCurrentStatesStyle());\n                var model = item.getModel();\n                // 原始样式\n                var originStyle_1 = mix({}, model.style, cloneBesidesImg(item.getOriginStyle()));\n                var keyShapeName_1 = shape.get('name');\n                // cloning  shape.attr(), keys.forEach to avoid cloning the img attr, which leads to maximum clone heap #2383\n                // const keyShapeStyles = clone(shape.attr())\n                var shapeAttrs_1 = shape.attr();\n                var keyShapeStyles_1 = {};\n                Object.keys(shapeAttrs_1).forEach(function (key) {\n                    if (key === 'img')\n                        return;\n                    var attr = shapeAttrs_1[key];\n                    if (attr && typeof attr === 'object') {\n                        keyShapeStyles_1[key] = clone(attr);\n                    }\n                    else {\n                        keyShapeStyles_1[key] = attr;\n                    }\n                });\n                // 已有样式 - 要取消的状态的样式\n                var filtetDisableStatesStyle = {};\n                var _loop_2 = function (p) {\n                    var style = styles[p];\n                    if (isPlainObject(style) && !ARROWS.includes(p)) {\n                        var subShape_1 = group.find(function (element) { return element.get('name') === p; });\n                        if (subShape_1) {\n                            var subShapeStyles_1 = clone(subShape_1.attr());\n                            each(style, function (v, key) {\n                                if (p === keyShapeName_1 && keyShapeStyles_1[key] && !keptAttrs[key]) {\n                                    delete keyShapeStyles_1[key];\n                                    var value_1 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                                    shape.attr(key, value_1);\n                                }\n                                else if (subShapeStyles_1[key] || subShapeStyles_1[key] === 0) {\n                                    delete subShapeStyles_1[key];\n                                    var value_2 = originStyle_1[p][key] || SHAPES_DEFAULT_ATTRS[type][key];\n                                    subShape_1.attr(key, value_2);\n                                }\n                            });\n                            filtetDisableStatesStyle[p] = subShapeStyles_1;\n                        }\n                    }\n                    else {\n                        if (keyShapeStyles_1[p] && !keptAttrs[p]) {\n                            delete keyShapeStyles_1[p];\n                            var value_3 = originStyle_1[p] ||\n                                (originStyle_1[keyShapeName_1] ? originStyle_1[keyShapeName_1][p] : undefined) ||\n                                SHAPES_DEFAULT_ATTRS[type][p];\n                            shape.attr(p, value_3);\n                        }\n                    }\n                };\n                // styles 为要取消的状态的样式\n                for (var p in styles) {\n                    _loop_2(p);\n                }\n                // 从图元素现有的样式中删除本次要取消的 states 中存在的属性值后，\n                // 如果 keyShape 有 name 属性，则 filtetDisableStatesStyle 的格式为 { keyShapeName: {} }\n                // 否则为普通对象\n                if (!keyShapeName_1) {\n                    mix(filtetDisableStatesStyle, keyShapeStyles_1);\n                }\n                else {\n                    filtetDisableStatesStyle[keyShapeName_1] = keyShapeStyles_1;\n                }\n                for (var key in enableStatesStyle) {\n                    if (keptAttrs[key])\n                        continue;\n                    var enableStyle = enableStatesStyle[key];\n                    if (!isPlainObject(enableStyle) || ARROWS.includes(key)) {\n                        // 把样式属性merge到keyShape中\n                        if (!keyShapeName_1) {\n                            mix(originStyle_1, (_a = {},\n                                _a[key] = enableStyle,\n                                _a));\n                        }\n                        else {\n                            mix(originStyle_1[keyShapeName_1], (_b = {},\n                                _b[key] = enableStyle,\n                                _b));\n                            delete originStyle_1[key];\n                        }\n                        delete enableStatesStyle[key];\n                    }\n                }\n                var originstyles = {};\n                deepMix(originstyles, originStyle_1, filtetDisableStatesStyle, enableStatesStyle);\n                var keyShapeSetted = false;\n                var _loop_3 = function (originKey) {\n                    var _d;\n                    var style = originstyles[originKey];\n                    if (isPlainObject(style) && !ARROWS.includes(originKey)) {\n                        var subShape = group.find(function (element) { return element.get('name') === originKey; });\n                        if (subShape) {\n                            if (originKey === keyShapeName_1) {\n                                keyShapeSetted = true;\n                            }\n                            if (originKey !== 'collapse-icon')\n                                subShape.attr(style);\n                        }\n                    }\n                    else if (!keyShapeSetted) {\n                        var value_4 = style || SHAPES_DEFAULT_ATTRS[type][originKey];\n                        shape.attr((_d = {},\n                            _d[originKey] = value_4,\n                            _d));\n                    }\n                };\n                for (var originKey in originstyles) {\n                    _loop_3(originKey);\n                }\n            }\n        },\n    }, 'single-node');\n};\n"]},"metadata":{},"sourceType":"module"}