{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport G6 from '@antv/g6';\nimport { defaultLabelStyle, Margin, defaultTitleLabelCfg, cardTitlePadding } from './constants';\nimport { getConfig, getContentAndStyle, getMarkerPosition } from './utils';\nexport var registerCardNode = function () {\n  G6.registerNode('card', {\n    draw: function (cfg, group) {\n      var _a;\n\n      if (cfg === void 0) {\n        cfg = {};\n      }\n\n      var title = cfg.title,\n          body = cfg.body,\n          footer = cfg.footer,\n          collapseExpand = cfg.collapseExpand,\n          children = cfg.children,\n          markerPosition = cfg.markerPosition;\n      var size = cfg.size || [100, 30];\n      var height = 0; // 统计容器总高度，动态设置\n\n      if (typeof size === 'number') size = [size, size];\n\n      var style = __assign({\n        radius: 2,\n        fill: '#fff'\n      }, cfg.style);\n\n      var color = style.stroke || cfg.color || '#5B8FF9';\n      var radius = style.radius; // node box\n\n      var shape = group.addShape('rect', {\n        attrs: __assign({\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: size[1],\n          stroke: color\n        }, style),\n        name: 'main-box',\n        draggable: true\n      }); // node title\n\n      var titleTextShape;\n\n      if (title) {\n        var _b = getContentAndStyle(title),\n            text = _b.text,\n            _c = _b.style,\n            titleStyle = _c === void 0 ? cfg.titleStyle : _c;\n\n        titleTextShape = group.addShape('text', {\n          attrs: __assign(__assign({\n            textBaseline: 'top',\n            x: Margin,\n            y: cardTitlePadding,\n            text: text\n          }, defaultTitleLabelCfg), getConfig(titleStyle, group)),\n          name: 'title'\n        });\n      }\n\n      var titleHeight = (titleTextShape ? titleTextShape.getBBox() : {\n        height: size[1] / 2\n      }).height; // title rect\n\n      var titleRectShape = group.addShape('rect', {\n        attrs: {\n          x: 0,\n          y: 0,\n          width: size[0],\n          height: titleHeight + 2 * cardTitlePadding,\n          fill: color,\n          radius: [radius, radius, 0, 0]\n        },\n        name: 'title-rect',\n        draggable: true\n      });\n      titleTextShape === null || titleTextShape === void 0 ? void 0 : titleTextShape.toFront(); // collapse marker\n\n      var markerShape;\n\n      if (collapseExpand && children) {\n        markerShape = group.addShape('marker', {\n          attrs: __assign(__assign(__assign({}, getMarkerPosition(markerPosition, size)), {\n            r: 6,\n            cursor: 'pointer',\n            symbol: cfg.collapsed ? G6.Marker.expand : G6.Marker.collapse,\n            stroke: color,\n            lineWidth: 1,\n            fill: '#fff'\n          }), getConfig(cfg.markerStyle, group, __assign(__assign({}, cfg), {\n            name: 'collapse-icon'\n          }))),\n          name: 'collapse-icon'\n        });\n      }\n\n      var titleRectBoxHeight = titleRectShape.getBBox().height;\n      height += titleRectBoxHeight; // body\n\n      var bodyShape;\n\n      if (body) {\n        var _d = getContentAndStyle(body),\n            text = _d.text,\n            _e = _d.style,\n            bodyStyle = _e === void 0 ? cfg.bodyStyle : _e;\n\n        bodyShape = group.addShape('text', {\n          attrs: __assign(__assign({\n            textBaseline: 'top',\n            x: Margin,\n            y: height + Margin,\n            text: text\n          }, defaultLabelStyle), getConfig(bodyStyle, group)),\n          name: \"body\"\n        });\n        height += bodyShape.getBBox().height;\n      } // footer\n\n\n      var footerTextShape;\n\n      if (footer) {\n        if (bodyShape) {\n          height += Margin;\n        }\n\n        var _f = getContentAndStyle(footer),\n            labelText = _f.text,\n            _g = _f.style,\n            labelStyle = _g === void 0 ? cfg.footerStyle : _g;\n\n        footerTextShape = group.addShape('text', {\n          attrs: __assign(__assign({\n            textBaseline: 'top',\n            x: Margin,\n            y: height + Margin,\n            text: labelText\n          }, defaultLabelStyle), getConfig(labelStyle, group)),\n          name: \"footer-label\"\n        });\n\n        var _h = footerTextShape.getBBox(),\n            width = _h.width,\n            contentHeight = _h.height;\n\n        var footerValueHeight = 0;\n\n        if (typeof cfg.footer === 'object' && ((_a = cfg.footer) === null || _a === void 0 ? void 0 : _a.value)) {\n          var _j = getContentAndStyle({\n            content: cfg.footer.value,\n            style: cfg.footer.valueStyle\n          }),\n              valueText = _j.text,\n              _k = _j.style,\n              valueStyle = _k === void 0 ? cfg.footerValueStyle || cfg.footerStyle : _k;\n\n          var valueTextShape = group.addShape('text', {\n            attrs: __assign(__assign({\n              textBaseline: 'top',\n              x: width + Margin * 2,\n              y: height + Margin,\n              text: valueText\n            }, defaultLabelStyle), getConfig(valueStyle, group)),\n            name: \"footer-value\"\n          });\n          var valueHeight = valueTextShape.getBBox().height;\n          footerValueHeight = valueHeight;\n        }\n\n        height += Math.max(contentHeight, footerValueHeight);\n      } // 调整容器宽高\n\n\n      if (bodyShape) {\n        var desTextShapeBBox = bodyShape.getBBox();\n        var width = size[0] > desTextShapeBBox.width + 16 ? size[0] : desTextShapeBBox.width + 16;\n        shape.attr({\n          width: width,\n          height: height + 16\n        });\n        titleRectShape === null || titleRectShape === void 0 ? void 0 : titleRectShape.attr('width', width);\n        markerShape === null || markerShape === void 0 ? void 0 : markerShape.attr(__assign({}, getMarkerPosition(markerPosition, [width, height + titleHeight + 2 * cardTitlePadding])));\n      }\n\n      return shape;\n    },\n    update: undefined\n  }, 'single-node');\n};\nexport var registerIconNode = function () {\n  G6.registerNode('icon-node', {\n    options: {\n      size: [60, 20],\n      stroke: '#91d5ff',\n      fill: '#91d5ff'\n    },\n    draw: function (cfg, group) {\n      if (cfg === void 0) {\n        cfg = {};\n      } // @ts-ignore\n\n\n      var styles = this.getShapeStyle(cfg);\n      var _a = cfg.labelCfg,\n          labelCfg = _a === void 0 ? {} : _a,\n          labelStyle = cfg.labelStyle,\n          label = cfg.label,\n          markerStyle = cfg.markerStyle,\n          showMarker = cfg.showMarker,\n          title = cfg.title,\n          titleStyle = cfg.titleStyle;\n      var keyShape = group.addShape('rect', {\n        attrs: __assign(__assign({}, styles), {\n          x: 0,\n          y: 0\n        })\n      });\n      var keyShapeHeight = keyShape.getBBox().height;\n      var headShape;\n\n      if (cfg.leftIcon) {\n        var _b = cfg.leftIcon,\n            _c = _b.x,\n            x = _c === void 0 ? 8 : _c,\n            y = _b.y,\n            _d = _b.width,\n            width = _d === void 0 ? 24 : _d,\n            _e = _b.height,\n            height = _e === void 0 ? 24 : _e,\n            style = _b.style;\n\n        if (style) {\n          group.addShape('rect', {\n            attrs: __assign({\n              x: 1,\n              y: 1,\n              width: 38,\n              height: styles.height - 2\n            }, style)\n          });\n        }\n\n        headShape = group.addShape('image', {\n          attrs: {\n            x: x,\n            y: y || keyShapeHeight / 2 - height / 2,\n            width: width,\n            height: height,\n            img: cfg.leftIcon.img\n          },\n          name: 'image-shape'\n        });\n      }\n\n      if (showMarker) {\n        group.addShape('marker', {\n          attrs: __assign({\n            x: styles.width / 3,\n            y: styles.height + 6,\n            r: 6,\n            stroke: '#73d13d',\n            cursor: 'pointer',\n            symbol: G6.Marker.expand\n          }, getConfig(markerStyle, group, __assign(__assign({}, cfg), {\n            name: 'add-item'\n          }))),\n          name: 'add-item'\n        });\n        group.addShape('marker', {\n          attrs: __assign({\n            x: styles.width * 2 / 3,\n            y: styles.height + 6,\n            r: 6,\n            stroke: '#ff4d4f',\n            cursor: 'pointer',\n            symbol: G6.Marker.collapse\n          }, getConfig(markerStyle, group, __assign(__assign({}, cfg), {\n            name: 'remove-item'\n          }))),\n          name: 'remove-item'\n        });\n      }\n\n      if (label) {\n        var textCfg = labelStyle ? getConfig(labelStyle, group, cfg) : labelCfg.style;\n        var y = title ? styles.height / 2 - (textCfg.fontSize * 1 || 12) - Margin / 2 : styles.height / 2;\n        group.addShape('text', {\n          attrs: __assign({\n            text: label,\n            x: styles.width / 2,\n            y: y,\n            textAlign: headShape ? 'start' : 'center',\n            textBaseline: title ? 'top' : 'middle'\n          }, textCfg)\n        });\n      }\n\n      if (title) {\n        var titleCfg = titleStyle ? getConfig(titleStyle, group, cfg) : labelCfg.style;\n        group.addShape('text', {\n          attrs: __assign({\n            text: title,\n            x: styles.width / 2,\n            y: styles.height / 2 + Margin / 2,\n            textAlign: headShape ? 'start' : 'center',\n            textBaseline: 'top'\n          }, titleCfg)\n        });\n      }\n\n      return keyShape;\n    }\n  }, 'rect');\n};","map":{"version":3,"sources":["C:/Users/Home/Desktop/cs-2005/node_modules/@ant-design/charts/es/obsolescent/graphs/customItems.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","G6","defaultLabelStyle","Margin","defaultTitleLabelCfg","cardTitlePadding","getConfig","getContentAndStyle","getMarkerPosition","registerCardNode","registerNode","draw","cfg","group","_a","title","body","footer","collapseExpand","children","markerPosition","size","height","style","radius","fill","color","stroke","shape","addShape","attrs","x","y","width","name","draggable","titleTextShape","_b","text","_c","titleStyle","textBaseline","titleHeight","getBBox","titleRectShape","toFront","markerShape","r","cursor","symbol","collapsed","Marker","expand","collapse","lineWidth","markerStyle","titleRectBoxHeight","bodyShape","_d","_e","bodyStyle","footerTextShape","_f","labelText","_g","labelStyle","footerStyle","_h","contentHeight","footerValueHeight","value","_j","content","valueStyle","valueText","_k","footerValueStyle","valueTextShape","valueHeight","Math","max","desTextShapeBBox","attr","update","undefined","registerIconNode","options","styles","getShapeStyle","labelCfg","label","showMarker","keyShape","keyShapeHeight","headShape","leftIcon","img","textCfg","fontSize","textAlign","titleCfg"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport G6 from '@antv/g6';\nimport { defaultLabelStyle, Margin, defaultTitleLabelCfg, cardTitlePadding } from './constants';\nimport { getConfig, getContentAndStyle, getMarkerPosition } from './utils';\nexport var registerCardNode = function () {\n    G6.registerNode('card', {\n        draw: function (cfg, group) {\n            var _a;\n            if (cfg === void 0) { cfg = {}; }\n            var title = cfg.title, body = cfg.body, footer = cfg.footer, collapseExpand = cfg.collapseExpand, children = cfg.children, markerPosition = cfg.markerPosition;\n            var size = cfg.size || [100, 30];\n            var height = 0; // 统计容器总高度，动态设置\n            if (typeof size === 'number')\n                size = [size, size];\n            var style = __assign({ radius: 2, fill: '#fff' }, cfg.style);\n            var color = style.stroke || cfg.color || '#5B8FF9';\n            var radius = style.radius;\n            // node box\n            var shape = group.addShape('rect', {\n                attrs: __assign({ x: 0, y: 0, width: size[0], height: size[1], stroke: color }, style),\n                name: 'main-box',\n                draggable: true,\n            });\n            // node title\n            var titleTextShape;\n            if (title) {\n                var _b = getContentAndStyle(title), text = _b.text, _c = _b.style, titleStyle = _c === void 0 ? cfg.titleStyle : _c;\n                titleTextShape = group.addShape('text', {\n                    attrs: __assign(__assign({ textBaseline: 'top', x: Margin, y: cardTitlePadding, text: text }, defaultTitleLabelCfg), getConfig(titleStyle, group)),\n                    name: 'title',\n                });\n            }\n            var titleHeight = (titleTextShape\n                ? titleTextShape.getBBox()\n                : { height: size[1] / 2 }).height;\n            // title rect\n            var titleRectShape = group.addShape('rect', {\n                attrs: {\n                    x: 0,\n                    y: 0,\n                    width: size[0],\n                    height: titleHeight + 2 * cardTitlePadding,\n                    fill: color,\n                    radius: [radius, radius, 0, 0],\n                },\n                name: 'title-rect',\n                draggable: true,\n            });\n            titleTextShape === null || titleTextShape === void 0 ? void 0 : titleTextShape.toFront();\n            // collapse marker\n            var markerShape;\n            if (collapseExpand && children) {\n                markerShape = group.addShape('marker', {\n                    attrs: __assign(__assign(__assign({}, getMarkerPosition(markerPosition, size)), { r: 6, cursor: 'pointer', symbol: cfg.collapsed ? G6.Marker.expand : G6.Marker.collapse, stroke: color, lineWidth: 1, fill: '#fff' }), getConfig(cfg.markerStyle, group, __assign(__assign({}, cfg), { name: 'collapse-icon' }))),\n                    name: 'collapse-icon',\n                });\n            }\n            var titleRectBoxHeight = titleRectShape.getBBox().height;\n            height += titleRectBoxHeight;\n            // body\n            var bodyShape;\n            if (body) {\n                var _d = getContentAndStyle(body), text = _d.text, _e = _d.style, bodyStyle = _e === void 0 ? cfg.bodyStyle : _e;\n                bodyShape = group.addShape('text', {\n                    attrs: __assign(__assign({ textBaseline: 'top', x: Margin, y: height + Margin, text: text }, defaultLabelStyle), getConfig(bodyStyle, group)),\n                    name: \"body\",\n                });\n                height += bodyShape.getBBox().height;\n            }\n            // footer\n            var footerTextShape;\n            if (footer) {\n                if (bodyShape) {\n                    height += Margin;\n                }\n                var _f = getContentAndStyle(footer), labelText = _f.text, _g = _f.style, labelStyle = _g === void 0 ? cfg.footerStyle : _g;\n                footerTextShape = group.addShape('text', {\n                    attrs: __assign(__assign({ textBaseline: 'top', x: Margin, y: height + Margin, text: labelText }, defaultLabelStyle), getConfig(labelStyle, group)),\n                    name: \"footer-label\",\n                });\n                var _h = footerTextShape.getBBox(), width = _h.width, contentHeight = _h.height;\n                var footerValueHeight = 0;\n                if (typeof cfg.footer === 'object' && ((_a = cfg.footer) === null || _a === void 0 ? void 0 : _a.value)) {\n                    var _j = getContentAndStyle({\n                        content: cfg.footer.value,\n                        style: cfg.footer.valueStyle,\n                    }), valueText = _j.text, _k = _j.style, valueStyle = _k === void 0 ? cfg.footerValueStyle || cfg.footerStyle : _k;\n                    var valueTextShape = group.addShape('text', {\n                        attrs: __assign(__assign({ textBaseline: 'top', x: width + Margin * 2, y: height + Margin, text: valueText }, defaultLabelStyle), getConfig(valueStyle, group)),\n                        name: \"footer-value\",\n                    });\n                    var valueHeight = valueTextShape.getBBox().height;\n                    footerValueHeight = valueHeight;\n                }\n                height += Math.max(contentHeight, footerValueHeight);\n            }\n            // 调整容器宽高\n            if (bodyShape) {\n                var desTextShapeBBox = bodyShape.getBBox();\n                var width = size[0] > desTextShapeBBox.width + 16 ? size[0] : desTextShapeBBox.width + 16;\n                shape.attr({ width: width, height: height + 16 });\n                titleRectShape === null || titleRectShape === void 0 ? void 0 : titleRectShape.attr('width', width);\n                markerShape === null || markerShape === void 0 ? void 0 : markerShape.attr(__assign({}, getMarkerPosition(markerPosition, [\n                    width,\n                    height + titleHeight + 2 * cardTitlePadding,\n                ])));\n            }\n            return shape;\n        },\n        update: undefined,\n    }, 'single-node');\n};\nexport var registerIconNode = function () {\n    G6.registerNode('icon-node', {\n        options: {\n            size: [60, 20],\n            stroke: '#91d5ff',\n            fill: '#91d5ff',\n        },\n        draw: function (cfg, group) {\n            if (cfg === void 0) { cfg = {}; }\n            // @ts-ignore\n            var styles = this.getShapeStyle(cfg);\n            var _a = cfg.labelCfg, labelCfg = _a === void 0 ? {} : _a, labelStyle = cfg.labelStyle, label = cfg.label, markerStyle = cfg.markerStyle, showMarker = cfg.showMarker, title = cfg.title, titleStyle = cfg.titleStyle;\n            var keyShape = group.addShape('rect', {\n                attrs: __assign(__assign({}, styles), { x: 0, y: 0 }),\n            });\n            var keyShapeHeight = keyShape.getBBox().height;\n            var headShape;\n            if (cfg.leftIcon) {\n                var _b = cfg.leftIcon, _c = _b.x, x = _c === void 0 ? 8 : _c, y = _b.y, _d = _b.width, width = _d === void 0 ? 24 : _d, _e = _b.height, height = _e === void 0 ? 24 : _e, style = _b.style;\n                if (style) {\n                    group.addShape('rect', {\n                        attrs: __assign({ x: 1, y: 1, width: 38, height: styles.height - 2 }, style),\n                    });\n                }\n                headShape = group.addShape('image', {\n                    attrs: {\n                        x: x,\n                        y: y || keyShapeHeight / 2 - height / 2,\n                        width: width,\n                        height: height,\n                        img: cfg.leftIcon.img,\n                    },\n                    name: 'image-shape',\n                });\n            }\n            if (showMarker) {\n                group.addShape('marker', {\n                    attrs: __assign({ x: styles.width / 3, y: styles.height + 6, r: 6, stroke: '#73d13d', cursor: 'pointer', symbol: G6.Marker.expand }, getConfig(markerStyle, group, __assign(__assign({}, cfg), { name: 'add-item' }))),\n                    name: 'add-item',\n                });\n                group.addShape('marker', {\n                    attrs: __assign({ x: (styles.width * 2) / 3, y: styles.height + 6, r: 6, stroke: '#ff4d4f', cursor: 'pointer', symbol: G6.Marker.collapse }, getConfig(markerStyle, group, __assign(__assign({}, cfg), { name: 'remove-item' }))),\n                    name: 'remove-item',\n                });\n            }\n            if (label) {\n                var textCfg = labelStyle ? getConfig(labelStyle, group, cfg) : labelCfg.style;\n                var y = title\n                    ? styles.height / 2 - (textCfg.fontSize * 1 || 12) - Margin / 2\n                    : styles.height / 2;\n                group.addShape('text', {\n                    attrs: __assign({ text: label, x: styles.width / 2, y: y, textAlign: headShape ? 'start' : 'center', textBaseline: title ? 'top' : 'middle' }, textCfg),\n                });\n            }\n            if (title) {\n                var titleCfg = titleStyle ? getConfig(titleStyle, group, cfg) : labelCfg.style;\n                group.addShape('text', {\n                    attrs: __assign({ text: title, x: styles.width / 2, y: styles.height / 2 + Margin / 2, textAlign: headShape ? 'start' : 'center', textBaseline: 'top' }, titleCfg),\n                });\n            }\n            return keyShape;\n        },\n    }, 'rect');\n};\n"]},"metadata":{},"sourceType":"module"}