{"ast":null,"code":"import { registerInteraction } from '@antv/g2';\nvar INTERACTION_MAP = {\n  hover: '__interval-connected-area-hover__',\n  click: '__interval-connected-area-click__'\n};\n\nvar getStartStages = function (trigger, style) {\n  if (trigger === 'hover') {\n    return [{\n      trigger: \"interval:mouseenter\",\n      action: ['element-highlight-by-color:highlight', 'element-link-by-color:link'],\n      arg: [null, {\n        style: style\n      }]\n    }];\n  }\n\n  return [{\n    trigger: \"interval:click\",\n    action: ['element-highlight-by-color:clear', 'element-highlight-by-color:highlight', 'element-link-by-color:clear', 'element-link-by-color:unlink', 'element-link-by-color:link'],\n    arg: [null, null, null, null, {\n      style: style\n    }]\n  }];\n};\n/** hover 触发的连通区域交互 */\n\n\nregisterInteraction(INTERACTION_MAP.hover, {\n  start: getStartStages(INTERACTION_MAP.hover),\n  end: [{\n    trigger: 'interval:mouseleave',\n    action: ['element-highlight-by-color:reset', 'element-link-by-color:unlink']\n  }]\n});\n/** click 触发的联通区域交互 */\n\nregisterInteraction(INTERACTION_MAP.click, {\n  start: getStartStages(INTERACTION_MAP.click),\n  end: [{\n    trigger: 'document:mousedown',\n    action: ['element-highlight-by-color:clear', 'element-link-by-color:clear']\n  }]\n});\n/**\n * 返回支持联通区域组件交互的 adaptor，适用于堆叠柱形图/堆叠条形图\n * @param disable\n */\n\nexport function connectedArea(disable) {\n  if (disable === void 0) {\n    disable = false;\n  }\n\n  return function (params) {\n    var chart = params.chart,\n        options = params.options;\n    var connectedArea = options.connectedArea;\n\n    var clear = function () {\n      chart.removeInteraction(INTERACTION_MAP.hover);\n      chart.removeInteraction(INTERACTION_MAP.click);\n    };\n\n    if (!disable && connectedArea) {\n      var trigger = connectedArea.trigger || 'hover';\n      clear();\n      chart.interaction(INTERACTION_MAP[trigger], {\n        start: getStartStages(trigger, connectedArea.style)\n      });\n    } else {\n      clear();\n    }\n\n    return params;\n  };\n}","map":{"version":3,"sources":["../../src/adaptor/connected-area.ts"],"names":[],"mappings":"AAAA,SAAS,mBAAT,QAAyD,UAAzD;AAeA,IAAM,eAAe,GAAG;AACtB,EAAA,KAAK,EAAE,mCADe;AAEtB,EAAA,KAAK,EAAE;AAFe,CAAxB;;AAKA,IAAM,cAAc,GAAG,UAAC,OAAD,EAAkB,KAAlB,EAAuD;AAC5E,MAAI,OAAO,KAAK,OAAhB,EAAyB;AACvB,WAAO,CACL;AACE,MAAA,OAAO,EAAE,qBADX;AAEE,MAAA,MAAM,EAAE,CAAC,sCAAD,EAAyC,4BAAzC,CAFV;AAGE,MAAA,GAAG,EAAE,CAAC,IAAD,EAAO;AAAE,QAAA,KAAK,EAAA;AAAP,OAAP;AAHP,KADK,CAAP;AAOD;;AACD,SAAO,CACL;AACE,IAAA,OAAO,EAAE,gBADX;AAEE,IAAA,MAAM,EAAE,CACN,kCADM,EAEN,sCAFM,EAGN,6BAHM,EAIN,8BAJM,EAKN,4BALM,CAFV;AASE,IAAA,GAAG,EAAE,CAAC,IAAD,EAAO,IAAP,EAAa,IAAb,EAAmB,IAAnB,EAAyB;AAAE,MAAA,KAAK,EAAA;AAAP,KAAzB;AATP,GADK,CAAP;AAaD,CAvBD;AAyBA;;;AACA,mBAAmB,CAAC,eAAe,CAAC,KAAjB,EAAwB;AACzC,EAAA,KAAK,EAAE,cAAc,CAAC,eAAe,CAAC,KAAjB,CADoB;AAEzC,EAAA,GAAG,EAAE,CACH;AACE,IAAA,OAAO,EAAE,qBADX;AAEE,IAAA,MAAM,EAAE,CAAC,kCAAD,EAAqC,8BAArC;AAFV,GADG;AAFoC,CAAxB,CAAnB;AAUA;;AACA,mBAAmB,CAAC,eAAe,CAAC,KAAjB,EAAwB;AACzC,EAAA,KAAK,EAAE,cAAc,CAAC,eAAe,CAAC,KAAjB,CADoB;AAEzC,EAAA,GAAG,EAAE,CACH;AACE,IAAA,OAAO,EAAE,oBADX;AAEE,IAAA,MAAM,EAAE,CAAC,kCAAD,EAAqC,6BAArC;AAFV,GADG;AAFoC,CAAxB,CAAnB;AAUA;;;AAGG;;AACH,OAAM,SAAU,aAAV,CAA2D,OAA3D,EAA0E;AAAf,MAAA,OAAA,KAAA,KAAA,CAAA,EAAA;AAAA,IAAA,OAAA,GAAA,KAAA;AAAe;;AAC9E,SAAO,UAAU,MAAV,EAA2B;AACxB,QAAA,KAAK,GAAc,MAAM,CAApB,KAAL;AAAA,QAAO,OAAO,GAAK,MAAM,CAAX,OAAd;AACA,QAAA,aAAa,GAAK,OAAO,CAAZ,aAAb;;AAER,QAAM,KAAK,GAAG,YAAA;AACZ,MAAA,KAAK,CAAC,iBAAN,CAAwB,eAAe,CAAC,KAAxC;AACA,MAAA,KAAK,CAAC,iBAAN,CAAwB,eAAe,CAAC,KAAxC;AACD,KAHD;;AAKA,QAAI,CAAC,OAAD,IAAY,aAAhB,EAA+B;AAC7B,UAAM,OAAO,GAAG,aAAa,CAAC,OAAd,IAAyB,OAAzC;AACA,MAAA,KAAK;AACL,MAAA,KAAK,CAAC,WAAN,CAAkB,eAAe,CAAC,OAAD,CAAjC,EAA4C;AAC1C,QAAA,KAAK,EAAE,cAAc,CAAC,OAAD,EAAU,aAAa,CAAC,KAAxB;AADqB,OAA5C;AAGD,KAND,MAMO;AACL,MAAA,KAAK;AACN;;AAED,WAAO,MAAP;AACD,GApBD;AAqBD","sourcesContent":["import { registerInteraction, ShapeAttrs, Element } from '@antv/g2';\nimport { Params } from '../core/adaptor';\n\nexport interface ConnectedAreaOptions {\n  /** 触发方式, 默认 hover */\n  trigger?: 'hover' | 'click';\n  /** 自定义样式 */\n  style?: ShapeAttrs | ((style: ShapeAttrs, element: Element) => ShapeAttrs);\n}\n\n/** 联通区域组件：使用于堆叠柱形图、堆叠条形图 */\nexport interface OptionWithConnectedArea {\n  connectedArea?: ConnectedAreaOptions | false;\n}\n\nconst INTERACTION_MAP = {\n  hover: '__interval-connected-area-hover__',\n  click: '__interval-connected-area-click__',\n};\n\nconst getStartStages = (trigger: string, style?: ConnectedAreaOptions['style']) => {\n  if (trigger === 'hover') {\n    return [\n      {\n        trigger: `interval:mouseenter`,\n        action: ['element-highlight-by-color:highlight', 'element-link-by-color:link'],\n        arg: [null, { style }],\n      },\n    ];\n  }\n  return [\n    {\n      trigger: `interval:click`,\n      action: [\n        'element-highlight-by-color:clear',\n        'element-highlight-by-color:highlight',\n        'element-link-by-color:clear',\n        'element-link-by-color:unlink',\n        'element-link-by-color:link',\n      ],\n      arg: [null, null, null, null, { style }],\n    },\n  ];\n};\n\n/** hover 触发的连通区域交互 */\nregisterInteraction(INTERACTION_MAP.hover, {\n  start: getStartStages(INTERACTION_MAP.hover),\n  end: [\n    {\n      trigger: 'interval:mouseleave',\n      action: ['element-highlight-by-color:reset', 'element-link-by-color:unlink'],\n    },\n  ],\n});\n\n/** click 触发的联通区域交互 */\nregisterInteraction(INTERACTION_MAP.click, {\n  start: getStartStages(INTERACTION_MAP.click),\n  end: [\n    {\n      trigger: 'document:mousedown',\n      action: ['element-highlight-by-color:clear', 'element-link-by-color:clear'],\n    },\n  ],\n});\n\n/**\n * 返回支持联通区域组件交互的 adaptor，适用于堆叠柱形图/堆叠条形图\n * @param disable\n */\nexport function connectedArea<O extends OptionWithConnectedArea>(disable = false) {\n  return function (params: Params<O>): Params<O> {\n    const { chart, options } = params;\n    const { connectedArea } = options;\n\n    const clear = () => {\n      chart.removeInteraction(INTERACTION_MAP.hover);\n      chart.removeInteraction(INTERACTION_MAP.click);\n    };\n\n    if (!disable && connectedArea) {\n      const trigger = connectedArea.trigger || 'hover';\n      clear();\n      chart.interaction(INTERACTION_MAP[trigger], {\n        start: getStartStages(trigger, connectedArea.style),\n      });\n    } else {\n      clear();\n    }\n\n    return params;\n  };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}