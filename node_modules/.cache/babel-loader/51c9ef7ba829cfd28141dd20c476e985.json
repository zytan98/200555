{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport { gl } from '@antv/g-webgpu-core';\nimport { colorSpaceMap, dataTypeMap, filterMap, formatMap, mipmapMap, wrapModeMap } from './constants';\n/**\n * adaptor for regl.Buffer\n * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#buffers\n */\n\nvar ReglTexture2D = /*#__PURE__*/function () {\n  function ReglTexture2D(reGl, options) {\n    _classCallCheck(this, ReglTexture2D);\n\n    this.texture = void 0;\n    this.width = void 0;\n    this.height = void 0;\n    var data = options.data,\n        _options$type = options.type,\n        type = _options$type === void 0 ? gl.UNSIGNED_BYTE : _options$type,\n        width = options.width,\n        height = options.height,\n        _options$flipY = options.flipY,\n        flipY = _options$flipY === void 0 ? false : _options$flipY,\n        _options$format = options.format,\n        format = _options$format === void 0 ? gl.RGBA : _options$format,\n        _options$mipmap = options.mipmap,\n        mipmap = _options$mipmap === void 0 ? false : _options$mipmap,\n        _options$wrapS = options.wrapS,\n        wrapS = _options$wrapS === void 0 ? gl.CLAMP_TO_EDGE : _options$wrapS,\n        _options$wrapT = options.wrapT,\n        wrapT = _options$wrapT === void 0 ? gl.CLAMP_TO_EDGE : _options$wrapT,\n        _options$aniso = options.aniso,\n        aniso = _options$aniso === void 0 ? 0 : _options$aniso,\n        _options$alignment = options.alignment,\n        alignment = _options$alignment === void 0 ? 1 : _options$alignment,\n        _options$premultiplyA = options.premultiplyAlpha,\n        premultiplyAlpha = _options$premultiplyA === void 0 ? false : _options$premultiplyA,\n        _options$mag = options.mag,\n        mag = _options$mag === void 0 ? gl.NEAREST : _options$mag,\n        _options$min = options.min,\n        min = _options$min === void 0 ? gl.NEAREST : _options$min,\n        _options$colorSpace = options.colorSpace,\n        colorSpace = _options$colorSpace === void 0 ? gl.BROWSER_DEFAULT_WEBGL : _options$colorSpace;\n    this.width = width;\n    this.height = height;\n    var textureOptions = {\n      width: width,\n      height: height,\n      // @ts-ignore\n      type: dataTypeMap[type],\n      format: formatMap[format],\n      wrapS: wrapModeMap[wrapS],\n      wrapT: wrapModeMap[wrapT],\n      // @ts-ignore\n      mag: filterMap[mag],\n      min: filterMap[min],\n      alignment: alignment,\n      flipY: flipY,\n      colorSpace: colorSpaceMap[colorSpace],\n      premultiplyAlpha: premultiplyAlpha,\n      aniso: aniso\n    };\n\n    if (data) {\n      textureOptions.data = data;\n    }\n\n    if (typeof mipmap === 'number') {\n      textureOptions.mipmap = mipmapMap[mipmap];\n    } else if (typeof mipmap === 'boolean') {\n      textureOptions.mipmap = mipmap;\n    }\n\n    this.texture = reGl.texture(textureOptions);\n  }\n\n  _createClass(ReglTexture2D, [{\n    key: \"get\",\n    value: function get() {\n      return this.texture;\n    }\n  }, {\n    key: \"update\",\n    value: function update() {\n      // @ts-ignore\n      this.texture._texture.bind();\n    }\n  }, {\n    key: \"resize\",\n    value: function resize(_ref) {\n      var width = _ref.width,\n          height = _ref.height;\n      this.texture.resize(width, height);\n      this.width = width;\n      this.height = height;\n    }\n  }, {\n    key: \"destroy\",\n    value: function destroy() {\n      this.texture.destroy();\n    }\n  }]);\n\n  return ReglTexture2D;\n}();\n\nexport { ReglTexture2D as default };","map":{"version":3,"sources":["../../src/webgl/ReglTexture2D.ts"],"names":["ReglTexture2D","texture","width","height","data","type","gl","flipY","format","mipmap","wrapS","wrapT","aniso","alignment","premultiplyAlpha","mag","min","colorSpace","options","textureOptions","dataTypeMap","formatMap","wrapModeMap","filterMap","colorSpaceMap","mipmapMap","reGl"],"mappings":"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","sourcesContent":["import {\n  gl,\n  ITexture2D,\n  ITexture2DInitializationOptions,\n} from '@antv/g-webgpu-core';\nimport regl from 'regl';\nimport {\n  colorSpaceMap,\n  dataTypeMap,\n  filterMap,\n  formatMap,\n  mipmapMap,\n  wrapModeMap,\n} from './constants';\n\n/**\n * adaptor for regl.Buffer\n * @see https://github.com/regl-project/regl/blob/gh-pages/API.md#buffers\n */\nexport default class ReglTexture2D implements ITexture2D {\n  private texture: regl.Texture2D;\n  private width: number;\n  private height: number;\n\n  constructor(reGl: regl.Regl, options: ITexture2DInitializationOptions) {\n    const {\n      data,\n      type = gl.UNSIGNED_BYTE,\n      width,\n      height,\n      flipY = false,\n      format = gl.RGBA,\n      mipmap = false,\n      wrapS = gl.CLAMP_TO_EDGE,\n      wrapT = gl.CLAMP_TO_EDGE,\n      aniso = 0,\n      alignment = 1,\n      premultiplyAlpha = false,\n      mag = gl.NEAREST,\n      min = gl.NEAREST,\n      colorSpace = gl.BROWSER_DEFAULT_WEBGL,\n    } = options;\n    this.width = width;\n    this.height = height;\n\n    const textureOptions: regl.Texture2DOptions = {\n      width,\n      height,\n      // @ts-ignore\n      type: dataTypeMap[type],\n      format: formatMap[format],\n      wrapS: wrapModeMap[wrapS],\n      wrapT: wrapModeMap[wrapT],\n      // @ts-ignore\n      mag: filterMap[mag],\n      min: filterMap[min],\n      alignment,\n      flipY,\n      colorSpace: colorSpaceMap[colorSpace],\n      premultiplyAlpha,\n      aniso,\n    };\n\n    if (data) {\n      textureOptions.data = data;\n    }\n\n    if (typeof mipmap === 'number') {\n      textureOptions.mipmap = mipmapMap[mipmap];\n    } else if (typeof mipmap === 'boolean') {\n      textureOptions.mipmap = mipmap;\n    }\n\n    this.texture = reGl.texture(textureOptions);\n  }\n\n  public get() {\n    return this.texture;\n  }\n  public update() {\n    // @ts-ignore\n    this.texture._texture.bind();\n  }\n\n  public resize({ width, height }: { width: number; height: number }): void {\n    this.texture.resize(width, height);\n    this.width = width;\n    this.height = height;\n  }\n\n  public destroy() {\n    this.texture.destroy();\n  }\n}\n"]},"metadata":{},"sourceType":"module"}